This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
backend/
  app/
    ml/
      __init__.py
      predictor.py
      preprocessing.py
    models/
      __init__.py
    routers/
      __init__.py
      health.py
      models.py
      predictions.py
      stats.py
    schemas/
      __init__.py
      prediction.py
    services/
      __init__.py
      flow_manager.py
      packet_sniffer.py
    store/
      __init__.py
      prediction_store.py
    __init__.py
    __main__.py
    config.py
    main.py
  requirements.txt
frontend/
  public/
    vite.svg
  src/
    api/
      client.js
    assets/
      react.svg
    contexts/
      WebSocketContext.jsx
    pages/
      Dashboard.jsx
      FlowAnalyzer.jsx
      LiveMonitoring.jsx
      ModelInsights.jsx
    App.css
    App.jsx
    config.js
    index.css
    main.jsx
  .gitignore
  eslint.config.js
  index.html
  package.json
  postcss.config.js
  README.md
  tailwind.config.js
  vite.config.js
saved_models/
  binary_svm_model.pkl
  multiclass_rf_model.pkl
  pca.pkl
  scaler.pkl
scripts/
  test_models.py
.gitignore
ATTACK_GUIDE.md
Data_Preprocessing.ipynb
Dataset_Characteristics_and_EDA.ipynb
IDS_Model_Training.ipynb
Makefile
README.md
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="backend/app/ml/__init__.py">
"""ML models and preprocessing."""
</file>

<file path="backend/app/ml/predictor.py">
"""ML model loading and prediction logic."""
import joblib
import numpy as np
from typing import Dict, Optional, Tuple
from pathlib import Path

from app.config import settings
from app.ml.preprocessing import build_feature_vector_from_flow_dict, FEATURE_COLUMNS


class PredictionResult:
    """Result of a prediction."""
    
    def __init__(
        self,
        is_attack: bool,
        attack_type: str,
        binary_confidence: float,
        class_probabilities: Optional[Dict[str, float]] = None,
        raw_features: Optional[np.ndarray] = None,
    ):
        self.is_attack = is_attack
        self.attack_type = attack_type
        self.binary_confidence = binary_confidence
        self.class_probabilities = class_probabilities or {}
        self.raw_features = raw_features


class MLPredictor:
    """ML model predictor that loads models and makes predictions."""
    
    def __init__(self):
        self.binary_model = None
        self.multiclass_model = None
        self.scaler = None
        self.pca = None
        self.loaded = False
    
    def load_models(self):
        """Load all ML models and preprocessors."""
        # Resolve path relative to project root (parent of backend directory)
        model_dir = Path(__file__).parent.parent.parent.parent / settings.MODEL_DIR
        if not model_dir.exists():
            # Try relative to current working directory
            model_dir = Path(settings.MODEL_DIR)
        
        # Load scaler
        scaler_path = model_dir / "scaler.pkl"
        if not scaler_path.exists():
            raise FileNotFoundError(f"Scaler not found at {scaler_path}")
        self.scaler = joblib.load(scaler_path)
        
        # Load PCA
        pca_path = model_dir / "pca.pkl"
        if not pca_path.exists():
            raise FileNotFoundError(f"PCA not found at {pca_path}")
        self.pca = joblib.load(pca_path)
        
        # Load binary model
        binary_path = model_dir / "binary_svm_model.pkl"
        if not binary_path.exists():
            raise FileNotFoundError(f"Binary model not found at {binary_path}")
        self.binary_model = joblib.load(binary_path)
        
        # Load multiclass model
        multiclass_path = model_dir / "multiclass_rf_model.pkl"
        if not multiclass_path.exists():
            raise FileNotFoundError(f"Multiclass model not found at {multiclass_path}")
        self.multiclass_model = joblib.load(multiclass_path)
        
        self.loaded = True
        print(f"âœ“ Loaded models: binary={type(self.binary_model).__name__}, "
              f"multiclass={type(self.multiclass_model).__name__}")
    
    def predict(self, flow: Dict) -> PredictionResult:
        """
        Predict attack type from flow dictionary.
        
        Args:
            flow: Dictionary with flow statistics
            
        Returns:
            PredictionResult with prediction details
        """
        if not self.loaded:
            raise RuntimeError("Models not loaded. Call load_models() first.")
        
        # Build feature vector in exact order
        feature_vector = build_feature_vector_from_flow_dict(flow)
        
        # Apply preprocessing pipeline (exactly as in training)
        # 1. StandardScaler
        scaled_features = self.scaler.transform(feature_vector)
        
        # 2. PCA transformation
        pca_features = self.pca.transform(scaled_features)
        
        # 3. Binary classification (attack vs benign)
        binary_pred = self.binary_model.predict(pca_features)[0]
        binary_proba = self.binary_model.predict_proba(pca_features)[0]
        
        is_attack = bool(binary_pred == 1)
        binary_confidence = float(max(binary_proba))
        
        # 4. If attack, classify attack type
        attack_type = "BENIGN"
        class_probabilities = {}
        
        if is_attack:
            multiclass_pred = self.multiclass_model.predict(pca_features)[0]
            multiclass_proba = self.multiclass_model.predict_proba(pca_features)[0]
            
            # Get class names from model
            class_names = self.multiclass_model.classes_
            attack_type = str(class_names[multiclass_pred])
            
            # Build probability dictionary
            for i, class_name in enumerate(class_names):
                class_probabilities[str(class_name)] = float(multiclass_proba[i])
        else:
            class_probabilities["BENIGN"] = float(binary_proba[0])
            class_probabilities["ATTACK"] = float(binary_proba[1])
        
        return PredictionResult(
            is_attack=is_attack,
            attack_type=attack_type,
            binary_confidence=binary_confidence,
            class_probabilities=class_probabilities,
            raw_features=feature_vector,
        )
    
    def get_model_info(self) -> Dict:
        """Get information about loaded models."""
        if not self.loaded:
            return {"error": "Models not loaded"}
        
        info = {
            "binary_model": {
                "type": type(self.binary_model).__name__,
                "n_features": self.pca.n_components_ if self.pca else None,
            },
            "multiclass_model": {
                "type": type(self.multiclass_model).__name__,
                "classes": self.multiclass_model.classes_.tolist() if hasattr(self.multiclass_model, 'classes_') else [],
                "n_features": self.pca.n_components_ if self.pca else None,
            },
            "preprocessing": {
                "scaler": type(self.scaler).__name__,
                "pca": {
                    "type": type(self.pca).__name__,
                    "n_components": self.pca.n_components_ if self.pca else None,
                    "explained_variance_ratio": float(sum(self.pca.explained_variance_ratio_)) if self.pca else None,
                },
            },
            "feature_count": len(FEATURE_COLUMNS),
        }
        
        return info


# Global predictor instance (loaded at startup)
predictor = MLPredictor()
</file>

<file path="backend/app/ml/preprocessing.py">
"""ML preprocessing module - extracts features from network flows exactly as in training."""
import numpy as np
from typing import Dict, List, Optional


# Exact feature columns in the order used during training (after dropping non-variant columns)
# This matches the order from Data_Preprocessing.ipynb
FEATURE_COLUMNS = [
    'Destination Port',
    'Flow Duration',
    'Total Fwd Packets',
    'Total Backward Packets',
    'Total Length of Fwd Packets',
    'Total Length of Bwd Packets',
    'Fwd Packet Length Max',
    'Fwd Packet Length Min',
    'Fwd Packet Length Mean',
    'Fwd Packet Length Std',
    'Bwd Packet Length Max',
    'Bwd Packet Length Min',
    'Bwd Packet Length Mean',
    'Bwd Packet Length Std',
    'Flow Bytes/s',
    'Flow Packets/s',
    'Flow IAT Mean',
    'Flow IAT Std',
    'Flow IAT Max',
    'Flow IAT Min',
    'Fwd IAT Total',
    'Fwd IAT Mean',
    'Fwd IAT Std',
    'Fwd IAT Max',
    'Fwd IAT Min',
    'Bwd IAT Total',
    'Bwd IAT Mean',
    'Bwd IAT Std',
    'Bwd IAT Max',
    'Bwd IAT Min',
    'Fwd PSH Flags',
    'Fwd URG Flags',
    'Fwd Header Length',
    'Bwd Header Length',
    'Fwd Packets/s',
    'Bwd Packets/s',
    'Min Packet Length',
    'Max Packet Length',
    'Packet Length Mean',
    'Packet Length Std',
    'Packet Length Variance',
    'FIN Flag Count',
    'SYN Flag Count',
    'RST Flag Count',
    'PSH Flag Count',
    'ACK Flag Count',
    'URG Flag Count',
    'CWE Flag Count',
    'ECE Flag Count',
    'Down/Up Ratio',
    'Average Packet Size',
    'Avg Fwd Segment Size',
    'Avg Bwd Segment Size',
    'Fwd Header Length.1',
    'Subflow Fwd Packets',
    'Subflow Fwd Bytes',
    'Subflow Bwd Packets',
    'Subflow Bwd Bytes',
    'Init_Win_bytes_forward',
    'Init_Win_bytes_backward',
    'act_data_pkt_fwd',
    'min_seg_size_forward',
    'Active Mean',
    'Active Std',
    'Active Max',
    'Active Min',
    'Idle Mean',
    'Idle Std',
    'Idle Max',
    'Idle Min',
]


def build_feature_vector_from_flow_dict(flow: Dict) -> np.ndarray:
    """
    Build feature vector from flow dictionary in the exact order used during training.
    
    Args:
        flow: Dictionary containing flow statistics with keys matching FEATURE_COLUMNS
        
    Returns:
        numpy array of shape (n_features,) with features in the correct order
        
    Raises:
        ValueError: If required features are missing
    """
    feature_vector = []
    missing_features = []
    
    for col in FEATURE_COLUMNS:
        if col not in flow:
            missing_features.append(col)
            # Use 0 as default for missing features (shouldn't happen in production)
            feature_vector.append(0.0)
        else:
            value = flow[col]
            # Handle None/NaN values
            if value is None or (isinstance(value, float) and np.isnan(value)):
                feature_vector.append(0.0)
            else:
                feature_vector.append(float(value))
    
    if missing_features:
        # Log warning but don't fail - use defaults
        import warnings
        warnings.warn(f"Missing features: {missing_features}. Using defaults.")
    
    return np.array(feature_vector, dtype=np.float32).reshape(1, -1)


def validate_flow_dict(flow: Dict) -> bool:
    """
    Validate that flow dictionary has all required features.
    
    Args:
        flow: Dictionary to validate
        
    Returns:
        True if valid, False otherwise
    """
    return all(col in flow for col in FEATURE_COLUMNS)
</file>

<file path="backend/app/models/__init__.py">
"""Models package (currently empty - using in-memory store instead)."""
</file>

<file path="backend/app/routers/__init__.py">
"""API routers."""
</file>

<file path="backend/app/routers/health.py">
"""Health check and system status endpoints."""
from fastapi import APIRouter, HTTPException, Query
from app.services.packet_sniffer import PacketSniffer
from app.services.flow_manager import FlowManager
from app.config import settings

router = APIRouter(prefix="/health", tags=["health"])

# Global references (set by main app)
sniffer: PacketSniffer = None
flow_manager: FlowManager = None


@router.get("/")
async def health_check():
    """
    Health check endpoint.
    """
    available_interfaces = []
    try:
        from scapy.all import get_if_list
        available_interfaces = get_if_list()
    except Exception:
        pass
    
    sniffer_stats = {}
    if sniffer:
        sniffer_stats = sniffer.get_stats()
    
    return {
        "status": "healthy",
        "sniffer_running": sniffer._running if sniffer else False,
        "interface": settings.INTERFACE_NAME,
        "available_interfaces": available_interfaces,
        "interface_exists": settings.INTERFACE_NAME in available_interfaces if available_interfaces else None,
        "sniffer_stats": sniffer_stats,
        "active_flows": flow_manager.get_active_flow_count() if flow_manager else 0,
    }


@router.post("/sniffer/start")
async def start_sniffer():
    """
    Start the packet sniffer.
    """
    if not sniffer:
        raise HTTPException(status_code=400, detail="Sniffer not initialized")
    
    if sniffer._running:
        return {"status": "already_running", "message": "Sniffer is already running"}
    
    try:
        # Check if interface exists
        try:
            from scapy.all import get_if_list
            available_interfaces = get_if_list()
            if settings.INTERFACE_NAME not in available_interfaces:
                return {
                    "status": "warning",
                    "message": f"Interface '{settings.INTERFACE_NAME}' not found. Available: {available_interfaces}",
                    "sniffer_running": False
                }
        except Exception as e:
            # If we can't check interfaces, continue anyway
            pass
        
        sniffer.start()
        
        # Give it a moment to start, then check if it's actually running
        import asyncio
        await asyncio.sleep(0.5)
        
        if sniffer._running:
            return {"status": "started", "message": f"Sniffer started on {settings.INTERFACE_NAME}", "sniffer_running": True}
        else:
            return {
                "status": "failed",
                "message": f"Sniffer failed to start. Check interface '{settings.INTERFACE_NAME}' and permissions.",
                "sniffer_running": False
            }
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"Failed to start sniffer: {str(e)}")


@router.post("/sniffer/stop")
async def stop_sniffer():
    """
    Stop the packet sniffer.
    """
    if not sniffer:
        raise HTTPException(status_code=400, detail="Sniffer not initialized")
    
    if not sniffer._running:
        return {"status": "already_stopped", "message": "Sniffer is already stopped"}
    
    try:
        sniffer.stop()
        return {"status": "stopped", "message": "Sniffer stopped"}
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"Failed to stop sniffer: {str(e)}")


@router.post("/sniffer/interface")
async def set_interface(interface: str = Query(..., description="Network interface name")):
    """
    Change the network interface for the sniffer.
    Expects interface as query parameter: POST /api/health/sniffer/interface?interface=bridge0
    """
    if not sniffer:
        raise HTTPException(status_code=400, detail="Sniffer not initialized")
    
    # Check if interface exists
    try:
        from scapy.all import get_if_list
        available_interfaces = get_if_list()
        if interface not in available_interfaces:
            raise HTTPException(
                status_code=400, 
                detail=f"Interface '{interface}' not found. Available: {available_interfaces}"
            )
    except HTTPException:
        raise
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"Failed to check interfaces: {str(e)}")
    
    # Stop sniffer if running
    was_running = sniffer._running
    if was_running:
        sniffer.stop()
    
    # Update interface
    sniffer.interface = interface
    
    # Update settings (this won't persist, but will work for current session)
    from app.config import settings
    settings.INTERFACE_NAME = interface
    
    # Restart if it was running
    if was_running:
        try:
            sniffer.start()
            return {
                "status": "updated",
                "message": f"Interface changed to {interface} and sniffer restarted",
                "interface": interface
            }
        except Exception as e:
            return {
                "status": "updated_but_failed_restart",
                "message": f"Interface changed to {interface} but failed to restart: {str(e)}",
                "interface": interface
            }
    else:
        return {
            "status": "updated",
            "message": f"Interface changed to {interface}",
            "interface": interface
        }
</file>

<file path="backend/app/routers/models.py">
"""API routes for model information."""
from fastapi import APIRouter
from app.ml.predictor import predictor

router = APIRouter(prefix="/models", tags=["models"])


@router.get("/info")
async def get_model_info():
    """
    Get information about loaded models.
    """
    return predictor.get_model_info()


@router.get("/metrics")
async def get_metrics():
    """
    Get model performance metrics.
    These are hardcoded from the training notebook results.
    """
    # Binary model metrics (from IDS_Model_Training.ipynb)
    binary_metrics = {
        "accuracy": 0.97,
        "precision": 0.97,
        "recall": 0.97,
        "f1_score": 0.97,
        "roc_auc": 0.97,  # Approximate
        "confusion_matrix": {
            "true_negative": 1856,  # Approximate from 97% accuracy
            "false_positive": 57,
            "false_negative": 55,
            "true_positive": 1782,
        }
    }
    
    # Multiclass model metrics (from IDS_Model_Training.ipynb)
    multiclass_metrics = {
        "accuracy": 0.99,
        "per_class": {
            "BENIGN": {
                "precision": 0.98,
                "recall": 0.98,
                "f1_score": 0.98,
            },
            "Bot": {
                "precision": 0.99,
                "recall": 1.00,
                "f1_score": 0.99,
            },
            "Brute Force": {
                "precision": 1.00,
                "recall": 0.99,
                "f1_score": 1.00,
            },
            "DDoS": {
                "precision": 1.00,
                "recall": 1.00,
                "f1_score": 1.00,
            },
            "DoS": {
                "precision": 0.99,
                "recall": 0.99,
                "f1_score": 0.99,
            },
            "Port Scan": {
                "precision": 1.00,
                "recall": 1.00,
                "f1_score": 1.00,
            },
            "Web Attack": {
                "precision": 1.00,
                "recall": 0.99,
                "f1_score": 1.00,
            },
        },
        "confusion_matrix": {
            "classes": ["BENIGN", "Bot", "Brute Force", "DDoS", "DoS", "Port Scan", "Web Attack"],
            "matrix": [
                [1227, 0, 0, 0, 0, 0, 25],  # BENIGN
                [0, 1280, 0, 0, 0, 0, 0],  # Bot
                [13, 0, 1237, 0, 0, 0, 0],  # Brute Force
                [0, 0, 0, 1223, 0, 0, 0],  # DDoS
                [0, 0, 0, 0, 1237, 12, 0],  # DoS
                [0, 0, 0, 0, 0, 1231, 0],  # Port Scan
                [13, 0, 0, 0, 0, 0, 1252],  # Web Attack
            ]
        }
    }
    
    return {
        "binary": binary_metrics,
        "multiclass": multiclass_metrics,
    }
</file>

<file path="backend/app/routers/predictions.py">
"""API routes for predictions."""
from fastapi import APIRouter, HTTPException
from typing import List

from app.store import prediction_store
from app.schemas.prediction import FlowInput, PredictionResponse, PredictionHistoryItem
from app.ml.predictor import predictor
from datetime import datetime

router = APIRouter(prefix="/predictions", tags=["predictions"])


@router.post("/predict-flow", response_model=PredictionResponse)
async def predict_flow(flow_input: FlowInput):
    """
    Predict attack type for a single flow.
    """
    try:
        # Convert input to flow dictionary
        flow_dict = flow_input.to_flow_dict()
        
        # Make prediction
        result = predictor.predict(flow_dict)
        
        # Determine severity
        if result.is_attack:
            if result.binary_confidence > 0.9:
                severity = "high"
            elif result.binary_confidence > 0.7:
                severity = "medium"
            else:
                severity = "low"
        else:
            severity = "none"
        
        # Create event dictionary
        event = {
            "timestamp": datetime.utcnow().isoformat(),
            "src_ip": flow_input.src_ip,
            "dst_ip": flow_input.dst_ip,
            "src_port": flow_input.src_port,
            "dst_port": flow_input.dst_port,
            "protocol": flow_input.protocol,
            "is_attack": result.is_attack,
            "attack_type": result.attack_type,
            "binary_confidence": result.binary_confidence,
            "severity": severity,
        }
        
        # Add to in-memory store
        prediction_store.add_event(event)
        
        return PredictionResponse(
            is_attack=result.is_attack,
            attack_type=result.attack_type,
            binary_confidence=result.binary_confidence,
            class_probabilities=result.class_probabilities,
            severity=severity,
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"Prediction error: {str(e)}")


@router.get("/history", response_model=List[PredictionHistoryItem])
async def get_history(limit: int = 100):
    """
    Get prediction history from in-memory store.
    """
    events = prediction_store.get_recent(limit)
    
    # Convert events to PredictionHistoryItem format
    history_items = []
    for idx, event in enumerate(events, start=1):
        history_items.append(PredictionHistoryItem(
            id=idx,  # Use index as ID since we don't have DB IDs
            src_ip=event.get("src_ip", ""),
            dst_ip=event.get("dst_ip", ""),
            src_port=event.get("src_port", 0),
            dst_port=event.get("dst_port", 0),
            protocol=event.get("protocol", ""),
            is_attack=event.get("is_attack", False),
            attack_type=event.get("attack_type", "BENIGN"),
            binary_confidence=event.get("binary_confidence", 0.0),
            severity=event.get("severity", "none"),
            created_at=event.get("timestamp", datetime.utcnow().isoformat()),
        ))
    
    return history_items
</file>

<file path="backend/app/routers/stats.py">
"""API routes for statistics."""
from fastapi import APIRouter
from app.store import prediction_store

router = APIRouter(prefix="/stats", tags=["stats"])


@router.get("/")
async def get_stats():
    """
    Get statistics computed from in-memory event store.
    """
    stats = prediction_store.get_stats()
    # Add total count for frontend compatibility
    stats["totalFlows"] = stats.get("total_flows", 0)
    stats["totalAttacks"] = stats.get("total_attacks", 0)
    stats["attackRatio"] = stats.get("attack_ratio", 0)
    stats["mostFrequentAttack"] = stats.get("most_frequent_attack", "N/A")
    return stats
</file>

<file path="backend/app/schemas/__init__.py">
"""Pydantic schemas."""
</file>

<file path="backend/app/schemas/prediction.py">
"""Pydantic schemas for API requests and responses."""
from pydantic import BaseModel, Field
from typing import Dict, Optional
from datetime import datetime


class FlowInput(BaseModel):
    """Input schema for flow prediction."""
    # Basic flow identifiers
    src_ip: str = Field(..., description="Source IP address")
    dst_ip: str = Field(..., description="Destination IP address")
    src_port: int = Field(..., ge=0, le=65535, description="Source port")
    dst_port: int = Field(..., ge=0, le=65535, description="Destination port")
    protocol: str = Field(..., description="Protocol (TCP, UDP, etc.)")
    
    # Flow statistics - all features from FEATURE_COLUMNS
    destination_port: Optional[int] = None
    flow_duration: Optional[int] = None
    total_fwd_packets: Optional[int] = None
    total_backward_packets: Optional[int] = None
    total_length_of_fwd_packets: Optional[int] = None
    total_length_of_bwd_packets: Optional[int] = None
    fwd_packet_length_max: Optional[int] = None
    fwd_packet_length_min: Optional[int] = None
    fwd_packet_length_mean: Optional[float] = None
    fwd_packet_length_std: Optional[float] = None
    bwd_packet_length_max: Optional[int] = None
    bwd_packet_length_min: Optional[int] = None
    bwd_packet_length_mean: Optional[float] = None
    bwd_packet_length_std: Optional[float] = None
    flow_bytes_s: Optional[float] = None
    flow_packets_s: Optional[float] = None
    flow_iat_mean: Optional[float] = None
    flow_iat_std: Optional[float] = None
    flow_iat_max: Optional[int] = None
    flow_iat_min: Optional[int] = None
    fwd_iat_total: Optional[int] = None
    fwd_iat_mean: Optional[float] = None
    fwd_iat_std: Optional[float] = None
    fwd_iat_max: Optional[int] = None
    fwd_iat_min: Optional[int] = None
    bwd_iat_total: Optional[int] = None
    bwd_iat_mean: Optional[float] = None
    bwd_iat_std: Optional[float] = None
    bwd_iat_max: Optional[int] = None
    bwd_iat_min: Optional[int] = None
    fwd_psh_flags: Optional[int] = None
    fwd_urg_flags: Optional[int] = None
    fwd_header_length: Optional[int] = None
    bwd_header_length: Optional[int] = None
    fwd_packets_s: Optional[float] = None
    bwd_packets_s: Optional[float] = None
    min_packet_length: Optional[int] = None
    max_packet_length: Optional[int] = None
    packet_length_mean: Optional[float] = None
    packet_length_std: Optional[float] = None
    packet_length_variance: Optional[float] = None
    fin_flag_count: Optional[int] = None
    syn_flag_count: Optional[int] = None
    rst_flag_count: Optional[int] = None
    psh_flag_count: Optional[int] = None
    ack_flag_count: Optional[int] = None
    urg_flag_count: Optional[int] = None
    cwe_flag_count: Optional[int] = None
    ece_flag_count: Optional[int] = None
    down_up_ratio: Optional[int] = None
    average_packet_size: Optional[float] = None
    avg_fwd_segment_size: Optional[float] = None
    avg_bwd_segment_size: Optional[float] = None
    fwd_header_length_1: Optional[int] = None
    subflow_fwd_packets: Optional[int] = None
    subflow_fwd_bytes: Optional[int] = None
    subflow_bwd_packets: Optional[int] = None
    subflow_bwd_bytes: Optional[int] = None
    init_win_bytes_forward: Optional[int] = None
    init_win_bytes_backward: Optional[int] = None
    act_data_pkt_fwd: Optional[int] = None
    min_seg_size_forward: Optional[int] = None
    active_mean: Optional[float] = None
    active_std: Optional[float] = None
    active_max: Optional[int] = None
    active_min: Optional[int] = None
    idle_mean: Optional[float] = None
    idle_std: Optional[float] = None
    idle_max: Optional[int] = None
    idle_min: Optional[int] = None
    
    def to_flow_dict(self) -> Dict:
        """Convert to dictionary with proper column names matching FEATURE_COLUMNS."""
        # Map schema field names to feature column names
        # Note: destination_port in features should use dst_port if destination_port not provided
        mapping = {
            'destination_port': 'Destination Port',
            'flow_duration': 'Flow Duration',
            'total_fwd_packets': 'Total Fwd Packets',
            'total_backward_packets': 'Total Backward Packets',
            'total_length_of_fwd_packets': 'Total Length of Fwd Packets',
            'total_length_of_bwd_packets': 'Total Length of Bwd Packets',
            'fwd_packet_length_max': 'Fwd Packet Length Max',
            'fwd_packet_length_min': 'Fwd Packet Length Min',
            'fwd_packet_length_mean': 'Fwd Packet Length Mean',
            'fwd_packet_length_std': 'Fwd Packet Length Std',
            'bwd_packet_length_max': 'Bwd Packet Length Max',
            'bwd_packet_length_min': 'Bwd Packet Length Min',
            'bwd_packet_length_mean': 'Bwd Packet Length Mean',
            'bwd_packet_length_std': 'Bwd Packet Length Std',
            'flow_bytes_s': 'Flow Bytes/s',
            'flow_packets_s': 'Flow Packets/s',
            'flow_iat_mean': 'Flow IAT Mean',
            'flow_iat_std': 'Flow IAT Std',
            'flow_iat_max': 'Flow IAT Max',
            'flow_iat_min': 'Flow IAT Min',
            'fwd_iat_total': 'Fwd IAT Total',
            'fwd_iat_mean': 'Fwd IAT Mean',
            'fwd_iat_std': 'Fwd IAT Std',
            'fwd_iat_max': 'Fwd IAT Max',
            'fwd_iat_min': 'Fwd IAT Min',
            'bwd_iat_total': 'Bwd IAT Total',
            'bwd_iat_mean': 'Bwd IAT Mean',
            'bwd_iat_std': 'Bwd IAT Std',
            'bwd_iat_max': 'Bwd IAT Max',
            'bwd_iat_min': 'Bwd IAT Min',
            'fwd_psh_flags': 'Fwd PSH Flags',
            'fwd_urg_flags': 'Fwd URG Flags',
            'fwd_header_length': 'Fwd Header Length',
            'bwd_header_length': 'Bwd Header Length',
            'fwd_packets_s': 'Fwd Packets/s',
            'bwd_packets_s': 'Bwd Packets/s',
            'min_packet_length': 'Min Packet Length',
            'max_packet_length': 'Max Packet Length',
            'packet_length_mean': 'Packet Length Mean',
            'packet_length_std': 'Packet Length Std',
            'packet_length_variance': 'Packet Length Variance',
            'fin_flag_count': 'FIN Flag Count',
            'syn_flag_count': 'SYN Flag Count',
            'rst_flag_count': 'RST Flag Count',
            'psh_flag_count': 'PSH Flag Count',
            'ack_flag_count': 'ACK Flag Count',
            'urg_flag_count': 'URG Flag Count',
            'cwe_flag_count': 'CWE Flag Count',
            'ece_flag_count': 'ECE Flag Count',
            'down_up_ratio': 'Down/Up Ratio',
            'average_packet_size': 'Average Packet Size',
            'avg_fwd_segment_size': 'Avg Fwd Segment Size',
            'avg_bwd_segment_size': 'Avg Bwd Segment Size',
            'fwd_header_length_1': 'Fwd Header Length.1',
            'subflow_fwd_packets': 'Subflow Fwd Packets',
            'subflow_fwd_bytes': 'Subflow Fwd Bytes',
            'subflow_bwd_packets': 'Subflow Bwd Packets',
            'subflow_bwd_bytes': 'Subflow Bwd Bytes',
            'init_win_bytes_forward': 'Init_Win_bytes_forward',
            'init_win_bytes_backward': 'Init_Win_bytes_backward',
            'act_data_pkt_fwd': 'act_data_pkt_fwd',
            'min_seg_size_forward': 'min_seg_size_forward',
            'active_mean': 'Active Mean',
            'active_std': 'Active Std',
            'active_max': 'Active Max',
            'active_min': 'Active Min',
            'idle_mean': 'Idle Mean',
            'idle_std': 'Idle Std',
            'idle_max': 'Idle Max',
            'idle_min': 'Idle Min',
        }
        
        flow_dict = {}
        for schema_key, feature_name in mapping.items():
            value = getattr(self, schema_key, None)
            if value is not None:
                flow_dict[feature_name] = value
        
        # Handle destination_port special case (use dst_port if destination_port not set)
        if 'Destination Port' not in flow_dict and self.dst_port is not None:
            flow_dict['Destination Port'] = self.dst_port
        
        return flow_dict


class PredictionResponse(BaseModel):
    """Response schema for flow prediction."""
    is_attack: bool
    attack_type: str
    binary_confidence: float
    class_probabilities: Dict[str, float]
    severity: str


class PredictionHistoryItem(BaseModel):
    """Schema for prediction history item."""
    id: int
    src_ip: str
    dst_ip: str
    src_port: int
    dst_port: int
    protocol: str
    is_attack: bool
    attack_type: str
    binary_confidence: float
    severity: str
    created_at: str
</file>

<file path="backend/app/services/__init__.py">
"""Services (packet sniffer, flow manager, etc.)."""
</file>

<file path="backend/app/services/flow_manager.py">
"""Flow manager for aggregating packets into flows."""
from collections import defaultdict
from datetime import datetime, timedelta
from typing import Dict, Optional, Tuple
import threading
import time


class Flow:
    """Represents a network flow (5-tuple)."""
    
    def __init__(self, src_ip: str, dst_ip: str, src_port: int, dst_port: int, protocol: str):
        self.src_ip = src_ip
        self.dst_ip = dst_ip
        self.src_port = src_port
        self.dst_port = dst_port
        self.protocol = protocol
        
        # Statistics
        self.total_fwd_packets = 0
        self.total_backward_packets = 0
        self.total_fwd_bytes = 0
        self.total_bwd_bytes = 0
        
        # Packet lengths
        self.fwd_packet_lengths = []
        self.bwd_packet_lengths = []
        
        # Timestamps
        self.first_seen = datetime.utcnow()
        self.last_seen = datetime.utcnow()
        self.fwd_timestamps = []
        self.bwd_timestamps = []
        
        # Flags
        self.fwd_psh_flags = 0
        self.fwd_urg_flags = 0
        self.fin_flags = 0
        self.syn_flags = 0
        self.rst_flags = 0
        self.psh_flags = 0
        self.ack_flags = 0
        self.urg_flags = 0
        self.cwe_flags = 0
        self.ece_flags = 0
        
        # Header lengths
        self.fwd_header_length = 0
        self.bwd_header_length = 0
        
        # Window sizes
        self.init_win_bytes_forward = 0
        self.init_win_bytes_backward = 0
        
        # Additional stats
        self.act_data_pkt_fwd = 0
        self.min_seg_size_forward = 0
        
        # Subflow stats
        self.subflow_fwd_packets = 0
        self.subflow_fwd_bytes = 0
        self.subflow_bwd_packets = 0
        self.subflow_bwd_bytes = 0
        
        # Active/Idle times (simplified - would need more complex tracking)
        self.active_times = []
        self.idle_times = []
    
    def add_packet(self, packet_info: Dict):
        """Add a packet to this flow."""
        direction = packet_info.get('direction', 'forward')  # 'forward' or 'backward'
        packet_size = packet_info.get('size', 0)
        header_size = packet_info.get('header_size', 0)
        flags = packet_info.get('flags', {})
        timestamp = packet_info.get('timestamp', datetime.utcnow())
        window_size = packet_info.get('window_size', 0)
        
        if direction == 'forward':
            self.total_fwd_packets += 1
            self.total_fwd_bytes += packet_size
            self.fwd_packet_lengths.append(packet_size)
            self.fwd_timestamps.append(timestamp)
            self.fwd_header_length += header_size
            if self.init_win_bytes_forward == 0:
                self.init_win_bytes_forward = window_size
        else:
            self.total_backward_packets += 1
            self.total_bwd_bytes += packet_size
            self.bwd_packet_lengths.append(packet_size)
            self.bwd_timestamps.append(timestamp)
            self.bwd_header_length += header_size
            if self.init_win_bytes_backward == 0:
                self.init_win_bytes_backward = window_size
        
        # Update flags
        if flags.get('PSH'):
            self.psh_flags += 1
            if direction == 'forward':
                self.fwd_psh_flags += 1
        if flags.get('URG'):
            self.urg_flags += 1
            if direction == 'forward':
                self.fwd_urg_flags += 1
        if flags.get('FIN'):
            self.fin_flags += 1
        if flags.get('SYN'):
            self.syn_flags += 1
        if flags.get('RST'):
            self.rst_flags += 1
        if flags.get('ACK'):
            self.ack_flags += 1
        if flags.get('CWE'):
            self.cwe_flags += 1
        if flags.get('ECE'):
            self.ece_flags += 1
        
        self.last_seen = timestamp
    
    def to_feature_dict(self) -> Dict:
        """Convert flow to feature dictionary matching FEATURE_COLUMNS."""
        import numpy as np
        
        flow_duration = (self.last_seen - self.first_seen).total_seconds() * 1000000  # microseconds
        
        # Calculate statistics
        fwd_packet_lengths = np.array(self.fwd_packet_lengths) if self.fwd_packet_lengths else np.array([0])
        bwd_packet_lengths = np.array(self.bwd_packet_lengths) if self.bwd_packet_lengths else np.array([0])
        all_packet_lengths = np.concatenate([fwd_packet_lengths, bwd_packet_lengths]) if len(fwd_packet_lengths) > 0 or len(bwd_packet_lengths) > 0 else np.array([0])
        
        # IAT (Inter-Arrival Time) calculations
        fwd_iat = np.diff([ts.timestamp() for ts in self.fwd_timestamps]) * 1000000 if len(self.fwd_timestamps) > 1 else np.array([0])
        bwd_iat = np.diff([ts.timestamp() for ts in self.bwd_timestamps]) * 1000000 if len(self.bwd_timestamps) > 1 else np.array([0])
        all_iat = np.concatenate([fwd_iat, bwd_iat]) if len(fwd_iat) > 0 or len(bwd_iat) > 0 else np.array([0])
        
        # Flow rates
        flow_bytes_per_s = (self.total_fwd_bytes + self.total_bwd_bytes) / flow_duration * 1000000 if flow_duration > 0 else 0
        flow_packets_per_s = (self.total_fwd_packets + self.total_backward_packets) / flow_duration * 1000000 if flow_duration > 0 else 0
        
        # Build feature dictionary
        features = {
            'Destination Port': self.dst_port,
            'Flow Duration': int(flow_duration),
            'Total Fwd Packets': self.total_fwd_packets,
            'Total Backward Packets': self.total_backward_packets,
            'Total Length of Fwd Packets': self.total_fwd_bytes,
            'Total Length of Bwd Packets': self.total_bwd_bytes,
            'Fwd Packet Length Max': int(fwd_packet_lengths.max()) if len(fwd_packet_lengths) > 0 else 0,
            'Fwd Packet Length Min': int(fwd_packet_lengths.min()) if len(fwd_packet_lengths) > 0 else 0,
            'Fwd Packet Length Mean': float(fwd_packet_lengths.mean()) if len(fwd_packet_lengths) > 0 else 0.0,
            'Fwd Packet Length Std': float(fwd_packet_lengths.std()) if len(fwd_packet_lengths) > 0 else 0.0,
            'Bwd Packet Length Max': int(bwd_packet_lengths.max()) if len(bwd_packet_lengths) > 0 else 0,
            'Bwd Packet Length Min': int(bwd_packet_lengths.min()) if len(bwd_packet_lengths) > 0 else 0,
            'Bwd Packet Length Mean': float(bwd_packet_lengths.mean()) if len(bwd_packet_lengths) > 0 else 0.0,
            'Bwd Packet Length Std': float(bwd_packet_lengths.std()) if len(bwd_packet_lengths) > 0 else 0.0,
            'Flow Bytes/s': flow_bytes_per_s if not np.isinf(flow_bytes_per_s) and not np.isnan(flow_bytes_per_s) else 0.0,
            'Flow Packets/s': flow_packets_per_s if not np.isinf(flow_packets_per_s) and not np.isnan(flow_packets_per_s) else 0.0,
            'Flow IAT Mean': float(all_iat.mean()) if len(all_iat) > 0 else 0.0,
            'Flow IAT Std': float(all_iat.std()) if len(all_iat) > 0 else 0.0,
            'Flow IAT Max': int(all_iat.max()) if len(all_iat) > 0 else 0,
            'Flow IAT Min': int(all_iat.min()) if len(all_iat) > 0 else 0,
            'Fwd IAT Total': int(fwd_iat.sum()) if len(fwd_iat) > 0 else 0,
            'Fwd IAT Mean': float(fwd_iat.mean()) if len(fwd_iat) > 0 else 0.0,
            'Fwd IAT Std': float(fwd_iat.std()) if len(fwd_iat) > 0 else 0.0,
            'Fwd IAT Max': int(fwd_iat.max()) if len(fwd_iat) > 0 else 0,
            'Fwd IAT Min': int(fwd_iat.min()) if len(fwd_iat) > 0 else 0,
            'Bwd IAT Total': int(bwd_iat.sum()) if len(bwd_iat) > 0 else 0,
            'Bwd IAT Mean': float(bwd_iat.mean()) if len(bwd_iat) > 0 else 0.0,
            'Bwd IAT Std': float(bwd_iat.std()) if len(bwd_iat) > 0 else 0.0,
            'Bwd IAT Max': int(bwd_iat.max()) if len(bwd_iat) > 0 else 0,
            'Bwd IAT Min': int(bwd_iat.min()) if len(bwd_iat) > 0 else 0,
            'Fwd PSH Flags': self.fwd_psh_flags,
            'Fwd URG Flags': self.fwd_urg_flags,
            'Fwd Header Length': self.fwd_header_length,
            'Bwd Header Length': self.bwd_header_length,
            'Fwd Packets/s': self.total_fwd_packets / flow_duration * 1000000 if flow_duration > 0 else 0.0,
            'Bwd Packets/s': self.total_backward_packets / flow_duration * 1000000 if flow_duration > 0 else 0.0,
            'Min Packet Length': int(all_packet_lengths.min()) if len(all_packet_lengths) > 0 else 0,
            'Max Packet Length': int(all_packet_lengths.max()) if len(all_packet_lengths) > 0 else 0,
            'Packet Length Mean': float(all_packet_lengths.mean()) if len(all_packet_lengths) > 0 else 0.0,
            'Packet Length Std': float(all_packet_lengths.std()) if len(all_packet_lengths) > 0 else 0.0,
            'Packet Length Variance': float(all_packet_lengths.var()) if len(all_packet_lengths) > 0 else 0.0,
            'FIN Flag Count': self.fin_flags,
            'SYN Flag Count': self.syn_flags,
            'RST Flag Count': self.rst_flags,
            'PSH Flag Count': self.psh_flags,
            'ACK Flag Count': self.ack_flags,
            'URG Flag Count': self.urg_flags,
            'CWE Flag Count': self.cwe_flags,
            'ECE Flag Count': self.ece_flags,
            'Down/Up Ratio': self.total_fwd_packets / self.total_backward_packets if self.total_backward_packets > 0 else 0,
            'Average Packet Size': float(all_packet_lengths.mean()) if len(all_packet_lengths) > 0 else 0.0,
            'Avg Fwd Segment Size': float(fwd_packet_lengths.mean()) if len(fwd_packet_lengths) > 0 else 0.0,
            'Avg Bwd Segment Size': float(bwd_packet_lengths.mean()) if len(bwd_packet_lengths) > 0 else 0.0,
            'Fwd Header Length.1': self.fwd_header_length,  # Duplicate in original dataset
            'Subflow Fwd Packets': self.subflow_fwd_packets,
            'Subflow Fwd Bytes': self.subflow_fwd_bytes,
            'Subflow Bwd Packets': self.subflow_bwd_packets,
            'Subflow Bwd Bytes': self.subflow_bwd_bytes,
            'Init_Win_bytes_forward': self.init_win_bytes_forward,
            'Init_Win_bytes_backward': self.init_win_bytes_backward,
            'act_data_pkt_fwd': self.act_data_pkt_fwd,
            'min_seg_size_forward': self.min_seg_size_forward,
            'Active Mean': float(np.mean(self.active_times)) if self.active_times else 0.0,
            'Active Std': float(np.std(self.active_times)) if self.active_times else 0.0,
            'Active Max': int(np.max(self.active_times)) if self.active_times else 0,
            'Active Min': int(np.min(self.active_times)) if self.active_times else 0,
            'Idle Mean': float(np.mean(self.idle_times)) if self.idle_times else 0.0,
            'Idle Std': float(np.std(self.idle_times)) if self.idle_times else 0.0,
            'Idle Max': int(np.max(self.idle_times)) if self.idle_times else 0,
            'Idle Min': int(np.min(self.idle_times)) if self.idle_times else 0,
        }
        
        return features


class FlowManager:
    """Manages network flows and expires idle flows."""
    
    def __init__(self, idle_timeout: int = 60):
        self.flows: Dict[Tuple[str, str, int, int, str], Flow] = {}
        self.idle_timeout = idle_timeout
        self.lock = threading.Lock()
        self._running = False
        self._cleanup_thread = None
    
    def start(self):
        """Start the cleanup thread."""
        if self._running:
            return
        self._running = True
        self._cleanup_thread = threading.Thread(target=self._cleanup_loop, daemon=True)
        self._cleanup_thread.start()
    
    def stop(self):
        """Stop the cleanup thread."""
        self._running = False
        if self._cleanup_thread:
            self._cleanup_thread.join(timeout=2)
    
    def _cleanup_loop(self):
        """Periodically clean up expired flows."""
        while self._running:
            time.sleep(5)  # Check every 5 seconds
            self.expire_flows()
    
    def get_flow_key(self, src_ip: str, dst_ip: str, src_port: int, dst_port: int, protocol: str) -> Tuple[str, str, int, int, str]:
        """Get flow key (normalized 5-tuple)."""
        # Normalize: always use smaller IP/port as source
        if src_ip > dst_ip or (src_ip == dst_ip and src_port > dst_port):
            return (dst_ip, src_ip, dst_port, src_port, protocol)
        return (src_ip, dst_ip, src_port, dst_port, protocol)
    
    def add_packet(self, src_ip: str, dst_ip: str, src_port: int, dst_port: int, protocol: str, packet_info: Dict) -> Optional[Flow]:
        """Add a packet to a flow. Returns the flow if it was just expired."""
        key = self.get_flow_key(src_ip, dst_ip, src_port, dst_port, protocol)
        
        with self.lock:
            if key not in self.flows:
                self.flows[key] = Flow(src_ip, dst_ip, src_port, dst_port, protocol)
            
            flow = self.flows[key]
            flow.add_packet(packet_info)
            
            return None
    
    def expire_flows(self) -> list[Flow]:
        """Expire flows that have been idle too long. Returns expired flows."""
        now = datetime.utcnow()
        expired = []
        
        with self.lock:
            keys_to_remove = []
            for key, flow in self.flows.items():
                idle_time = (now - flow.last_seen).total_seconds()
                if idle_time > self.idle_timeout:
                    expired.append(flow)
                    keys_to_remove.append(key)
            
            for key in keys_to_remove:
                del self.flows[key]
        
        return expired
    
    def flush_active_flows(self, min_packets: int = 5, max_age_seconds: int = 10) -> list[Flow]:
        """Flush active flows that have enough packets or are old enough. Returns flushed flows."""
        now = datetime.utcnow()
        flushed = []
        
        with self.lock:
            keys_to_remove = []
            for key, flow in self.flows.items():
                age = (now - flow.first_seen).total_seconds()
                # Calculate total packet count from forward and backward packets
                packet_count = flow.total_fwd_packets + flow.total_backward_packets
                
                # Flush if flow has enough packets OR is old enough
                if packet_count >= min_packets or age >= max_age_seconds:
                    flushed.append(flow)
                    keys_to_remove.append(key)
            
            for key in keys_to_remove:
                del self.flows[key]
        
        return flushed
    
    def get_expired_flows(self) -> list[Flow]:
        """Get expired flows without removing them (for inspection)."""
        now = datetime.utcnow()
        expired = []
        
        with self.lock:
            for flow in self.flows.values():
                idle_time = (now - flow.last_seen).total_seconds()
                if idle_time > self.idle_timeout:
                    expired.append(flow)
        
        return expired
    
    def get_active_flow_count(self) -> int:
        """Get number of active flows."""
        with self.lock:
            return len(self.flows)
</file>

<file path="backend/app/services/packet_sniffer.py">
"""Packet sniffer for live network monitoring."""
import threading
from typing import Callable, Optional
from datetime import datetime

try:
    from scapy.all import sniff, IP, TCP, UDP, ICMP
    SCAPY_AVAILABLE = True
except ImportError:
    SCAPY_AVAILABLE = False
    print("Warning: scapy not available. Install with: pip install scapy")


class PacketSniffer:
    """Packet sniffer that captures packets and feeds them to a flow manager."""
    
    def __init__(self, interface: str, flow_manager, on_flow_complete: Callable):
        self.interface = interface
        self.flow_manager = flow_manager
        self.on_flow_complete = on_flow_complete
        self._running = False
        self._sniff_thread: Optional[threading.Thread] = None
        self._packet_count = 0
        self._processed_count = 0
        self._last_error: Optional[str] = None
    
    def start(self):
        """Start packet sniffing."""
        if not SCAPY_AVAILABLE:
            raise RuntimeError("scapy is not installed. Install with: pip install scapy")
        
        if self._running:
            return
        
        self._running = True
        self._sniff_thread = threading.Thread(target=self._sniff_loop, daemon=True)
        self._sniff_thread.start()
        print(f"âœ“ Started packet sniffer on interface: {self.interface}")
    
    def stop(self):
        """Stop packet sniffing."""
        self._running = False
        if self._sniff_thread:
            self._sniff_thread.join(timeout=2)
    
    def _sniff_loop(self):
        """Main sniffing loop."""
        try:
            # Check if interface exists before starting
            from scapy.all import get_if_list
            available_interfaces = get_if_list()
            if self.interface not in available_interfaces:
                print(f"âš  Warning: Interface '{self.interface}' not found. Available interfaces: {available_interfaces}")
                print(f"   Sniffer will continue but may fail. Consider setting INTERFACE_NAME to a valid interface.")
            
            sniff(
                iface=self.interface,
                prn=self._process_packet,
                store=False,
                stop_filter=lambda x: not self._running,
            )
        except OSError as e:
            # Handle permission/interface errors gracefully
            error_msg = str(e)
            self._last_error = error_msg
            if "BIOCSETIF" in error_msg or "Operation not permitted" in error_msg:
                print(f"âš  Permission error: Cannot access interface '{self.interface}'")
                print(f"   Run with sudo or grant network permissions to your terminal/IDE.")
                print(f"   Example: sudo uvicorn app.main:app --reload")
            else:
                print(f"âš  Interface error: {error_msg}")
            self._running = False
        except Exception as e:
            error_msg = str(e)
            self._last_error = error_msg
            print(f"âš  Error in packet sniffer: {error_msg}")
            import traceback
            traceback.print_exc()
            self._running = False
    
    def _process_packet(self, packet):
        """Process a single packet."""
        if not self._running:
            return
        
        self._packet_count += 1
        
        try:
            # Extract IP layer
            if IP not in packet:
                return
            
            ip_layer = packet[IP]
            src_ip = ip_layer.src
            dst_ip = ip_layer.dst
            protocol = "Unknown"
            src_port = 0
            dst_port = 0
            
            # Extract protocol and ports
            if TCP in packet:
                protocol = "TCP"
                tcp_layer = packet[TCP]
                src_port = tcp_layer.sport
                dst_port = tcp_layer.dport
                flags = {
                    'FIN': bool(tcp_layer.flags & 0x01),
                    'SYN': bool(tcp_layer.flags & 0x02),
                    'RST': bool(tcp_layer.flags & 0x04),
                    'PSH': bool(tcp_layer.flags & 0x08),
                    'ACK': bool(tcp_layer.flags & 0x10),
                    'URG': bool(tcp_layer.flags & 0x20),
                    'ECE': bool(tcp_layer.flags & 0x40),
                    'CWE': bool(tcp_layer.flags & 0x80),
                }
                window_size = tcp_layer.window
            elif UDP in packet:
                protocol = "UDP"
                udp_layer = packet[UDP]
                src_port = udp_layer.sport
                dst_port = udp_layer.dport
                flags = {}
                window_size = 0
            elif ICMP in packet:
                protocol = "ICMP"
                flags = {}
                window_size = 0
            else:
                return  # Skip non-TCP/UDP/ICMP
            
            # Determine direction (simplified: assume first packet is forward)
            # In a real system, you'd track connection state
            direction = "forward" if src_port < dst_port or src_ip < dst_ip else "backward"
            
            # Calculate packet size
            packet_size = len(packet)
            header_size = len(ip_layer) - (len(ip_layer.payload) if hasattr(ip_layer, 'payload') else 0)
            
            # Build packet info
            packet_info = {
                'direction': direction,
                'size': packet_size,
                'header_size': header_size,
                'flags': flags,
                'timestamp': datetime.utcnow(),
                'window_size': window_size,
            }
            
            # Add to flow manager
            self.flow_manager.add_packet(
                src_ip, dst_ip, src_port, dst_port, protocol, packet_info
            )
            self._processed_count += 1
            
            # Log first few packets for debugging
            if self._processed_count <= 5:
                print(f"  [Sniffer] Processed packet #{self._processed_count}: {src_ip}:{src_port} -> {dst_ip}:{dst_port} ({protocol})")
        
        except Exception as e:
            # Log errors for debugging
            if self._packet_count <= 10:
                print(f"  [Sniffer] Error processing packet: {e}")
            self._last_error = str(e)
    
    def get_stats(self):
        """Get sniffer statistics."""
        return {
            "packet_count": self._packet_count,
            "processed_count": self._processed_count,
            "last_error": self._last_error,
        }
</file>

<file path="backend/app/store/__init__.py">
"""In-memory event store."""
from app.store.prediction_store import prediction_store, PredictionStore

__all__ = ["prediction_store", "PredictionStore"]
</file>

<file path="backend/app/store/prediction_store.py">
"""In-memory event store for predictions."""
from collections import deque
from datetime import datetime
from typing import List, Dict, Optional


class PredictionStore:
    """In-memory event store for predictions."""
    
    def __init__(self, maxlen: int = 2000):
        """
        Initialize the prediction store.
        
        Args:
            maxlen: Maximum number of events to store (default: 2000)
        """
        self.events = deque(maxlen=maxlen)
    
    def add_event(self, event: Dict):
        """
        Add a prediction event to the store.
        
        Args:
            event: Dictionary containing prediction data. Must include:
                - timestamp (or will be set to current time)
                - src_ip, dst_ip, src_port, dst_port, protocol
                - is_attack, attack_type, binary_confidence, severity
        """
        # Ensure timestamp exists
        if "timestamp" not in event or event["timestamp"] is None:
            event["timestamp"] = datetime.utcnow().isoformat()
        
        # Add event at the left (newest first)
        self.events.appendleft(event)
    
    def get_recent(self, limit: int = 100) -> List[Dict]:
        """
        Get recent prediction events.
        
        Args:
            limit: Maximum number of events to return (default: 100)
            
        Returns:
            List of event dictionaries, newest first
        """
        return list(self.events)[:limit]
    
    def get_all(self) -> List[Dict]:
        """
        Get all stored events.
        
        Returns:
            List of all event dictionaries, newest first
        """
        return list(self.events)
    
    def get_stats(self) -> Dict:
        """
        Compute statistics from stored events.
        
        Returns:
            Dictionary with stats:
                - total_flows: Total number of events
                - total_attacks: Number of attack events
                - attack_ratio: Percentage of attacks
                - attack_type_distribution: Count by attack type
        """
        events = list(self.events)
        total_flows = len(events)
        attacks = [e for e in events if e.get("is_attack", False)]
        total_attacks = len(attacks)
        attack_ratio = (total_attacks / total_flows * 100) if total_flows > 0 else 0.0
        
        # Attack type distribution
        attack_type_dist = {}
        for event in attacks:
            attack_type = event.get("attack_type", "Unknown")
            attack_type_dist[attack_type] = attack_type_dist.get(attack_type, 0) + 1
        
        # Most frequent attack type
        most_frequent = max(attack_type_dist.items(), key=lambda x: x[1])[0] if attack_type_dist else "N/A"
        
        return {
            "total_flows": total_flows,
            "total_attacks": total_attacks,
            "attack_ratio": round(attack_ratio, 2),
            "most_frequent_attack": most_frequent,
            "attack_type_distribution": attack_type_dist,
        }


# Global instance
prediction_store = PredictionStore()
</file>

<file path="backend/app/__init__.py">
"""IDS Backend Application."""
</file>

<file path="backend/app/__main__.py">
"""Entry point for running the application directly."""
import uvicorn

if __name__ == "__main__":
    uvicorn.run(
        "app.main:app",
        host="0.0.0.0",
        port=8000,
        reload=True,
    )
</file>

<file path="backend/app/config.py">
"""Configuration settings for the IDS backend."""
from pydantic_settings import BaseSettings
from typing import Optional


class Settings(BaseSettings):
    """Application settings loaded from environment variables."""
    
    # API Settings
    API_V1_PREFIX: str = "/api"
    PROJECT_NAME: str = "IDS System"
    VERSION: str = "1.0.0"
    
    # Network Interface
    # Common options: bridge0, bridge100, en0
    # Use 'bridge100' for Multipass VMs on macOS
    INTERFACE_NAME: str = "bridge100"  # Default for macOS Multipass
    
    # Model Paths
    MODEL_DIR: str = "saved_models"
    BINARY_MODEL_PATH: str = "saved_models/binary_svm_model.pkl"
    MULTICLASS_MODEL_PATH: str = "saved_models/multiclass_rf_model.pkl"
    SCALER_PATH: str = "saved_models/scaler.pkl"
    PCA_PATH: str = "saved_models/pca.pkl"
    
    # Flow Manager Settings
    FLOW_IDLE_TIMEOUT: int = 60  # seconds
    FLOW_BATCH_SIZE: int = 10  # batch predictions
    
    # CORS
    CORS_ORIGINS: list[str] = [
        "http://localhost:3000",
        "http://localhost:5173",
        "http://127.0.0.1:3000",
        "http://127.0.0.1:5173",
    ]
    
    class Config:
        env_file = ".env"
        case_sensitive = True


settings = Settings()
</file>

<file path="backend/app/main.py">
"""Main FastAPI application."""
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from contextlib import asynccontextmanager
import asyncio
from datetime import datetime
import json

from app.config import settings
from app.store import prediction_store
from app.ml.predictor import predictor
from app.services.flow_manager import FlowManager
from app.services.packet_sniffer import PacketSniffer
from app.routers import predictions, models, health, stats
from app.routers.health import router as health_router

# WebSocket manager
websocket_connections = set()


@asynccontextmanager
async def lifespan(app: FastAPI):
    """Startup and shutdown events."""
    # Startup
    print("=" * 50)
    print("Starting IDS System...")
    print("=" * 50)
    
    # Load ML models
    try:
        predictor.load_models()
        print("âœ“ Models loaded successfully")
    except Exception as e:
        print(f"âœ— Error loading models: {e}")
        raise
    
    # Initialize flow manager
    flow_manager = FlowManager(idle_timeout=settings.FLOW_IDLE_TIMEOUT)
    flow_manager.start()
    print("âœ“ Flow manager started")
    
    # Initialize packet sniffer (but don't start automatically)
    sniffer = None
    try:
        sniffer = PacketSniffer(
            interface=settings.INTERFACE_NAME,
            flow_manager=flow_manager,
            on_flow_complete=lambda flow: handle_completed_flow(flow),
        )
        # Don't start automatically - user can start via API
        print(f"âœ“ Packet sniffer initialized (not started - use /api/health/sniffer/start to begin)")
    except Exception as e:
        print(f"âš  Warning: Could not initialize packet sniffer: {e}")
        print("  You can still use the API for manual predictions.")
    
    # Start background task to process expired and active flows
    async def process_flows():
        while True:
            await asyncio.sleep(5)  # Check every 5 seconds
            
            # Process expired flows (idle > 60 seconds)
            expired_flows = flow_manager.expire_flows()
            if expired_flows:
                print(f"  [Flow Processor] Processing {len(expired_flows)} expired flows")
            for flow in expired_flows:
                handle_completed_flow(flow)
            
            # Also flush active flows that have enough packets or are old enough
            # This ensures flows appear faster (every 5 seconds or after 3 packets)
            flushed_flows = flow_manager.flush_active_flows(min_packets=3, max_age_seconds=5)
            if flushed_flows:
                print(f"  [Flow Processor] Flushing {len(flushed_flows)} active flows")
            for flow in flushed_flows:
                handle_completed_flow(flow)
    
    asyncio.create_task(process_flows())
    
    # Store references
    app.state.flow_manager = flow_manager
    app.state.sniffer = sniffer
    health.sniffer = sniffer
    health.flow_manager = flow_manager
    
    print("=" * 50)
    print("IDS System ready!")
    print("=" * 50)
    
    yield
    
    # Shutdown
    print("\nShutting down IDS System...")
    if sniffer:
        sniffer.stop()
    if flow_manager:
        flow_manager.stop()
    print("âœ“ Shutdown complete")


def handle_completed_flow(flow):
    """Handle a completed flow: predict and broadcast."""
    try:
        # Convert flow to feature dictionary
        flow_dict = flow.to_feature_dict()
        
        # Make prediction
        result = predictor.predict(flow_dict)
        
        # Determine severity
        if result.is_attack:
            if result.binary_confidence > 0.9:
                severity = "high"
            elif result.binary_confidence > 0.7:
                severity = "medium"
            else:
                severity = "low"
        else:
            severity = "none"
        
        # Create event dictionary
        event = {
            "timestamp": datetime.utcnow().isoformat(),
            "src_ip": flow.src_ip,
            "dst_ip": flow.dst_ip,
            "src_port": flow.src_port,
            "dst_port": flow.dst_port,
            "protocol": flow.protocol,
            "is_attack": result.is_attack,
            "attack_type": result.attack_type,
            "severity": severity,
            "confidence": result.binary_confidence,
            "binary_confidence": result.binary_confidence,  # Also include for history endpoint
        }
        
        # Add to in-memory store
        prediction_store.add_event(event)
        
        # Log successful processing
        print(f"âœ“ Processed flow: {flow.src_ip}:{flow.src_port} -> {flow.dst_ip}:{flow.dst_port} ({flow.protocol}) - {result.attack_type} (confidence: {result.binary_confidence:.2f})")
        
        # Broadcast to all connected WebSocket clients
        asyncio.create_task(broadcast_websocket(event))
    
    except Exception as e:
        import traceback
        print(f"âœ— Error handling completed flow: {e}")
        print(f"  Flow: {flow.src_ip}:{flow.src_port} -> {flow.dst_ip}:{flow.dst_port} ({flow.protocol})")
        traceback.print_exc()


async def broadcast_websocket(event: dict):
    """Broadcast event to all WebSocket connections."""
    if not websocket_connections:
        return  # No clients connected
    
    message = json.dumps(event)
    disconnected = set()
    
    for ws in websocket_connections:
        try:
            await ws.send_text(message)
        except Exception as e:
            print(f"  [WebSocket] Error sending to client: {e}")
            disconnected.add(ws)
    
    # Remove disconnected clients
    websocket_connections.difference_update(disconnected)
    
    if websocket_connections:
        print(f"  [WebSocket] Broadcasted event to {len(websocket_connections)} client(s)")


# Create FastAPI app
app = FastAPI(
    title=settings.PROJECT_NAME,
    version=settings.VERSION,
    lifespan=lifespan,
)

# CORS middleware
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.CORS_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Include routers
app.include_router(predictions.router, prefix=settings.API_V1_PREFIX)
app.include_router(models.router, prefix=settings.API_V1_PREFIX)
app.include_router(health_router, prefix=settings.API_V1_PREFIX)
app.include_router(stats.router, prefix=settings.API_V1_PREFIX)


# WebSocket endpoint
from fastapi import WebSocket, WebSocketDisconnect

@app.websocket(f"{settings.API_V1_PREFIX}/live")
async def websocket_endpoint(websocket: WebSocket):
    """WebSocket endpoint for live prediction events."""
    await websocket.accept()
    websocket_connections.add(websocket)
    
    try:
        while True:
            # Keep connection alive and wait for client messages (if any)
            data = await websocket.receive_text()
            # Echo back or handle client messages if needed
    except WebSocketDisconnect:
        websocket_connections.discard(websocket)


@app.get("/")
async def root():
    """Root endpoint."""
    return {
        "message": "IDS System API",
        "version": settings.VERSION,
        "docs": "/docs",
    }
</file>

<file path="backend/requirements.txt">
fastapi>=0.115.0
uvicorn[standard]>=0.32.0
pydantic>=2.10.0
pydantic-settings>=2.6.0
scapy==2.5.0
scikit-learn>=1.4.2
numpy>=1.26.0
pandas>=2.1.3
joblib>=1.3.2
python-multipart>=0.0.12
</file>

<file path="frontend/public/vite.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>
</file>

<file path="frontend/src/api/client.js">
/** API client for backend communication */
import axios from 'axios';
import { API_BASE_URL } from '../config';

const api = axios.create({
  baseURL: `${API_BASE_URL}/api`,
  headers: {
    'Content-Type': 'application/json',
  },
});

export default api;
</file>

<file path="frontend/src/assets/react.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>
</file>

<file path="frontend/src/contexts/WebSocketContext.jsx">
import { createContext, useContext, useEffect, useRef, useState, useCallback } from 'react';
import { WS_BASE_URL } from '../config';

const WebSocketContext = createContext(null);

export function WebSocketProvider({ children }) {
  const [isConnected, setIsConnected] = useState(false);
  const [lastMessage, setLastMessage] = useState(null);
  const wsRef = useRef(null);
  const reconnectTimeoutRef = useRef(null);
  const messageHandlersRef = useRef(new Set());

  const connect = useCallback(() => {
    // Don't connect if already connected or connecting
    if (wsRef.current && (
      wsRef.current.readyState === WebSocket.OPEN || 
      wsRef.current.readyState === WebSocket.CONNECTING
    )) {
      return;
    }

    try {
      const wsUrl = WS_BASE_URL.endsWith('/') ? WS_BASE_URL.slice(0, -1) : WS_BASE_URL;
      const ws = new WebSocket(`${wsUrl}/api/live`);
      wsRef.current = ws;

      ws.onopen = () => {
        setIsConnected(true);
        console.log('WebSocket connected (global)');
        if (reconnectTimeoutRef.current) {
          clearTimeout(reconnectTimeoutRef.current);
          reconnectTimeoutRef.current = null;
        }
      };

      ws.onmessage = (event) => {
        try {
          const data = JSON.parse(event.data);
          setLastMessage(data);
          // Notify all registered handlers
          messageHandlersRef.current.forEach(handler => {
            try {
              handler(data);
            } catch (error) {
              console.error('Error in WebSocket message handler:', error);
            }
          });
          console.log('WebSocket message received:', data);
        } catch (error) {
          console.error('Error parsing WebSocket message:', error);
        }
      };

      ws.onerror = (error) => {
        console.error('WebSocket error:', error);
        setIsConnected(false);
      };

      ws.onclose = () => {
        setIsConnected(false);
        console.log('WebSocket disconnected (global)');
        // Auto-reconnect after 3 seconds
        reconnectTimeoutRef.current = setTimeout(() => {
          connect();
        }, 3000);
      };
    } catch (error) {
      console.error('Error connecting WebSocket:', error);
      setIsConnected(false);
    }
  }, []);

  const disconnect = useCallback(() => {
    if (reconnectTimeoutRef.current) {
      clearTimeout(reconnectTimeoutRef.current);
      reconnectTimeoutRef.current = null;
    }
    if (wsRef.current) {
      wsRef.current.close();
      wsRef.current = null;
    }
    setIsConnected(false);
  }, []);

  const subscribe = useCallback((handler) => {
    messageHandlersRef.current.add(handler);
    return () => {
      messageHandlersRef.current.delete(handler);
    };
  }, []);

  // Auto-connect on mount
  useEffect(() => {
    connect();
    return () => {
      disconnect();
    };
  }, [connect, disconnect]);

  const value = {
    isConnected,
    lastMessage,
    connect,
    disconnect,
    subscribe,
  };

  return (
    <WebSocketContext.Provider value={value}>
      {children}
    </WebSocketContext.Provider>
  );
}

export function useWebSocket() {
  const context = useContext(WebSocketContext);
  if (!context) {
    throw new Error('useWebSocket must be used within WebSocketProvider');
  }
  return context;
}
</file>

<file path="frontend/src/pages/Dashboard.jsx">
import { useState, useEffect } from 'react';
import api from '../api/client';
import { LineChart, Line, BarChart, Bar, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';

const COLORS = ['#3b82f6', '#ef4444', '#f59e0b', '#10b981', '#8b5cf6', '#ec4899'];

function Dashboard() {
  const [stats, setStats] = useState({
    totalFlows: 0,
    totalAttacks: 0,
    attackRatio: 0,
    mostFrequentAttack: 'N/A',
  });
  const [attacksOverTime, setAttacksOverTime] = useState([]);
  const [attackTypeDistribution, setAttackTypeDistribution] = useState([]);
  const [recentFlows, setRecentFlows] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchDashboardData();
    const interval = setInterval(fetchDashboardData, 5000); // Refresh every 5 seconds
    return () => clearInterval(interval);
  }, []);

  const fetchDashboardData = async () => {
    try {
      // Fetch history
      const historyRes = await api.get('/predictions/history?limit=1000');
      const history = historyRes.data;

      // Calculate stats
      const totalFlows = history.length;
      const attacks = history.filter(h => h.is_attack);
      const totalAttacks = attacks.length;
      const attackRatio = totalFlows > 0 ? (totalAttacks / totalFlows) * 100 : 0;

      // Most frequent attack type
      const attackTypes = attacks.reduce((acc, a) => {
        acc[a.attack_type] = (acc[a.attack_type] || 0) + 1;
        return acc;
      }, {});
      const mostFrequent = Object.entries(attackTypes).sort((a, b) => b[1] - a[1])[0];
      const mostFrequentAttack = mostFrequent ? mostFrequent[0] : 'N/A';

      setStats({ totalFlows, totalAttacks, attackRatio, mostFrequentAttack });

      // Attacks over time (last 24 hours, grouped by hour)
      const now = new Date();
      const last24h = Array.from({ length: 24 }, (_, i) => {
        const hour = new Date(now.getTime() - (23 - i) * 60 * 60 * 1000);
        return {
          time: hour.getHours().toString().padStart(2, '0') + ':00',
          attacks: 0,
        };
      });

      history.forEach(h => {
        if (h.is_attack) {
          const date = new Date(h.created_at);
          const hoursAgo = Math.floor((now - date) / (60 * 60 * 1000));
          if (hoursAgo >= 0 && hoursAgo < 24) {
            last24h[23 - hoursAgo].attacks++;
          }
        }
      });

      setAttacksOverTime(last24h);

      // Attack type distribution
      const distribution = Object.entries(attackTypes).map(([type, count]) => ({
        name: type,
        value: count,
      }));
      setAttackTypeDistribution(distribution);

      // Recent flows (last 10)
      setRecentFlows(history.slice(0, 10));
      setLoading(false);
    } catch (error) {
      console.error('Error fetching dashboard data:', error);
      setLoading(false);
    }
  };

  const getSeverityColor = (severity) => {
    switch (severity) {
      case 'high': return 'bg-red-500';
      case 'medium': return 'bg-yellow-500';
      case 'low': return 'bg-orange-500';
      default: return 'bg-green-500';
    }
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <div className="text-white text-xl">Loading dashboard...</div>
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <h1 className="text-3xl font-bold text-white mb-8">Dashboard</h1>

      {/* Stats Cards */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-gray-400 text-sm font-medium mb-2">Total Flows (Today)</h3>
          <p className="text-3xl font-bold text-white">{stats.totalFlows}</p>
        </div>
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-gray-400 text-sm font-medium mb-2">Total Attacks</h3>
          <p className="text-3xl font-bold text-red-400">{stats.totalAttacks}</p>
        </div>
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-gray-400 text-sm font-medium mb-2">Attack Ratio</h3>
          <p className="text-3xl font-bold text-yellow-400">{stats.attackRatio.toFixed(2)}%</p>
        </div>
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-gray-400 text-sm font-medium mb-2">Most Frequent Attack</h3>
          <p className="text-3xl font-bold text-orange-400">{stats.mostFrequentAttack}</p>
        </div>
      </div>

      {/* Charts */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-white text-lg font-semibold mb-4">Attacks Over Time (24h)</h3>
          <ResponsiveContainer width="100%" height={300}>
            <LineChart data={attacksOverTime}>
              <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
              <XAxis dataKey="time" stroke="#9ca3af" />
              <YAxis stroke="#9ca3af" />
              <Tooltip contentStyle={{ backgroundColor: '#1f2937', border: '1px solid #374151' }} />
              <Line type="monotone" dataKey="attacks" stroke="#ef4444" strokeWidth={2} />
            </LineChart>
          </ResponsiveContainer>
        </div>

        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-white text-lg font-semibold mb-4">Attack Type Distribution</h3>
          <ResponsiveContainer width="100%" height={300}>
            <PieChart>
              <Pie
                data={attackTypeDistribution}
                cx="50%"
                cy="50%"
                labelLine={false}
                label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}
                outerRadius={80}
                fill="#8884d8"
                dataKey="value"
              >
                {attackTypeDistribution.map((entry, index) => (
                  <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                ))}
              </Pie>
              <Tooltip contentStyle={{ backgroundColor: '#1f2937', border: '1px solid #374151' }} />
            </PieChart>
          </ResponsiveContainer>
        </div>
      </div>

      {/* Recent Flows Table */}
      <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h3 className="text-white text-lg font-semibold mb-4">Recent Flows</h3>
        <div className="overflow-x-auto">
          <table className="min-w-full divide-y divide-gray-700">
            <thead>
              <tr>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Time</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Source</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Destination</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Type</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Severity</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-700">
              {recentFlows.map((flow) => (
                <tr key={flow.id}>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                    {new Date(flow.created_at).toLocaleTimeString()}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                    {flow.src_ip}:{flow.src_port}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                    {flow.dst_ip}:{flow.dst_port}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm">
                    <span className={flow.is_attack ? 'text-red-400' : 'text-green-400'}>
                      {flow.attack_type}
                    </span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm">
                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getSeverityColor(flow.severity)}`}>
                      {flow.severity}
                    </span>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}

export default Dashboard;
</file>

<file path="frontend/src/pages/FlowAnalyzer.jsx">
import { useState } from 'react';
import api from '../api/client';

function FlowAnalyzer() {
  const [formData, setFormData] = useState({
    src_ip: '',
    dst_ip: '',
    src_port: '',
    dst_port: '',
    protocol: 'TCP',
    // Initialize all feature fields (simplified - in production you'd want all 70 features)
    destination_port: '',
    flow_duration: '',
    total_fwd_packets: '',
    total_backward_packets: '',
  });
  const [result, setResult] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  const handleChange = (e) => {
    setFormData({
      ...formData,
      [e.target.name]: e.target.value,
    });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError(null);
    setResult(null);

    try {
      // Convert form data to API format
      const payload = {
        ...formData,
        src_port: parseInt(formData.src_port) || 0,
        dst_port: parseInt(formData.dst_port) || 0,
        destination_port: parseInt(formData.destination_port) || 0,
        flow_duration: parseInt(formData.flow_duration) || 0,
        total_fwd_packets: parseInt(formData.total_fwd_packets) || 0,
        total_backward_packets: parseInt(formData.total_backward_packets) || 0,
        // Set defaults for missing features (0 or null)
        // In a real implementation, you'd have all 70 features in the form
      };

      const response = await api.post('/predictions/predict-flow', payload);
      setResult(response.data);
    } catch (err) {
      setError(err.response?.data?.detail || err.message || 'An error occurred');
    } finally {
      setLoading(false);
    }
  };

  const getSeverityColor = (severity) => {
    switch (severity) {
      case 'high': return 'bg-red-500';
      case 'medium': return 'bg-yellow-500';
      case 'low': return 'bg-orange-500';
      default: return 'bg-green-500';
    }
  };

  return (
    <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <h1 className="text-3xl font-bold text-white mb-8">Single Flow Analyzer</h1>

      <div className="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
        <p className="text-gray-400 text-sm mb-4">
          Enter flow information to analyze. The system will predict whether the flow is benign or an attack,
          and if it's an attack, classify the attack type.
        </p>
      </div>

      <form onSubmit={handleSubmit} className="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-6">
        <h2 className="text-xl font-semibold text-white mb-4">Flow Information</h2>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Source IP</label>
            <input
              type="text"
              name="src_ip"
              value={formData.src_ip}
              onChange={handleChange}
              required
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="192.168.1.100"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Destination IP</label>
            <input
              type="text"
              name="dst_ip"
              value={formData.dst_ip}
              onChange={handleChange}
              required
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="192.168.1.1"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Source Port</label>
            <input
              type="number"
              name="src_port"
              value={formData.src_port}
              onChange={handleChange}
              required
              min="0"
              max="65535"
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="12345"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Destination Port</label>
            <input
              type="number"
              name="dst_port"
              value={formData.dst_port}
              onChange={handleChange}
              required
              min="0"
              max="65535"
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="80"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Protocol</label>
            <select
              name="protocol"
              value={formData.protocol}
              onChange={handleChange}
              required
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              <option value="TCP">TCP</option>
              <option value="UDP">UDP</option>
              <option value="ICMP">ICMP</option>
            </select>
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Flow Duration (microseconds)</label>
            <input
              type="number"
              name="flow_duration"
              value={formData.flow_duration}
              onChange={handleChange}
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="1000000"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Total Forward Packets</label>
            <input
              type="number"
              name="total_fwd_packets"
              value={formData.total_fwd_packets}
              onChange={handleChange}
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="10"
            />
          </div>
          <div>
            <label className="block text-sm font-medium text-gray-300 mb-2">Total Backward Packets</label>
            <input
              type="number"
              name="total_backward_packets"
              value={formData.total_backward_packets}
              onChange={handleChange}
              className="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="10"
            />
          </div>
        </div>

        <div className="bg-gray-700/50 rounded p-4 mb-4">
          <p className="text-gray-400 text-sm">
            <strong>Note:</strong> This is a simplified form. In production, all 70 features from the training dataset
            would be included. Missing features will default to 0.
          </p>
        </div>

        <button
          type="submit"
          disabled={loading}
          className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md disabled:opacity-50 disabled:cursor-not-allowed"
        >
          {loading ? 'Analyzing...' : 'Analyze Flow'}
        </button>
      </form>

      {error && (
        <div className="bg-red-900/50 border border-red-500 rounded-lg p-4 mb-6">
          <p className="text-red-300">{error}</p>
        </div>
      )}

      {result && (
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h2 className="text-xl font-semibold text-white mb-4">Analysis Result</h2>
          <div className="space-y-4">
            <div className="flex items-center space-x-4">
              <span className="text-gray-400">Classification:</span>
              <span className={`text-2xl font-bold ${result.is_attack ? 'text-red-400' : 'text-green-400'}`}>
                {result.attack_type}
              </span>
            </div>
            <div className="flex items-center space-x-4">
              <span className="text-gray-400">Confidence:</span>
              <span className="text-xl font-semibold text-white">{(result.binary_confidence * 100).toFixed(2)}%</span>
            </div>
            <div className="flex items-center space-x-4">
              <span className="text-gray-400">Severity:</span>
              <span className={`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${getSeverityColor(result.severity)}`}>
                {result.severity}
              </span>
            </div>
            {Object.keys(result.class_probabilities).length > 0 && (
              <div>
                <h3 className="text-gray-300 font-semibold mb-2">Class Probabilities:</h3>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                  {Object.entries(result.class_probabilities).map(([cls, prob]) => (
                    <div key={cls} className="bg-gray-700/50 rounded p-2">
                      <div className="text-gray-400 text-xs">{cls}</div>
                      <div className="text-white font-semibold">{(prob * 100).toFixed(1)}%</div>
                    </div>
                  ))}
                </div>
              </div>
            )}
            {result.is_attack && (
              <div className="bg-yellow-900/30 border border-yellow-500 rounded p-4 mt-4">
                <p className="text-yellow-300 text-sm">
                  <strong>Recommendation:</strong> This flow has been classified as an attack. 
                  Consider blocking the source IP and investigating further.
                </p>
              </div>
            )}
          </div>
        </div>
      )}
    </div>
  );
}

export default FlowAnalyzer;
</file>

<file path="frontend/src/pages/LiveMonitoring.jsx">
import { useState, useEffect, useRef, useCallback } from 'react';
import api from '../api/client';
import { useWebSocket } from '../contexts/WebSocketContext';

function LiveMonitoring() {
  const [flows, setFlows] = useState([]);
  const [isMonitoring, setIsMonitoring] = useState(false);
  const [filter, setFilter] = useState('all'); // 'all', 'attacks', or specific attack type
  const [stats, setStats] = useState({ total: 0, attacks: 0 });
  const [interfaceInfo, setInterfaceInfo] = useState(null);
  const [snifferStats, setSnifferStats] = useState(null);
  const [selectedInterface, setSelectedInterface] = useState('');
  const { isConnected, subscribe, connect, disconnect } = useWebSocket();

  // Subscribe to WebSocket messages
  useEffect(() => {
    const unsubscribe = subscribe((data) => {
      console.log('WebSocket message received in LiveMonitoring:', data);
      
      // Ensure confidence field exists
      const flowData = {
        ...data,
        confidence: data.confidence || data.binary_confidence || 0,
      };
      
      setFlows(prev => {
        const newFlows = [flowData, ...prev].slice(0, 200); // Keep last 200
        return newFlows;
      });
      
      // Update stats
      setStats(prev => ({
        total: prev.total + 1,
        attacks: prev.attacks + (data.is_attack ? 1 : 0),
      }));
    });

    return unsubscribe;
  }, [subscribe]);

  useEffect(() => {
    // Check sniffer status on mount
    checkSnifferStatus();
    // Also refresh stats on mount to show existing data
    refreshStats();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  const checkSnifferStatus = useCallback(async () => {
    try {
      const response = await api.get('/health');
      const running = response.data.sniffer_running || false;
      setIsMonitoring(running);
      setInterfaceInfo({
        interface: response.data.interface,
        available: response.data.available_interfaces || [],
        exists: response.data.interface_exists,
        active_flows: response.data.active_flows || 0,
      });
      setSnifferStats(response.data.sniffer_stats || {});
      if (!selectedInterface && response.data.interface) {
        setSelectedInterface(response.data.interface);
      }
      return running;
    } catch (error) {
      console.error('Error checking sniffer status:', error);
      return false;
    }
  }, []);

  // Periodically check sniffer status (only when monitoring should be active)
  useEffect(() => {
    if (isMonitoring) {
      const interval = setInterval(() => {
        checkSnifferStatus().then(status => {
          // If monitoring was supposed to be on but sniffer stopped, update state
          if (isMonitoring && !status) {
            setIsMonitoring(false);
          }
        });
      }, 3000);
      return () => clearInterval(interval);
    }
  }, [isMonitoring, checkSnifferStatus]);

  // WebSocket is managed globally, no need for local connect/disconnect

  const startMonitoring = async () => {
    try {
      // Refresh stats before starting
      await refreshStats();
      // Start the sniffer
      const response = await api.post('/health/sniffer/start');
      
      // Wait a moment and check actual status
      await new Promise(resolve => setTimeout(resolve, 1000));
      const actualStatus = await checkSnifferStatus();
      
      // Check the response status
      if (response.data.status === 'started' && actualStatus) {
        setIsMonitoring(true);
        // Ensure WebSocket is connected (it's managed globally)
        if (!isConnected) {
          connect();
        }
        // Refresh stats after starting to load existing history
        await refreshStats();
      } else if (response.data.status === 'warning' || response.data.status === 'failed' || !actualStatus) {
        // Sniffer didn't actually start
        setIsMonitoring(false);
        const message = response.data.message || 'Sniffer failed to start. This may be due to:\n- Interface not found\n- Permission issues (need root/admin)\n- Interface not accessible';
        alert(`Warning: ${message}\n\nYou can still use manual flow analysis, but live monitoring may not work.`);
      } else {
        // Already running or started
        setIsMonitoring(actualStatus);
        if (actualStatus && !isConnected) {
          connect();
        }
      }
    } catch (error) {
      console.error('Error starting monitoring:', error);
      setIsMonitoring(false);
      alert(`Failed to start monitoring: ${error.response?.data?.detail || error.message}`);
    }
  };

  const stopMonitoring = async () => {
    try {
      // Stop the sniffer
      await api.post('/health/sniffer/stop');
      setIsMonitoring(false);
      // Don't disconnect WebSocket - keep it connected for other tabs
      // Don't clear flows and stats - keep them visible
    } catch (error) {
      console.error('Error stopping monitoring:', error);
      alert(`Failed to stop monitoring: ${error.response?.data?.detail || error.message}`);
    }
  };

  const changeInterface = async (newInterface) => {
    if (!newInterface || newInterface === selectedInterface) {
      return;
    }

    const wasMonitoring = isMonitoring;
    
    try {
      // Stop monitoring if running
      if (wasMonitoring) {
        await stopMonitoring();
        await new Promise(resolve => setTimeout(resolve, 500)); // Wait a bit
      }

      // Change interface
      const response = await api.post(`/health/sniffer/interface?interface=${encodeURIComponent(newInterface)}`);

      setSelectedInterface(newInterface);
      
      // Restart monitoring if it was running
      if (wasMonitoring) {
        await new Promise(resolve => setTimeout(resolve, 500));
        await startMonitoring();
      }

      alert(`Interface changed to ${newInterface}`);
    } catch (error) {
      console.error('Error changing interface:', error);
      alert(`Failed to change interface: ${error.response?.data?.detail || error.message}`);
    }
  };

  const refreshStats = useCallback(async () => {
    try {
      // Fetch recent history to update stats
      const historyRes = await api.get('/predictions/history?limit=1000');
      const history = historyRes.data;
      
      const totalFlows = history.length;
      const attacks = history.filter(h => h.is_attack);
      const totalAttacks = attacks.length;
      
      setStats({
        total: totalFlows,
        attacks: totalAttacks,
      });
      
      // Also update flows from history - convert history format to flow format
      const flowsFromHistory = history.map(h => ({
        timestamp: h.created_at || h.timestamp,
        src_ip: h.src_ip,
        dst_ip: h.dst_ip,
        src_port: h.src_port,
        dst_port: h.dst_port,
        protocol: h.protocol,
        is_attack: h.is_attack,
        attack_type: h.attack_type,
        severity: h.severity,
        confidence: h.binary_confidence || h.confidence || 0,
      }));
      
      setFlows(flowsFromHistory.sort((a, b) => new Date(b.timestamp || b.created_at) - new Date(a.timestamp || a.created_at)).slice(0, 200));
    } catch (error) {
      console.error('Error refreshing stats:', error);
    }
  }, []);

  const getSeverityColor = (severity) => {
    switch (severity) {
      case 'high': return 'bg-red-500';
      case 'medium': return 'bg-yellow-500';
      case 'low': return 'bg-orange-500';
      default: return 'bg-green-500';
    }
  };

  const filteredFlows = flows.filter(flow => {
    if (filter === 'all') return true;
    if (filter === 'attacks') return flow.is_attack;
    return flow.attack_type === filter;
  });

  const uniqueAttackTypes = [...new Set(flows.filter(f => f.is_attack).map(f => f.attack_type))];

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div className="flex justify-between items-center mb-8">
        <h1 className="text-3xl font-bold text-white">Live Monitoring</h1>
        <div className="flex items-center space-x-4">
          <div className={`px-4 py-2 rounded-lg ${isMonitoring ? 'bg-green-500' : 'bg-red-500'}`}>
            <span className="text-white font-semibold">
              {isMonitoring ? 'Sniffer: ON' : 'Sniffer: OFF'}
            </span>
          </div>
          <div className={`px-4 py-2 rounded-lg ${isConnected ? 'bg-blue-500' : 'bg-gray-500'}`}>
            <span className="text-white font-semibold">
              {isConnected ? 'WebSocket: Connected' : 'WebSocket: Disconnected'}
            </span>
          </div>
          {!isMonitoring ? (
            <button
              onClick={startMonitoring}
              className="px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-colors"
            >
              Start Monitoring
            </button>
          ) : (
            <button
              onClick={stopMonitoring}
              className="px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition-colors"
            >
              Stop Monitoring
            </button>
          )}
        </div>
      </div>

      {/* Interface Info & Sniffer Stats */}
      {interfaceInfo && (
        <div className={`mb-6 p-4 rounded-lg border ${
          interfaceInfo.exists === false 
            ? 'bg-yellow-900/30 border-yellow-500' 
            : 'bg-gray-800 border-gray-700'
        }`}>
          <div className="text-sm space-y-2">
            <div className="flex items-center gap-4">
              <div>
                <span className="text-gray-400">Interface: </span>
                <span className="text-white font-semibold">{interfaceInfo.interface}</span>
                {interfaceInfo.exists === false && (
                  <span className="ml-2 text-yellow-400">âš  Not found</span>
                )}
              </div>
              {interfaceInfo.available.length > 0 && (
                <div className="flex items-center gap-2">
                  <label className="text-gray-400">Change Interface:</label>
                  <select
                    value={selectedInterface || interfaceInfo.interface}
                    onChange={(e) => changeInterface(e.target.value)}
                    disabled={isMonitoring}
                    className="bg-gray-700 text-white px-3 py-1 rounded border border-gray-600 focus:outline-none focus:border-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
                  >
                    {interfaceInfo.available.map(iface => (
                      <option key={iface} value={iface}>
                        {iface} {iface === interfaceInfo.interface ? '(current)' : ''}
                      </option>
                    ))}
                  </select>
                  {isMonitoring && (
                    <span className="text-yellow-400 text-xs">(Stop monitoring to change)</span>
                  )}
                </div>
              )}
            </div>
            {snifferStats && isMonitoring && (
              <div className="mt-3 pt-3 border-t border-gray-700">
                <div className="text-gray-400 text-xs mb-1">Sniffer Statistics:</div>
                <div className="grid grid-cols-3 gap-4 text-sm">
                  <div>
                    <span className="text-gray-400">Packets Captured: </span>
                    <span className="text-white font-semibold">{snifferStats.packet_count || 0}</span>
                  </div>
                  <div>
                    <span className="text-gray-400">Packets Processed: </span>
                    <span className="text-white font-semibold">{snifferStats.processed_count || 0}</span>
                  </div>
                  <div>
                    <span className="text-gray-400">Active Flows: </span>
                    <span className="text-white font-semibold">{interfaceInfo.active_flows || 0}</span>
                  </div>
                </div>
                {snifferStats.last_error && (
                  <div className="mt-2 text-red-400 text-xs">
                    âš  Error: {snifferStats.last_error}
                  </div>
                )}
                {snifferStats.packet_count === 0 && isMonitoring && (
                  <div className="mt-2 text-yellow-400 text-xs">
                    âš  No packets captured yet. Check:
                    <ul className="list-disc list-inside ml-2 mt-1">
                      <li>Interface exists and is accessible</li>
                      <li>Backend has network permissions (may need sudo)</li>
                      <li>VM traffic is visible on this interface</li>
                    </ul>
                  </div>
                )}
              </div>
            )}
          </div>
        </div>
      )}

      {/* Stats */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-gray-400 text-sm font-medium mb-2">Total Flows</h3>
          <p className="text-3xl font-bold text-white">{stats.total}</p>
        </div>
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-gray-400 text-sm font-medium mb-2">Attacks Detected</h3>
          <p className="text-3xl font-bold text-red-400">{stats.attacks}</p>
        </div>
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
          <h3 className="text-gray-400 text-sm font-medium mb-2">Active Flows</h3>
          <p className="text-3xl font-bold text-blue-400">{flows.length}</p>
        </div>
      </div>

      {/* Filters */}
      <div className="bg-gray-800 rounded-lg p-4 border border-gray-700 mb-6">
        <div className="flex flex-wrap gap-2">
          <button
            onClick={() => setFilter('all')}
            className={`px-4 py-2 rounded ${filter === 'all' ? 'bg-blue-500 text-white' : 'bg-gray-700 text-gray-300'}`}
          >
            All
          </button>
          <button
            onClick={() => setFilter('attacks')}
            className={`px-4 py-2 rounded ${filter === 'attacks' ? 'bg-blue-500 text-white' : 'bg-gray-700 text-gray-300'}`}
          >
            Attacks Only
          </button>
          {uniqueAttackTypes.map(type => (
            <button
              key={type}
              onClick={() => setFilter(type)}
              className={`px-4 py-2 rounded ${filter === type ? 'bg-blue-500 text-white' : 'bg-gray-700 text-gray-300'}`}
            >
              {type}
            </button>
          ))}
        </div>
      </div>

      {/* Flows Table */}
      <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h3 className="text-white text-lg font-semibold mb-4">Live Flows</h3>
        <div className="overflow-x-auto max-h-96 overflow-y-auto">
          <table className="min-w-full divide-y divide-gray-700">
            <thead className="sticky top-0 bg-gray-800">
              <tr>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Time</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Source</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Destination</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Protocol</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Type</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Severity</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Confidence</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-700">
              {filteredFlows.length === 0 ? (
                <tr>
                  <td colSpan="7" className="px-6 py-4 text-center text-gray-400">
                    {!isMonitoring 
                      ? 'Monitoring is stopped. Click "Start Monitoring" to begin.' 
                      : isConnected 
                        ? 'No flows yet. Waiting for network traffic...' 
                        : 'WebSocket disconnected. Reconnecting...'}
                  </td>
                </tr>
              ) : (
                filteredFlows.map((flow, index) => (
                  <tr key={index} className={flow.is_attack ? 'bg-red-900/20' : ''}>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                      {new Date(flow.timestamp).toLocaleTimeString()}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                      {flow.src_ip}:{flow.src_port}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                      {flow.dst_ip}:{flow.dst_port}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                      {flow.protocol}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm">
                      <span className={flow.is_attack ? 'text-red-400 font-semibold' : 'text-green-400'}>
                        {flow.attack_type}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm">
                      <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getSeverityColor(flow.severity)}`}>
                        {flow.severity}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                      {((flow.confidence || flow.binary_confidence || 0) * 100).toFixed(1)}%
                    </td>
                  </tr>
                ))
              )}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}

export default LiveMonitoring;
</file>

<file path="frontend/src/pages/ModelInsights.jsx">
import { useState, useEffect } from 'react';
import api from '../api/client';

function ModelInsights() {
  const [metrics, setMetrics] = useState(null);
  const [modelInfo, setModelInfo] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchData();
  }, []);

  const fetchData = async () => {
    try {
      const [metricsRes, infoRes] = await Promise.all([
        api.get('/models/metrics'),
        api.get('/models/info'),
      ]);
      setMetrics(metricsRes.data);
      setModelInfo(infoRes.data);
      setLoading(false);
    } catch (error) {
      console.error('Error fetching model data:', error);
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <div className="text-white text-xl">Loading model insights...</div>
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <h1 className="text-3xl font-bold text-white mb-8">Model Insights</h1>

      {/* Model Info */}
      {modelInfo && (
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-8">
          <h2 className="text-xl font-semibold text-white mb-4">Model Information</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <h3 className="text-gray-400 text-sm mb-2">Binary Model</h3>
              <p className="text-white">{modelInfo.binary_model?.type || 'N/A'}</p>
            </div>
            <div>
              <h3 className="text-gray-400 text-sm mb-2">Multiclass Model</h3>
              <p className="text-white">{modelInfo.multiclass_model?.type || 'N/A'}</p>
            </div>
            <div>
              <h3 className="text-gray-400 text-sm mb-2">Feature Count</h3>
              <p className="text-white">{modelInfo.feature_count || 'N/A'}</p>
            </div>
            <div>
              <h3 className="text-gray-400 text-sm mb-2">PCA Components</h3>
              <p className="text-white">{modelInfo.preprocessing?.pca?.n_components || 'N/A'}</p>
            </div>
          </div>
        </div>
      )}

      {/* Binary Model Metrics */}
      {metrics?.binary && (
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-8">
          <h2 className="text-xl font-semibold text-white mb-4">Binary Classification Metrics</h2>
          <div className="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
            <div>
              <h3 className="text-gray-400 text-sm mb-2">Accuracy</h3>
              <p className="text-2xl font-bold text-green-400">{(metrics.binary.accuracy * 100).toFixed(1)}%</p>
            </div>
            <div>
              <h3 className="text-gray-400 text-sm mb-2">Precision</h3>
              <p className="text-2xl font-bold text-blue-400">{(metrics.binary.precision * 100).toFixed(1)}%</p>
            </div>
            <div>
              <h3 className="text-gray-400 text-sm mb-2">Recall</h3>
              <p className="text-2xl font-bold text-yellow-400">{(metrics.binary.recall * 100).toFixed(1)}%</p>
            </div>
            <div>
              <h3 className="text-gray-400 text-sm mb-2">F1 Score</h3>
              <p className="text-2xl font-bold text-purple-400">{(metrics.binary.f1_score * 100).toFixed(1)}%</p>
            </div>
            <div>
              <h3 className="text-gray-400 text-sm mb-2">ROC AUC</h3>
              <p className="text-2xl font-bold text-pink-400">{(metrics.binary.roc_auc * 100).toFixed(1)}%</p>
            </div>
          </div>

          <div className="mt-6">
            <h3 className="text-gray-300 text-sm mb-3">Confusion Matrix</h3>
            <div className="grid grid-cols-3 gap-2 max-w-md">
              <div></div>
              <div className="text-center text-gray-400 text-sm">Predicted: Benign</div>
              <div className="text-center text-gray-400 text-sm">Predicted: Attack</div>
              <div className="text-gray-400 text-sm">Actual: Benign</div>
              <div className="bg-green-900/50 p-3 rounded text-center text-white font-semibold">
                {metrics.binary.confusion_matrix.true_negative}
              </div>
              <div className="bg-red-900/50 p-3 rounded text-center text-white font-semibold">
                {metrics.binary.confusion_matrix.false_positive}
              </div>
              <div className="text-gray-400 text-sm">Actual: Attack</div>
              <div className="bg-red-900/50 p-3 rounded text-center text-white font-semibold">
                {metrics.binary.confusion_matrix.false_negative}
              </div>
              <div className="bg-green-900/50 p-3 rounded text-center text-white font-semibold">
                {metrics.binary.confusion_matrix.true_positive}
              </div>
            </div>
          </div>

          <div className="mt-6 text-sm text-gray-400">
            <p><strong>Accuracy:</strong> Overall correctness of predictions</p>
            <p><strong>Precision:</strong> Of predicted attacks, how many were actually attacks</p>
            <p><strong>Recall:</strong> Of all actual attacks, how many were detected</p>
            <p><strong>F1 Score:</strong> Harmonic mean of precision and recall</p>
            <p><strong>ROC AUC:</strong> Ability to distinguish between classes</p>
          </div>
        </div>
      )}

      {/* Multiclass Model Metrics */}
      {metrics?.multiclass && (
        <div className="bg-gray-800 rounded-lg p-6 border border-gray-700 mb-8">
          <h2 className="text-xl font-semibold text-white mb-4">Multiclass Classification Metrics</h2>
          <div className="mb-6">
            <h3 className="text-gray-300 text-lg mb-3">Overall Accuracy: {(metrics.multiclass.accuracy * 100).toFixed(1)}%</h3>
          </div>

          <div className="mb-6">
            <h3 className="text-gray-300 text-sm mb-3">Per-Class Metrics</h3>
            <div className="overflow-x-auto">
              <table className="min-w-full divide-y divide-gray-700">
                <thead>
                  <tr>
                    <th className="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Class</th>
                    <th className="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Precision</th>
                    <th className="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">Recall</th>
                    <th className="px-4 py-3 text-left text-xs font-medium text-gray-400 uppercase">F1 Score</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-700">
                  {Object.entries(metrics.multiclass.per_class || {}).map(([class_name, class_metrics]) => (
                    <tr key={class_name}>
                      <td className="px-4 py-3 text-sm text-white">{class_name}</td>
                      <td className="px-4 py-3 text-sm text-blue-400">{(class_metrics.precision * 100).toFixed(1)}%</td>
                      <td className="px-4 py-3 text-sm text-yellow-400">{(class_metrics.recall * 100).toFixed(1)}%</td>
                      <td className="px-4 py-3 text-sm text-purple-400">{(class_metrics.f1_score * 100).toFixed(1)}%</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>

          <div className="mt-6">
            <h3 className="text-gray-300 text-sm mb-3">Confusion Matrix</h3>
            <div className="overflow-x-auto">
              <table className="min-w-full">
                <thead>
                  <tr>
                    <th className="px-2 py-2 text-xs text-gray-400"></th>
                    {metrics.multiclass.confusion_matrix.classes.map(cls => (
                      <th key={cls} className="px-2 py-2 text-xs text-gray-400 text-center">{cls}</th>
                    ))}
                  </tr>
                </thead>
                <tbody>
                  {metrics.multiclass.confusion_matrix.matrix.map((row, i) => (
                    <tr key={i}>
                      <td className="px-2 py-2 text-xs text-gray-400">{metrics.multiclass.confusion_matrix.classes[i]}</td>
                      {row.map((cell, j) => (
                        <td
                          key={j}
                          className={`px-2 py-2 text-xs text-center ${
                            i === j
                              ? 'bg-green-900/50 text-green-300'
                              : cell > 0
                              ? 'bg-red-900/50 text-red-300'
                              : 'bg-gray-900/50 text-gray-500'
                          }`}
                        >
                          {cell}
                        </td>
                      ))}
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

export default ModelInsights;
</file>

<file path="frontend/src/App.css">
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}
</file>

<file path="frontend/src/App.jsx">
import { BrowserRouter as Router, Routes, Route, Link, useLocation } from 'react-router-dom';
import Dashboard from './pages/Dashboard';
import LiveMonitoring from './pages/LiveMonitoring';
import ModelInsights from './pages/ModelInsights';
import FlowAnalyzer from './pages/FlowAnalyzer';

function NavLink({ to, children }) {
  const location = useLocation();
  const isActive = location.pathname === to;
  
  return (
    <Link
      to={to}
      className={`${
        isActive
          ? 'border-blue-500 text-white'
          : 'border-transparent text-gray-300 hover:border-gray-300 hover:text-white'
      } inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium`}
    >
      {children}
    </Link>
  );
}

function App() {
  return (
    <Router>
      <div className="min-h-screen bg-ids-dark">
        <nav className="bg-ids-darker border-b border-gray-800">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div className="flex justify-between h-16">
              <div className="flex">
                <div className="flex-shrink-0 flex items-center">
                  <h1 className="text-xl font-bold text-white">IDS System</h1>
                </div>
                <div className="hidden sm:ml-6 sm:flex sm:space-x-8">
                  <NavLink to="/">Dashboard</NavLink>
                  <NavLink to="/live">Live Monitoring</NavLink>
                  <NavLink to="/insights">Model Insights</NavLink>
                  <NavLink to="/analyzer">Flow Analyzer</NavLink>
                </div>
              </div>
            </div>
          </div>
        </nav>

        <main>
          <Routes>
            <Route path="/" element={<Dashboard />} />
            <Route path="/live" element={<LiveMonitoring />} />
            <Route path="/insights" element={<ModelInsights />} />
            <Route path="/analyzer" element={<FlowAnalyzer />} />
          </Routes>
        </main>
      </div>
    </Router>
  );
}

export default App;
</file>

<file path="frontend/src/config.js">
/** API configuration */
export const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8000';
export const WS_BASE_URL = import.meta.env.VITE_WS_BASE_URL || 'ws://localhost:8000';
</file>

<file path="frontend/src/index.css">
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #0f172a;
  color: #e2e8f0;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}
</file>

<file path="frontend/src/main.jsx">
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.jsx'
import { WebSocketProvider } from './contexts/WebSocketContext'

createRoot(document.getElementById('root')).render(
  <StrictMode>
    <WebSocketProvider>
      <App />
    </WebSocketProvider>
  </StrictMode>,
)
</file>

<file path="frontend/.gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
</file>

<file path="frontend/eslint.config.js">
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{js,jsx}'],
    extends: [
      js.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
      parserOptions: {
        ecmaVersion: 'latest',
        ecmaFeatures: { jsx: true },
        sourceType: 'module',
      },
    },
    rules: {
      'no-unused-vars': ['error', { varsIgnorePattern: '^[A-Z_]' }],
    },
  },
])
</file>

<file path="frontend/index.html">
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>frontend</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
</file>

<file path="frontend/package.json">
{
  "name": "frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "axios": "^1.13.2",
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "react-router-dom": "^7.10.1",
    "recharts": "^3.5.1"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/react": "^19.2.5",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^4.3.1",
    "autoprefixer": "^10.4.17",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "postcss": "^8.4.35",
    "tailwindcss": "^3.4.1",
    "vite": "^5.4.0"
  }
}
</file>

<file path="frontend/postcss.config.js">
export default {
  plugins: {
    'tailwindcss': {},
    'autoprefixer': {},
  },
}
</file>

<file path="frontend/README.md">
# React + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) (or [oxc](https://oxc.rs) when used in [rolldown-vite](https://vite.dev/guide/rolldown)) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## React Compiler

The React Compiler is not enabled on this template because of its impact on dev & build performances. To add it, see [this documentation](https://react.dev/learn/react-compiler/installation).

## Expanding the ESLint configuration

If you are developing a production application, we recommend using TypeScript with type-aware lint rules enabled. Check out the [TS template](https://github.com/vitejs/vite/tree/main/packages/create-vite/template-react-ts) for information on how to integrate TypeScript and [`typescript-eslint`](https://typescript-eslint.io) in your project.
</file>

<file path="frontend/tailwind.config.js">
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        'ids-dark': '#0f172a',
        'ids-darker': '#020617',
        'ids-accent': '#3b82f6',
      },
    },
  },
  plugins: [],
}
</file>

<file path="frontend/vite.config.js">
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
})
</file>

<file path="scripts/test_models.py">
#!/usr/bin/env python3
"""Test script to verify models can be loaded and make a sample prediction."""
import sys
import os

# Add backend to path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..', 'backend'))

from app.ml.predictor import predictor
from app.ml.preprocessing import FEATURE_COLUMNS

def test_model_loading():
    """Test that models can be loaded."""
    print("Testing model loading...")
    try:
        predictor.load_models()
        print("âœ“ Models loaded successfully")
        return True
    except Exception as e:
        print(f"âœ— Error loading models: {e}")
        return False

def test_prediction():
    """Test making a sample prediction."""
    print("\nTesting prediction...")
    
    # Create a sample flow dictionary with all required features
    sample_flow = {}
    for col in FEATURE_COLUMNS:
        # Set some default values
        if 'Port' in col:
            sample_flow[col] = 80
        elif 'Duration' in col:
            sample_flow[col] = 1000000
        elif 'Packets' in col or 'Bytes' in col or 'Length' in col:
            sample_flow[col] = 10
        elif 'Mean' in col or 'Std' in col or 'Variance' in col:
            sample_flow[col] = 0.0
        elif 'Flags' in col or 'Count' in col:
            sample_flow[col] = 0
        elif 'Ratio' in col or 'Size' in col:
            sample_flow[col] = 1.0
        elif 's' in col and '/' in col:  # Rate features like "Flow Bytes/s"
            sample_flow[col] = 1000.0
        elif 'IAT' in col:
            sample_flow[col] = 1000.0 if 'Mean' in col or 'Std' in col else 1000
        elif 'Header' in col:
            sample_flow[col] = 20
        elif 'Win' in col or 'seg' in col.lower():
            sample_flow[col] = 65535 if 'Win' in col else 1500
        elif 'Active' in col or 'Idle' in col:
            sample_flow[col] = 1000.0 if 'Mean' in col or 'Std' in col else 1000
        else:
            sample_flow[col] = 0
    
    try:
        result = predictor.predict(sample_flow)
        print(f"âœ“ Prediction successful")
        print(f"  - Is Attack: {result.is_attack}")
        print(f"  - Attack Type: {result.attack_type}")
        print(f"  - Confidence: {result.binary_confidence:.2%}")
        print(f"  - Class Probabilities: {result.class_probabilities}")
        return True
    except Exception as e:
        print(f"âœ— Error making prediction: {e}")
        import traceback
        traceback.print_exc()
        return False

if __name__ == "__main__":
    print("=" * 50)
    print("IDS Model Test Script")
    print("=" * 50)
    
    if not test_model_loading():
        sys.exit(1)
    
    if not test_prediction():
        sys.exit(1)
    
    print("\n" + "=" * 50)
    print("All tests passed!")
    print("=" * 50)
</file>

<file path="ATTACK_GUIDE.md">
# Complete Attack Guide: Attacker VM â†’ Victim VM

This guide provides step-by-step instructions for generating various network attacks from your attacker VM to your victim VM for testing the IDS system.

## Prerequisites

- âœ… Attacker VM: `192.168.64.4`
- âœ… Victim VM: `192.168.64.3`
- âœ… Both VMs are running: `multipass list`
- âœ… IDS backend is running and monitoring
- âœ… Frontend is open at http://localhost:5173

## Quick Start

1. **Open attacker VM:**
   ```bash
   multipass shell attacker
   ```

2. **Verify connectivity:**
   ```bash
   ping -c 3 192.168.64.3
   ```

3. **Start monitoring in IDS frontend:**
   - Go to "Live Monitoring" page
   - Click "Start Monitoring"
   - Select correct interface (bridge0 or bridge100)

4. **Run attacks from attacker VM**
5. **Watch flows appear in real-time in the IDS dashboard**

---

## Attack Types

### 1. Port Scanning Attacks

Port scanning is the most common reconnaissance technique. The IDS should detect these as "Port Scan" attacks.

#### A. Stealth SYN Scan (Most Common)
```bash
multipass shell attacker

# Quick scan of common ports
nmap -sS -p 1-1000 192.168.64.3

# Full port scan (takes longer, generates more traffic)
nmap -sS -p- 192.168.64.3

# Scan specific port ranges
nmap -sS -p 20-100 192.168.64.3
```

**What to expect:**
- Multiple TCP SYN packets to different ports
- IDS should classify as "Port Scan"
- High confidence score (>0.7)
- Multiple flows in the dashboard

#### B. Aggressive Scan with OS Detection
```bash
multipass shell attacker

# Aggressive scan with OS detection and service version
nmap -A 192.168.64.3

# This generates more traffic and should be easily detected
```

#### C. UDP Port Scan
```bash
multipass shell attacker

# Scan UDP ports (slower, but different pattern)
nmap -sU -p 1-100 192.168.64.3
```

#### D. Fast Scan (Multiple Hosts)
```bash
multipass shell attacker

# Scan multiple ports quickly
nmap -sS -F 192.168.64.3

# Very fast scan (top 100 ports)
nmap -sS --top-ports 100 192.168.64.3
```

**Detection Tips:**
- Port scans generate many flows quickly
- Look for flows with same source IP but different destination ports
- Attack type should be "Port Scan" or "Scan"

---

### 2. Denial of Service (DoS) Attacks

DoS attacks flood the victim with traffic to overwhelm resources.

#### A. SYN Flood Attack
```bash
multipass shell attacker

# SYN flood on port 80 (HTTP)
sudo hping3 --flood --syn -p 80 192.168.64.3

# SYN flood on port 22 (SSH)
sudo hping3 --flood --syn -p 22 192.168.64.3

# Stop with Ctrl+C after 10-20 seconds
```

**What to expect:**
- Massive number of TCP SYN packets
- IDS should detect as "DoS" or "DDoS"
- High severity (red)
- Very high packet count in sniffer stats

#### B. UDP Flood Attack
```bash
multipass shell attacker

# UDP flood
sudo hping3 --flood --udp -p 80 192.168.64.3

# Stop with Ctrl+C
```

#### C. ICMP Flood (Ping Flood)
```bash
multipass shell attacker

# Ping flood
sudo hping3 --flood --icmp 192.168.64.3

# Or using ping
ping -f 192.168.64.3
# Note: May need sudo on some systems
```

**Detection Tips:**
- DoS attacks generate extremely high packet rates
- Look for flows with same destination IP/port
- Very high confidence scores
- Attack type: "DoS" or "DDoS"

---

### 3. Brute Force Attacks

Brute force attacks attempt to guess passwords by trying many combinations.

#### A. SSH Brute Force
```bash
multipass shell attacker

# Create a wordlist
cat > wordlist.txt << EOF
password123
admin
root
123456
password
test
ubuntu
admin123
root123
EOF

# SSH brute force attack
hydra -l testuser -P wordlist.txt ssh://192.168.64.3

# With more verbose output
hydra -l testuser -P wordlist.txt -v ssh://192.168.64.3

# Faster attack (more threads)
hydra -l testuser -P wordlist.txt -t 4 ssh://192.168.64.3
```

**What to expect:**
- Many SSH connection attempts
- Same source IP, same destination port (22)
- IDS should detect as "Brute Force"
- Medium to high confidence

#### B. HTTP Login Brute Force
```bash
multipass shell attacker

# If victim has a web server, try HTTP login
hydra -l admin -P wordlist.txt http-get://192.168.64.3/

# HTTP POST form
hydra -l admin -P wordlist.txt http-post-form://192.168.64.3/login:username=^USER^&password=^PASS^:Invalid
```

**Detection Tips:**
- Brute force shows repeated connection attempts
- Same source, same destination port
- Attack type: "Brute Force"
- Multiple failed connection attempts

---

### 4. Advanced Attacks

#### A. Fragmented Packets (Evasion Technique)
```bash
multipass shell attacker

# Send fragmented packets
sudo hping3 -f -p 80 192.168.64.3

# Fragmented SYN scan
nmap -sS -f 192.168.64.3
```

#### B. Slowloris Attack (Slow HTTP)
```bash
multipass shell attacker

# Install slowhttptest if available
# sudo apt install slowhttptest

# Slow HTTP attack
slowhttptest -c 1000 -H -g -o slowhttp -i 10 -r 200 -t GET -u http://192.168.64.3 -x 24 -p 3
```

#### C. Xmas Tree Scan
```bash
multipass shell attacker

# Xmas tree scan (sets FIN, PSH, URG flags)
nmap -sX -p 1-100 192.168.64.3
```

---

## Attack Sequences for Testing

### Sequence 1: Reconnaissance â†’ Attack
```bash
multipass shell attacker

# Step 1: Port scan (reconnaissance)
nmap -sS -p 1-1000 192.168.64.3

# Wait 30 seconds, then...

# Step 2: DoS attack
sudo hping3 --flood --syn -p 80 192.168.64.3
# Run for 15 seconds, then Ctrl+C

# Step 3: Brute force
hydra -l testuser -P wordlist.txt ssh://192.168.64.3
```

### Sequence 2: Multiple Attack Types
```bash
multipass shell attacker

# Terminal 1: Port scan
nmap -sS -p- 192.168.64.3

# Terminal 2 (new multipass shell): DoS
sudo hping3 --flood --syn -p 22 192.168.64.3
```

### Sequence 3: Continuous Attack
```bash
multipass shell attacker

# Run for 2 minutes, generating continuous traffic
for i in {1..10}; do
  nmap -sS -p $((i*100))-$((i*100+50)) 192.168.64.3
  sleep 5
done
```

---

## Monitoring in IDS

### What to Watch For

1. **Live Monitoring Page:**
   - Flows appearing in real-time
   - Attack types being classified
   - Severity levels (high/medium/low)
   - Confidence scores

2. **Sniffer Statistics:**
   - Packets Captured: Should increase rapidly
   - Packets Processed: Should match captured (or close)
   - Active Flows: Number of flows being tracked

3. **Dashboard:**
   - Total flows count
   - Attack ratio
   - Most frequent attack type
   - Charts updating

### Expected Detection Times

- **Port Scan**: 5-10 seconds after starting scan
- **DoS Attack**: Immediate (high packet rate)
- **Brute Force**: 10-15 seconds (after multiple attempts)

---

## Troubleshooting

### No Flows Appearing

1. **Check sniffer is running:**
   - Look for "Sniffer: ON" in UI
   - Check backend logs for errors

2. **Verify interface:**
   - Make sure correct interface is selected
   - bridge0 or bridge100 for VMs
   - Check "Sniffer Statistics" for packet counts

3. **Test connectivity:**
   ```bash
   # From attacker VM
   ping -c 5 192.168.64.3
   
   # Should see packets in sniffer stats
   ```

4. **Check permissions:**
   - Backend may need `sudo` for packet capture
   - Run: `sudo uvicorn app.main:app --reload`

### Flows Appear But No Attacks Detected

1. **Wait longer:** Flows need 5+ packets or 10+ seconds to process
2. **Generate more traffic:** Some attacks need more packets to be detected
3. **Check attack type:** Some may be classified as "BENIGN" if pattern doesn't match

### Wrong Attack Type Detected

- ML models may misclassify some attacks
- This is normal - the system is learning
- Check confidence scores (higher = more certain)

---

## Quick Reference Commands

```bash
# Enter attacker VM
multipass shell attacker

# Port Scan
nmap -sS -p 1-1000 192.168.64.3

# DoS Attack
sudo hping3 --flood --syn -p 80 192.168.64.3

# Brute Force
hydra -l testuser -P wordlist.txt ssh://192.168.64.3

# Ping Test
ping -c 10 192.168.64.3
```

---

## Best Practices

1. **Start with simple attacks** (ping, port scan) to verify system works
2. **Monitor in real-time** to see immediate results
3. **Run attacks for 10-30 seconds** to generate enough traffic
4. **Check backend logs** for detailed processing information
5. **Use different attack types** to test various detection capabilities

---

## Next Steps

1. âœ… Run a simple port scan to verify detection works
2. âœ… Try a DoS attack to see high-severity detection
3. âœ… Run brute force to test authentication attack detection
4. âœ… Check Dashboard for overall statistics
5. âœ… Review Model Insights to understand detection accuracy

Happy testing! ðŸš€
</file>

<file path="Makefile">
.PHONY: help install-backend install-frontend dev-backend dev-frontend dev setup

help:
	@echo "IDS System - Makefile Commands"
	@echo ""
	@echo "  make setup              - Set up both backend and frontend"
	@echo "  make install-backend    - Install backend dependencies"
	@echo "  make install-frontend  - Install frontend dependencies"
	@echo "  make dev-backend        - Start backend server"
	@echo "  make dev-frontend       - Start frontend dev server"
	@echo "  make dev                - Start both backend and frontend"

setup:
	@echo "Setting up IDS System..."
	@cd backend && python3 -m venv venv || true
	@cd backend && source venv/bin/activate && pip install -r requirements.txt
	@cd frontend && npm install
	@echo "Setup complete!"

install-backend:
	@cd backend && python3 -m venv venv || true
	@cd backend && source venv/bin/activate && pip install -r requirements.txt

install-frontend:
	@cd frontend && npm install

dev-backend:
	@cd backend && source venv/bin/activate && uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

dev-frontend:
	@cd frontend && npm run dev

dev:
	@echo "Starting both backend and frontend..."
	@echo "Backend: http://localhost:8000"
	@echo "Frontend: http://localhost:5173"
	@make -j2 dev-backend dev-frontend
</file>

<file path="IDS_Model_Training.ipynb">
{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "4f0712ec",
   "metadata": {},
   "source": [
    "## Model Training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "8cca8c5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import seaborn as sns\n",
    "sns.set(style='darkgrid')\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "1b617704",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PC1</th>\n",
       "      <th>PC2</th>\n",
       "      <th>PC3</th>\n",
       "      <th>PC4</th>\n",
       "      <th>PC5</th>\n",
       "      <th>PC6</th>\n",
       "      <th>PC7</th>\n",
       "      <th>PC8</th>\n",
       "      <th>PC9</th>\n",
       "      <th>PC10</th>\n",
       "      <th>...</th>\n",
       "      <th>PC27</th>\n",
       "      <th>PC28</th>\n",
       "      <th>PC29</th>\n",
       "      <th>PC30</th>\n",
       "      <th>PC31</th>\n",
       "      <th>PC32</th>\n",
       "      <th>PC33</th>\n",
       "      <th>PC34</th>\n",
       "      <th>PC35</th>\n",
       "      <th>Attack Type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-2.357605</td>\n",
       "      <td>-0.054980</td>\n",
       "      <td>0.577358</td>\n",
       "      <td>0.734455</td>\n",
       "      <td>3.730369</td>\n",
       "      <td>0.234640</td>\n",
       "      <td>-0.015693</td>\n",
       "      <td>-0.215545</td>\n",
       "      <td>-0.278475</td>\n",
       "      <td>1.087286</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.147894</td>\n",
       "      <td>-0.333394</td>\n",
       "      <td>1.488435</td>\n",
       "      <td>-0.161748</td>\n",
       "      <td>-0.219747</td>\n",
       "      <td>-0.004607</td>\n",
       "      <td>0.002601</td>\n",
       "      <td>0.033419</td>\n",
       "      <td>-0.014938</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-2.883854</td>\n",
       "      <td>-0.069937</td>\n",
       "      <td>0.911302</td>\n",
       "      <td>1.763146</td>\n",
       "      <td>8.846136</td>\n",
       "      <td>0.620416</td>\n",
       "      <td>-0.056856</td>\n",
       "      <td>1.106617</td>\n",
       "      <td>1.906468</td>\n",
       "      <td>-2.756465</td>\n",
       "      <td>...</td>\n",
       "      <td>0.281532</td>\n",
       "      <td>-2.345995</td>\n",
       "      <td>2.240347</td>\n",
       "      <td>-0.638463</td>\n",
       "      <td>-0.371135</td>\n",
       "      <td>0.010602</td>\n",
       "      <td>0.000644</td>\n",
       "      <td>0.126258</td>\n",
       "      <td>-0.189626</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>-2.416928</td>\n",
       "      <td>-0.056683</td>\n",
       "      <td>0.615325</td>\n",
       "      <td>0.850870</td>\n",
       "      <td>4.304212</td>\n",
       "      <td>0.275767</td>\n",
       "      <td>-0.020437</td>\n",
       "      <td>-0.070482</td>\n",
       "      <td>-0.035276</td>\n",
       "      <td>0.664176</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.101765</td>\n",
       "      <td>-0.544543</td>\n",
       "      <td>1.572782</td>\n",
       "      <td>-0.211976</td>\n",
       "      <td>-0.235381</td>\n",
       "      <td>-0.003066</td>\n",
       "      <td>0.002394</td>\n",
       "      <td>0.043401</td>\n",
       "      <td>-0.034325</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>-2.884704</td>\n",
       "      <td>-0.069978</td>\n",
       "      <td>0.912164</td>\n",
       "      <td>1.765263</td>\n",
       "      <td>8.851561</td>\n",
       "      <td>0.618679</td>\n",
       "      <td>-0.057025</td>\n",
       "      <td>1.104773</td>\n",
       "      <td>1.906895</td>\n",
       "      <td>-2.752492</td>\n",
       "      <td>...</td>\n",
       "      <td>0.279947</td>\n",
       "      <td>-2.333522</td>\n",
       "      <td>2.241149</td>\n",
       "      <td>-0.635723</td>\n",
       "      <td>-0.369948</td>\n",
       "      <td>0.010453</td>\n",
       "      <td>0.000654</td>\n",
       "      <td>0.125925</td>\n",
       "      <td>-0.189603</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>-1.505246</td>\n",
       "      <td>0.080886</td>\n",
       "      <td>-0.504397</td>\n",
       "      <td>0.290405</td>\n",
       "      <td>-0.539263</td>\n",
       "      <td>0.746109</td>\n",
       "      <td>0.100443</td>\n",
       "      <td>0.732424</td>\n",
       "      <td>-1.145808</td>\n",
       "      <td>-0.563201</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.598921</td>\n",
       "      <td>0.116433</td>\n",
       "      <td>0.794828</td>\n",
       "      <td>-0.208920</td>\n",
       "      <td>0.039939</td>\n",
       "      <td>-0.014041</td>\n",
       "      <td>0.000980</td>\n",
       "      <td>-0.049437</td>\n",
       "      <td>-0.001124</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522357</th>\n",
       "      <td>2.178257</td>\n",
       "      <td>0.488156</td>\n",
       "      <td>-4.526435</td>\n",
       "      <td>-0.924940</td>\n",
       "      <td>-0.730370</td>\n",
       "      <td>0.041666</td>\n",
       "      <td>0.126066</td>\n",
       "      <td>2.523847</td>\n",
       "      <td>-0.216704</td>\n",
       "      <td>-0.206062</td>\n",
       "      <td>...</td>\n",
       "      <td>0.321896</td>\n",
       "      <td>0.518604</td>\n",
       "      <td>-0.024131</td>\n",
       "      <td>-0.644609</td>\n",
       "      <td>-1.450193</td>\n",
       "      <td>0.084712</td>\n",
       "      <td>0.000039</td>\n",
       "      <td>-0.077264</td>\n",
       "      <td>0.303285</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522358</th>\n",
       "      <td>1.731368</td>\n",
       "      <td>0.460769</td>\n",
       "      <td>-4.054541</td>\n",
       "      <td>-0.770272</td>\n",
       "      <td>-0.777757</td>\n",
       "      <td>0.114564</td>\n",
       "      <td>0.125233</td>\n",
       "      <td>2.346295</td>\n",
       "      <td>-0.328230</td>\n",
       "      <td>-0.250994</td>\n",
       "      <td>...</td>\n",
       "      <td>0.335223</td>\n",
       "      <td>0.589274</td>\n",
       "      <td>-0.012050</td>\n",
       "      <td>-0.729908</td>\n",
       "      <td>-1.600768</td>\n",
       "      <td>0.107229</td>\n",
       "      <td>-0.000361</td>\n",
       "      <td>0.060156</td>\n",
       "      <td>0.186588</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522359</th>\n",
       "      <td>2.642674</td>\n",
       "      <td>0.619094</td>\n",
       "      <td>-5.035304</td>\n",
       "      <td>-1.098158</td>\n",
       "      <td>-0.725546</td>\n",
       "      <td>-0.086071</td>\n",
       "      <td>0.125362</td>\n",
       "      <td>2.752021</td>\n",
       "      <td>-0.022972</td>\n",
       "      <td>-0.202706</td>\n",
       "      <td>...</td>\n",
       "      <td>0.405668</td>\n",
       "      <td>0.714635</td>\n",
       "      <td>-0.058023</td>\n",
       "      <td>-0.932889</td>\n",
       "      <td>-2.075104</td>\n",
       "      <td>0.122933</td>\n",
       "      <td>-0.000099</td>\n",
       "      <td>0.085239</td>\n",
       "      <td>0.239972</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522360</th>\n",
       "      <td>1.725979</td>\n",
       "      <td>0.468282</td>\n",
       "      <td>-4.066628</td>\n",
       "      <td>-0.770341</td>\n",
       "      <td>-0.777157</td>\n",
       "      <td>0.107913</td>\n",
       "      <td>0.125125</td>\n",
       "      <td>2.356053</td>\n",
       "      <td>-0.317138</td>\n",
       "      <td>-0.254798</td>\n",
       "      <td>...</td>\n",
       "      <td>0.347547</td>\n",
       "      <td>0.611648</td>\n",
       "      <td>-0.012535</td>\n",
       "      <td>-0.758092</td>\n",
       "      <td>-1.661729</td>\n",
       "      <td>0.110680</td>\n",
       "      <td>-0.000353</td>\n",
       "      <td>0.072124</td>\n",
       "      <td>0.184674</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522361</th>\n",
       "      <td>1.718994</td>\n",
       "      <td>0.455801</td>\n",
       "      <td>-4.056730</td>\n",
       "      <td>-0.752914</td>\n",
       "      <td>-0.778815</td>\n",
       "      <td>0.105424</td>\n",
       "      <td>0.125243</td>\n",
       "      <td>2.351116</td>\n",
       "      <td>-0.325989</td>\n",
       "      <td>-0.250643</td>\n",
       "      <td>...</td>\n",
       "      <td>0.336674</td>\n",
       "      <td>0.590637</td>\n",
       "      <td>-0.012795</td>\n",
       "      <td>-0.730906</td>\n",
       "      <td>-1.606039</td>\n",
       "      <td>0.108408</td>\n",
       "      <td>-0.000360</td>\n",
       "      <td>0.067885</td>\n",
       "      <td>0.181076</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2522362 rows Ã— 36 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              PC1       PC2       PC3       PC4       PC5       PC6       PC7  \\\n",
       "0       -2.357605 -0.054980  0.577358  0.734455  3.730369  0.234640 -0.015693   \n",
       "1       -2.883854 -0.069937  0.911302  1.763146  8.846136  0.620416 -0.056856   \n",
       "2       -2.416928 -0.056683  0.615325  0.850870  4.304212  0.275767 -0.020437   \n",
       "3       -2.884704 -0.069978  0.912164  1.765263  8.851561  0.618679 -0.057025   \n",
       "4       -1.505246  0.080886 -0.504397  0.290405 -0.539263  0.746109  0.100443   \n",
       "...           ...       ...       ...       ...       ...       ...       ...   \n",
       "2522357  2.178257  0.488156 -4.526435 -0.924940 -0.730370  0.041666  0.126066   \n",
       "2522358  1.731368  0.460769 -4.054541 -0.770272 -0.777757  0.114564  0.125233   \n",
       "2522359  2.642674  0.619094 -5.035304 -1.098158 -0.725546 -0.086071  0.125362   \n",
       "2522360  1.725979  0.468282 -4.066628 -0.770341 -0.777157  0.107913  0.125125   \n",
       "2522361  1.718994  0.455801 -4.056730 -0.752914 -0.778815  0.105424  0.125243   \n",
       "\n",
       "              PC8       PC9      PC10  ...      PC27      PC28      PC29  \\\n",
       "0       -0.215545 -0.278475  1.087286  ... -0.147894 -0.333394  1.488435   \n",
       "1        1.106617  1.906468 -2.756465  ...  0.281532 -2.345995  2.240347   \n",
       "2       -0.070482 -0.035276  0.664176  ... -0.101765 -0.544543  1.572782   \n",
       "3        1.104773  1.906895 -2.752492  ...  0.279947 -2.333522  2.241149   \n",
       "4        0.732424 -1.145808 -0.563201  ... -0.598921  0.116433  0.794828   \n",
       "...           ...       ...       ...  ...       ...       ...       ...   \n",
       "2522357  2.523847 -0.216704 -0.206062  ...  0.321896  0.518604 -0.024131   \n",
       "2522358  2.346295 -0.328230 -0.250994  ...  0.335223  0.589274 -0.012050   \n",
       "2522359  2.752021 -0.022972 -0.202706  ...  0.405668  0.714635 -0.058023   \n",
       "2522360  2.356053 -0.317138 -0.254798  ...  0.347547  0.611648 -0.012535   \n",
       "2522361  2.351116 -0.325989 -0.250643  ...  0.336674  0.590637 -0.012795   \n",
       "\n",
       "             PC30      PC31      PC32      PC33      PC34      PC35  \\\n",
       "0       -0.161748 -0.219747 -0.004607  0.002601  0.033419 -0.014938   \n",
       "1       -0.638463 -0.371135  0.010602  0.000644  0.126258 -0.189626   \n",
       "2       -0.211976 -0.235381 -0.003066  0.002394  0.043401 -0.034325   \n",
       "3       -0.635723 -0.369948  0.010453  0.000654  0.125925 -0.189603   \n",
       "4       -0.208920  0.039939 -0.014041  0.000980 -0.049437 -0.001124   \n",
       "...           ...       ...       ...       ...       ...       ...   \n",
       "2522357 -0.644609 -1.450193  0.084712  0.000039 -0.077264  0.303285   \n",
       "2522358 -0.729908 -1.600768  0.107229 -0.000361  0.060156  0.186588   \n",
       "2522359 -0.932889 -2.075104  0.122933 -0.000099  0.085239  0.239972   \n",
       "2522360 -0.758092 -1.661729  0.110680 -0.000353  0.072124  0.184674   \n",
       "2522361 -0.730906 -1.606039  0.108408 -0.000360  0.067885  0.181076   \n",
       "\n",
       "         Attack Type  \n",
       "0             BENIGN  \n",
       "1             BENIGN  \n",
       "2             BENIGN  \n",
       "3             BENIGN  \n",
       "4             BENIGN  \n",
       "...              ...  \n",
       "2522357       BENIGN  \n",
       "2522358       BENIGN  \n",
       "2522359       BENIGN  \n",
       "2522360       BENIGN  \n",
       "2522361       BENIGN  \n",
       "\n",
       "[2522362 rows x 36 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = pd.read_csv('intermediate_data/Data_after_Preprocessing.csv')\n",
    "data\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "a3910f50",
   "metadata": {},
   "outputs": [],
   "source": [
    "# For cross validation\n",
    "from sklearn.model_selection import cross_val_score"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "74337249",
   "metadata": {},
   "source": [
    "### - Creating a Balanced Dataset for Binary Classification\n",
    "\n",
    "As we already know that the following dataset is highly imbalanced, we took the help of SMOTE (Synthetic Minority Over-sampling Technique) to upsample the minority classes while creating a balanced dataset for multi-class classification. This helped us in creating an overall balanced dataset to feed the classification models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "f05651d1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Attack Type\n",
      "1    7504\n",
      "0    7496\n",
      "Name: count, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "# Creating a balanced dataset for Binary Classification\n",
    "normal_traffic = data.loc[data['Attack Type'] == 'BENIGN']\n",
    "intrusions = data.loc[data['Attack Type'] != 'BENIGN']\n",
    "\n",
    "normal_traffic = normal_traffic.sample(n = len(intrusions), replace = False)\n",
    "\n",
    "ids_data = pd.concat([intrusions, normal_traffic])\n",
    "ids_data['Attack Type'] = np.where((ids_data['Attack Type'] == 'BENIGN'), 0, 1)\n",
    "bc_data = ids_data.sample(n = 15000)\n",
    "\n",
    "print(bc_data['Attack Type'].value_counts())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "7ad51eff",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Splitting the data into features (X) and target (y)\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "X_bc = bc_data.drop('Attack Type', axis = 1)\n",
    "y_bc = bc_data['Attack Type']\n",
    "\n",
    "X_train_bc, X_test_bc, y_train_bc, y_test_bc = train_test_split(X_bc, y_bc, test_size = 0.25, random_state = 0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8021ffa1",
   "metadata": {},
   "source": [
    "### - SVM -> Support Vector Machine (Binary Classification)\n",
    "\n",
    "We selected SVM over Logistic Regression because network attack patterns are complex and non-linear, meaning they cannot be separated by a simple straight line. SVM (with an RBF kernel) creates flexible, curved decision boundaries that effectively isolate these complex attack clusters. This resulted in superior accuracy (96%) compared to Logistic Regression, which struggled to distinguish overlapping traffic data.\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "1fdecb1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import GridSearchCV\n",
    "from sklearn.svm import SVC\n",
    "\n",
    "param_grid = {\n",
    "    'C': [0.1, 1, 10, 100],\n",
    "    'gamma': [1, 0.1, 0.01, 0.001],\n",
    "    'kernel': ['rbf']\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "95e19548",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Starting Grid Search... searching for the best hyperparameters.\n",
      "Fitting 5 folds for each of 16 candidates, totalling 80 fits\n",
      "[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time=   1.6s\n",
      "[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time=   1.5s\n",
      "[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time=   1.5s\n",
      "[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time=   1.4s\n",
      "[CV] END .........................C=0.1, gamma=1, kernel=rbf; total time=   1.5s\n",
      "[CV] END .......................C=0.1, gamma=0.1, kernel=rbf; total time=   0.8s\n",
      "[CV] END .......................C=0.1, gamma=0.1, kernel=rbf; total time=   0.8s\n",
      "[CV] END .......................C=0.1, gamma=0.1, kernel=rbf; total time=   0.8s\n",
      "[CV] END .......................C=0.1, gamma=0.1, kernel=rbf; total time=   0.8s\n",
      "[CV] END .......................C=0.1, gamma=0.1, kernel=rbf; total time=   0.8s\n",
      "[CV] END ......................C=0.1, gamma=0.01, kernel=rbf; total time=   1.1s\n",
      "[CV] END ......................C=0.1, gamma=0.01, kernel=rbf; total time=   1.1s\n",
      "[CV] END ......................C=0.1, gamma=0.01, kernel=rbf; total time=   1.1s\n",
      "[CV] END ......................C=0.1, gamma=0.01, kernel=rbf; total time=   1.1s\n",
      "[CV] END ......................C=0.1, gamma=0.01, kernel=rbf; total time=   1.1s\n",
      "[CV] END .....................C=0.1, gamma=0.001, kernel=rbf; total time=   1.7s\n",
      "[CV] END .....................C=0.1, gamma=0.001, kernel=rbf; total time=   1.7s\n",
      "[CV] END .....................C=0.1, gamma=0.001, kernel=rbf; total time=   1.8s\n",
      "[CV] END .....................C=0.1, gamma=0.001, kernel=rbf; total time=   1.7s\n",
      "[CV] END .....................C=0.1, gamma=0.001, kernel=rbf; total time=   1.7s\n",
      "[CV] END ...........................C=1, gamma=1, kernel=rbf; total time=   1.0s\n",
      "[CV] END ...........................C=1, gamma=1, kernel=rbf; total time=   1.1s\n",
      "[CV] END ...........................C=1, gamma=1, kernel=rbf; total time=   1.4s\n",
      "[CV] END ...........................C=1, gamma=1, kernel=rbf; total time=   1.0s\n",
      "[CV] END ...........................C=1, gamma=1, kernel=rbf; total time=   1.0s\n",
      "[CV] END .........................C=1, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .........................C=1, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .........................C=1, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .........................C=1, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .........................C=1, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END ........................C=1, gamma=0.01, kernel=rbf; total time=   0.6s\n",
      "[CV] END ........................C=1, gamma=0.01, kernel=rbf; total time=   0.6s\n",
      "[CV] END ........................C=1, gamma=0.01, kernel=rbf; total time=   0.6s\n",
      "[CV] END ........................C=1, gamma=0.01, kernel=rbf; total time=   0.6s\n",
      "[CV] END ........................C=1, gamma=0.01, kernel=rbf; total time=   0.6s\n",
      "[CV] END .......................C=1, gamma=0.001, kernel=rbf; total time=   1.2s\n",
      "[CV] END .......................C=1, gamma=0.001, kernel=rbf; total time=   1.1s\n",
      "[CV] END .......................C=1, gamma=0.001, kernel=rbf; total time=   1.3s\n",
      "[CV] END .......................C=1, gamma=0.001, kernel=rbf; total time=   1.3s\n",
      "[CV] END .......................C=1, gamma=0.001, kernel=rbf; total time=   1.2s\n",
      "[CV] END ..........................C=10, gamma=1, kernel=rbf; total time=   1.1s\n",
      "[CV] END ..........................C=10, gamma=1, kernel=rbf; total time=   1.1s\n",
      "[CV] END ..........................C=10, gamma=1, kernel=rbf; total time=   1.2s\n",
      "[CV] END ..........................C=10, gamma=1, kernel=rbf; total time=   1.1s\n",
      "[CV] END ..........................C=10, gamma=1, kernel=rbf; total time=   1.1s\n",
      "[CV] END ........................C=10, gamma=0.1, kernel=rbf; total time=   0.5s\n",
      "[CV] END ........................C=10, gamma=0.1, kernel=rbf; total time=   0.5s\n",
      "[CV] END ........................C=10, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END ........................C=10, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END ........................C=10, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .......................C=10, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END .......................C=10, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END .......................C=10, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END .......................C=10, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END .......................C=10, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END ......................C=10, gamma=0.001, kernel=rbf; total time=   0.8s\n",
      "[CV] END ......................C=10, gamma=0.001, kernel=rbf; total time=   0.8s\n",
      "[CV] END ......................C=10, gamma=0.001, kernel=rbf; total time=   0.9s\n",
      "[CV] END ......................C=10, gamma=0.001, kernel=rbf; total time=   0.8s\n",
      "[CV] END ......................C=10, gamma=0.001, kernel=rbf; total time=   0.8s\n",
      "[CV] END .........................C=100, gamma=1, kernel=rbf; total time=   1.5s\n",
      "[CV] END .........................C=100, gamma=1, kernel=rbf; total time=   1.4s\n",
      "[CV] END .........................C=100, gamma=1, kernel=rbf; total time=   1.5s\n",
      "[CV] END .........................C=100, gamma=1, kernel=rbf; total time=   1.3s\n",
      "[CV] END .........................C=100, gamma=1, kernel=rbf; total time=   1.3s\n",
      "[CV] END .......................C=100, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .......................C=100, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .......................C=100, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .......................C=100, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END .......................C=100, gamma=0.1, kernel=rbf; total time=   0.6s\n",
      "[CV] END ......................C=100, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END ......................C=100, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END ......................C=100, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END ......................C=100, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END ......................C=100, gamma=0.01, kernel=rbf; total time=   0.5s\n",
      "[CV] END .....................C=100, gamma=0.001, kernel=rbf; total time=   0.6s\n",
      "[CV] END .....................C=100, gamma=0.001, kernel=rbf; total time=   0.6s\n",
      "[CV] END .....................C=100, gamma=0.001, kernel=rbf; total time=   0.6s\n",
      "[CV] END .....................C=100, gamma=0.001, kernel=rbf; total time=   0.7s\n",
      "[CV] END .....................C=100, gamma=0.001, kernel=rbf; total time=   0.6s\n",
      "\n",
      "Training Complete.\n"
     ]
    }
   ],
   "source": [
    "# Initialize Grid Search\n",
    "# refit=True ensures the model automatically retrains on the best settings found\n",
    "grid = GridSearchCV(SVC(), param_grid, refit=True, verbose=2, cv=5)\n",
    "\n",
    "# Train the model (This may take a minute)\n",
    "print(\"Starting Grid Search... searching for the best hyperparameters.\")\n",
    "grid.fit(X_train_bc, y_train_bc)\n",
    "\n",
    "print(\"\\nTraining Complete.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "c818b057",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Best Hyperparameters: {'C': 100, 'gamma': 0.1, 'kernel': 'rbf'}\n",
      "Best Cross-Validation Score: 0.97\n"
     ]
    }
   ],
   "source": [
    "# Print the best parameters found\n",
    "print(f\"Best Hyperparameters: {grid.best_params_}\")\n",
    "print(f\"Best Cross-Validation Score: {grid.best_score_:.2f}\")\n",
    "\n",
    "# The 'grid' object now acts as your best model automatically\n",
    "best_svm_model = grid.best_estimator_"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "129f54d7",
   "metadata": {},
   "source": [
    "### - Evaluation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "8efb2fb1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Predict on the test set\n",
    "grid_predictions = grid.predict(X_test_bc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "d066f27b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Classification Report:\n",
      "\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.98      0.97      0.97      1913\n",
      "           1       0.96      0.98      0.97      1837\n",
      "\n",
      "    accuracy                           0.97      3750\n",
      "   macro avg       0.97      0.97      0.97      3750\n",
      "weighted avg       0.97      0.97      0.97      3750\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Print Text Report\n",
    "from sklearn.metrics import classification_report\n",
    "\n",
    "print(\"Classification Report:\\n\")\n",
    "print(classification_report(y_test_bc, grid_predictions))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "6110a690",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 600x400 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot Confusion Matrix\n",
    "from sklearn.metrics import confusion_matrix\n",
    "\n",
    "plt.figure(figsize=(6, 4))\n",
    "sns.heatmap(confusion_matrix(y_test_bc, grid_predictions), annot=True, fmt='d', cmap='Blues')\n",
    "plt.title('Confusion Matrix: SVM (Optimized)')\n",
    "plt.ylabel('Actual Label')\n",
    "plt.xlabel('Predicted Label')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "83c2382e",
   "metadata": {},
   "source": [
    "### - Creating a Balanced Dataset for Multi-class Classification"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "340c9963",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Attack Type\n",
       "BENIGN          2096484\n",
       "DoS              193748\n",
       "DDoS             128016\n",
       "Port Scan         90819\n",
       "Brute Force        9152\n",
       "Web Attack         2143\n",
       "Bot                1953\n",
       "Infiltration         36\n",
       "Heartbleed           11\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data['Attack Type'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "3f27f16a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Attack Type\n",
       "BENIGN         5000\n",
       "DoS            5000\n",
       "DDoS           5000\n",
       "Port Scan      5000\n",
       "Brute Force    5000\n",
       "Web Attack     2143\n",
       "Bot            1953\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "class_counts = data['Attack Type'].value_counts()\n",
    "selected_classes = class_counts[class_counts > 1950]\n",
    "class_names = selected_classes.index\n",
    "selected = data[data['Attack Type'].isin(class_names)]\n",
    "\n",
    "dfs = []\n",
    "for name in class_names:\n",
    "  df = selected[selected['Attack Type'] == name]\n",
    "  if len(df) > 5000:\n",
    "    df = df.sample(n = 5000, random_state = 0)\n",
    "\n",
    "  dfs.append(df)\n",
    "\n",
    "df = pd.concat(dfs, ignore_index = True)\n",
    "df['Attack Type'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "11a90dbb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Attack Type\n",
       "Brute Force    5000\n",
       "Web Attack     5000\n",
       "DoS            5000\n",
       "Bot            5000\n",
       "DDoS           5000\n",
       "BENIGN         5000\n",
       "Port Scan      5000\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from imblearn.over_sampling import SMOTE\n",
    "\n",
    "X = df.drop('Attack Type', axis=1)\n",
    "y = df['Attack Type']\n",
    "\n",
    "smote = SMOTE(sampling_strategy='auto', random_state=0)\n",
    "X_upsampled, y_upsampled = smote.fit_resample(X, y)\n",
    "\n",
    "blnc_data = pd.DataFrame(X_upsampled)\n",
    "blnc_data['Attack Type'] = y_upsampled\n",
    "blnc_data = blnc_data.sample(frac=1)\n",
    "\n",
    "blnc_data['Attack Type'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "cc9a6a94",
   "metadata": {},
   "outputs": [],
   "source": [
    "features = blnc_data.drop('Attack Type', axis = 1)\n",
    "labels = blnc_data['Attack Type']\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(features, labels, test_size = 0.25, random_state = 0)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af93535d",
   "metadata": {},
   "source": [
    "### - Random Forest Classifier\n",
    "\n",
    "**Why?**\n",
    "\n",
    "***Speed***: KNN is lazy. It does zero work during training but is slow when predicting (it has to calculate distance to 30,000 points every time). In an Intrusion Detection System (IDS), speed is everything. You can't wait 2 seconds to decide if a packet is malicious. Random Forest predicts almost instantly.\n",
    "\n",
    "***Feature Importance***: Random Forest can tell you which columns (e.g., \"Source Port\") were most important. KNN cannot."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "a2f86283",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import RandomizedSearchCV\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.metrics import classification_report, confusion_matrix, accuracy_score"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "c03d6152",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Parameter grid defined.\n"
     ]
    }
   ],
   "source": [
    "# Create the random grid\n",
    "# We provide lists of options. The algorithm will randomly pick from these.\n",
    "random_grid = {\n",
    "    'n_estimators': [50, 100, 200, 300],        # Number of trees in the forest\n",
    "    'max_features': ['sqrt', 'log2'],           # Number of features to consider at every split\n",
    "    'max_depth': [10, 20, 30, 40, 50, None],    # Maximum number of levels in tree\n",
    "    'min_samples_split': [2, 5, 10],            # Minimum number of samples required to split a node\n",
    "    'min_samples_leaf': [1, 2, 4],              # Minimum number of samples required at each leaf node\n",
    "    'bootstrap': [True, False]                  # Method of selecting samples for training each tree\n",
    "}\n",
    "\n",
    "print(\"Parameter grid defined.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "b7e228cf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Starting Randomized Search... this might take 1-2 minutes.\n",
      "Fitting 3 folds for each of 50 candidates, totalling 150 fits\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=50; total time=   6.3s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=50; total time=   6.4s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=50; total time=   6.4s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=   7.4s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=   7.5s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=200; total time=  14.7s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=200; total time=  14.9s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=200; total time=  15.0s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=   7.3s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  19.4s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  19.3s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  20.0s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  35.7s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  36.0s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=300; total time=  21.8s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  34.8s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=300; total time=  22.2s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=  11.3s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=  11.7s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=  11.9s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=200; total time=  14.4s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=200; total time=  14.7s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=  10.4s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=300; total time=  22.1s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=  10.8s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=200; total time=  15.4s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=  10.8s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=2, n_estimators=100; total time=  12.1s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=100; total time=   7.7s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=2, n_estimators=100; total time=  12.6s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=100; total time=   7.9s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=100; total time=   7.7s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=2, n_estimators=100; total time=  12.5s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   5.0s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   5.5s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   5.3s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=200; total time=  23.3s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=200; total time=  23.7s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=200; total time=  23.9s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=200; total time=  23.1s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=  11.9s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=  11.5s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=300; total time=  35.0s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=200; total time=  22.7s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=300; total time=  34.8s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=log2, min_samples_leaf=2, min_samples_split=5, n_estimators=300; total time=  35.5s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=200; total time=  22.4s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=  10.6s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=  10.2s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=log2, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   5.2s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=log2, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   5.6s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=  10.9s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=  10.7s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=300; total time=  17.7s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=50; total time=   3.3s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=50; total time=   3.4s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=300; total time=  17.4s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=50; total time=   3.3s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=log2, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   5.3s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=300; total time=  17.4s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=50; total time=   5.4s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=50; total time=   5.5s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=50; total time=   5.7s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=log2, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   4.7s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=log2, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   4.8s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=log2, min_samples_leaf=4, min_samples_split=10, n_estimators=50; total time=   4.7s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=1, min_samples_split=5, n_estimators=100; total time=  11.1s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=1, min_samples_split=5, n_estimators=100; total time=  11.6s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=1, min_samples_split=5, n_estimators=100; total time=  11.5s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=200; total time=  13.9s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=200; total time=  14.1s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=   9.2s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=   9.4s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=   6.9s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=200; total time=  14.3s\n",
      "[CV] END bootstrap=False, max_depth=10, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=  10.2s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=   7.6s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=   7.5s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=300; total time=  33.8s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=300; total time=  34.1s\n",
      "[CV] END bootstrap=False, max_depth=40, max_features=sqrt, min_samples_leaf=1, min_samples_split=10, n_estimators=300; total time=  35.0s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=100; total time=   6.7s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=100; total time=   6.9s\n",
      "[CV] END bootstrap=True, max_depth=40, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=200; total time=  13.3s\n",
      "[CV] END bootstrap=True, max_depth=40, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=200; total time=  13.2s\n",
      "[CV] END bootstrap=True, max_depth=40, max_features=sqrt, min_samples_leaf=4, min_samples_split=10, n_estimators=200; total time=  13.2s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=100; total time=   6.6s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=log2, min_samples_leaf=2, min_samples_split=2, n_estimators=300; total time=  20.5s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=log2, min_samples_leaf=2, min_samples_split=2, n_estimators=300; total time=  20.2s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=log2, min_samples_leaf=2, min_samples_split=2, n_estimators=300; total time=  20.0s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=1, min_samples_split=2, n_estimators=200; total time=  13.3s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=1, min_samples_split=2, n_estimators=200; total time=  13.2s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=200; total time=  12.8s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=1, min_samples_split=2, n_estimators=200; total time=  13.1s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=200; total time=  13.0s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=2, min_samples_split=10, n_estimators=200; total time=  12.9s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=200; total time=  20.7s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=200; total time=  20.5s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=50; total time=   3.4s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=200; total time=  20.9s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=50; total time=   3.2s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  19.5s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=50; total time=   3.0s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  19.9s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  20.1s\n",
      "[CV] END bootstrap=False, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=200; total time=  20.4s\n",
      "[CV] END bootstrap=False, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=200; total time=  20.9s\n",
      "[CV] END bootstrap=False, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=200; total time=  21.4s\n",
      "[CV] END bootstrap=True, max_depth=40, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  19.1s\n",
      "[CV] END bootstrap=True, max_depth=40, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  19.5s\n",
      "[CV] END bootstrap=True, max_depth=40, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=300; total time=  19.0s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=300; total time=  18.6s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=300; total time=  31.3s\n",
      "[CV] END bootstrap=False, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=  11.1s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=300; total time=  32.3s\n",
      "[CV] END bootstrap=False, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=  11.1s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=300; total time=  19.9s\n",
      "[CV] END bootstrap=False, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=300; total time=  32.4s\n",
      "[CV] END bootstrap=False, max_depth=20, max_features=sqrt, min_samples_leaf=2, min_samples_split=10, n_estimators=100; total time=  11.6s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=   7.0s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=   7.2s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=   7.2s\n",
      "[CV] END bootstrap=True, max_depth=20, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=300; total time=  20.2s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=   7.0s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=  11.1s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=  11.5s\n",
      "[CV] END bootstrap=False, max_depth=50, max_features=sqrt, min_samples_leaf=4, min_samples_split=5, n_estimators=100; total time=  11.6s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=   7.3s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=5, n_estimators=100; total time=   7.1s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=200; total time=  13.9s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=200; total time=  14.2s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=200; total time=  14.8s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=200; total time=  14.5s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=200; total time=  14.9s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  22.3s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  21.8s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=sqrt, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  22.1s\n",
      "[CV] END bootstrap=True, max_depth=30, max_features=log2, min_samples_leaf=4, min_samples_split=5, n_estimators=200; total time=  13.9s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=log2, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  18.4s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=log2, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  18.8s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=  10.7s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=1, min_samples_split=10, n_estimators=50; total time=   3.6s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=  11.0s\n",
      "[CV] END bootstrap=True, max_depth=10, max_features=log2, min_samples_leaf=1, min_samples_split=2, n_estimators=300; total time=  18.1s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=1, min_samples_split=10, n_estimators=50; total time=   3.6s\n",
      "[CV] END bootstrap=True, max_depth=50, max_features=log2, min_samples_leaf=1, min_samples_split=10, n_estimators=50; total time=   3.1s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=300; total time=  19.7s\n",
      "[CV] END bootstrap=False, max_depth=30, max_features=sqrt, min_samples_leaf=4, min_samples_split=2, n_estimators=100; total time=   9.7s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=300; total time=  19.2s\n",
      "[CV] END bootstrap=True, max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=2, n_estimators=300; total time=  18.7s\n",
      "Optimization Complete.\n"
     ]
    }
   ],
   "source": [
    "# Initialize the base model\n",
    "rf = RandomForestClassifier(random_state=42)\n",
    "\n",
    "# Initialize RandomizedSearchCV\n",
    "# n_iter=50: It will train 50 different models.\n",
    "# cv=3: Each model is tested 3 times (Cross-Validation).\n",
    "# n_jobs=-1: Use all computer processor cores to speed it up.\n",
    "rf_random = RandomizedSearchCV(estimator=rf, param_distributions=random_grid,\n",
    "                               n_iter=50, cv=3, verbose=2, random_state=42, n_jobs=-1)\n",
    "\n",
    "# Fit the random search model\n",
    "print(\"Starting Randomized Search... this might take 1-2 minutes.\")\n",
    "rf_random.fit(X_train, y_train)\n",
    "print(\"Optimization Complete.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "6eac8a84",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Best Accuracy found: 0.99\n",
      "Best Hyperparameters:\n",
      "{'n_estimators': 50, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'max_depth': 50, 'bootstrap': False}\n"
     ]
    }
   ],
   "source": [
    "# Get the best parameters and score\n",
    "print(f\"Best Accuracy found: {rf_random.best_score_:.2f}\")\n",
    "print(\"Best Hyperparameters:\")\n",
    "print(rf_random.best_params_)\n",
    "\n",
    "# The 'rf_random' object automatically acts as the best model found\n",
    "best_rf_model = rf_random.best_estimator_"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "599d8065",
   "metadata": {},
   "source": [
    "### - Evaluation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "1aa6224d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Predict on the test set\n",
    "y_pred = best_rf_model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "2bce4e26",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Final Classification Report:\n",
      "\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "      BENIGN       0.98      0.98      0.98      1252\n",
      "         Bot       0.99      1.00      0.99      1280\n",
      " Brute Force       1.00      0.99      1.00      1250\n",
      "        DDoS       1.00      1.00      1.00      1223\n",
      "         DoS       0.99      0.99      0.99      1249\n",
      "   Port Scan       1.00      1.00      1.00      1231\n",
      "  Web Attack       1.00      0.99      1.00      1265\n",
      "\n",
      "    accuracy                           0.99      8750\n",
      "   macro avg       0.99      0.99      0.99      8750\n",
      "weighted avg       0.99      0.99      0.99      8750\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# Classification Report (Precision/Recall per attack type)\n",
    "print(\"Final Classification Report:\\n\")\n",
    "print(classification_report(y_test, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "8a670ad2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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R493dOGcEEIIUbHQk9qFEInSvHlz99BDD6Ve//vvv27t2rX2VGieJD9nzhxXqVKl/d4Onhh94YUX5rz+p59+6pYuXeoONK+99po9JXvjxo0mNFq3bl3ic/ps/vz59gRmD09l5snLScOToXv16pV6PXnyZLdu3Tr35JNPpt474ogjEmqdEEKIpJAgEUIkCgZoq1atSrx31llnue3bt7snnnjCffXVV/t8vj847rjjbClkiH4sWbLEokdTpkxxL7/88j6CpJBp2LChLZ46deq4Qw899IAcXyGEEIWLUraEEAUJqVvwww8/2F9See6++253xx13mAHbt29fe3/Xrl3u0Ucfde3bt7fvkMq0aNGiEr/133//mTeeVLDTTz/dPPXRdLC4lK3XX3/dXXnllfYdvjthwgT3zz//WGrV0KFDbZ2LL77YUpHCaMTll1+eSj3jd/fs2VPidxcvXuy6devmTjvtNPv99evX59QnCxYscLt377ZIDt9/55133B9//JH6/LPPPnPXXXed/c9f+oy2zZs3z1LLwrQw0sRI7brgggtcixYt3Lnnnmuvt23bVqLuZMaMGa5z587W1o4dO7pp06alrUch2tGmTRvXr18/66ey8OGHH1o7P/744xLvk4LG+0SF2E+/Tu/eva1tnTp1crNnz97nuD/77LPWbo7HpZde6mbNmlWmdgkhhNh/KEIihChINm/ebH9PPPHE1HtvvfWWGeJPP/20GZsYxv3793crV640oXLyySe7d9991915551mEPfo0cO+N27cODdz5kx36623mrjgdxAXmXjppZfciBEjLJVr8ODBbsuWLSZ8EDKDBg2y36IdpBt5IUPU4vHHH3fXXnutCRbSpxAkP/74oxs1apSt8/7771tbEU733HOPrcPfXNO1ECN169a1feO3ERtenCEsHnzwQWs3f88++2yLQPz++++p1CgiFDt37jTBUrt2bUuXO/LII92qVavs88MOO8y+D+zvCy+8YL9//vnnu6+//tqNHz/eRNHNN99com2khN1www3Wv0899ZRttyywf8cee6ylnSGWQnHYqFEjiwghSIDjTD/ccsst7r333rPIEVxzzTX2d/jw4SbAaOsZZ5zhvvjiCzsORJo4b4QQQhQGEiRCiERBVGDgejD4P//8czP2MSJ9pASqVq1qRqc3dinw/uijj0wEdOnSJWXQ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",
      "text/plain": [
       "<Figure size 1000x800 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Confusion Matrix Heatmap\n",
    "plt.figure(figsize=(10, 8))\n",
    "# We get the class names from the model to label the axes correctly\n",
    "classes = best_rf_model.classes_\n",
    "\n",
    "sns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='d', cmap='Greens',\n",
    "            xticklabels=classes, yticklabels=classes)\n",
    "\n",
    "plt.title('Confusion Matrix: Optimized Random Forest')\n",
    "plt.ylabel('Actual Attack Type')\n",
    "plt.xlabel('Predicted Attack Type')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1672f78a",
   "metadata": {},
   "source": [
    "While our Binary model was effective, the Multi-Class Random Forest model outperformed it significantly. It achieved 99% accuracy across 7 different categories. Most notably, it successfully distinguished between 'DoS' and 'DDoS' attacksâ€”which are notoriously difficult to separateâ€”with fewer than 10 errors. This proves that Random Forest is the superior algorithm for granular attack classification.\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "0e46593b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Binary SVM model saved to: saved_models/binary_svm_model.pkl\n",
      "Multi-Class Random Forest model saved to: saved_models/multiclass_rf_model.pkl\n",
      "\n",
      "All models saved successfully!\n"
     ]
    }
   ],
   "source": [
    "import joblib\n",
    "import os\n",
    "\n",
    "model_dir = 'saved_models'\n",
    "if not os.path.exists(model_dir):\n",
    "    os.makedirs(model_dir)\n",
    "\n",
    "# Save the Binary Classification Model\n",
    "svm_model_path = os.path.join(model_dir, 'binary_svm_model.pkl')\n",
    "joblib.dump(best_svm_model, svm_model_path)\n",
    "print(f\"Binary SVM model saved to: {svm_model_path}\")\n",
    "\n",
    "# Save the Multi-Class Classification Model\n",
    "rf_model_path = os.path.join(model_dir, 'multiclass_rf_model.pkl')\n",
    "joblib.dump(best_rf_model, rf_model_path)\n",
    "print(f\"Multi-Class Random Forest model saved to: {rf_model_path}\")\n",
    "\n",
    "print(\"\\nAll models saved successfully!\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dd2d6fba",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
</file>

<file path="README.md">
# Intrusion Detection System (IDS) Web Application

A production-ready Intrusion Detection System built with FastAPI backend and React frontend, featuring real-time network monitoring, ML-based attack detection, and a comprehensive dashboard.

## Features

- **Real-time Network Monitoring**: Live packet capture and flow analysis
- **ML-Powered Detection**: Binary (SVM) and multiclass (Random Forest) attack classification
- **Attack Types Detected**: Port Scan, DoS/DDoS, Brute Force, Bot, Web Attack, and more
- **Interactive Dashboard**: Real-time metrics, charts, and flow visualization
- **WebSocket Support**: Live streaming of detected attacks
- **RESTful API**: Complete API for predictions, history, and model insights

## Project Structure

```
IDS_System/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI application
â”‚   â”‚   â”œâ”€â”€ config.py             # Configuration settings
â”‚   â”‚   â”œâ”€â”€ models/               # Database models
â”‚   â”‚   â”œâ”€â”€ ml/                   # ML models and preprocessing
â”‚   â”‚   â”œâ”€â”€ routers/              # API routes
â”‚   â”‚   â”œâ”€â”€ schemas/              # Pydantic schemas
â”‚   â”‚   â””â”€â”€ services/             # Packet sniffer, flow manager
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/                # React pages
â”‚   â”‚   â”œâ”€â”€ components/           # Reusable components
â”‚   â”‚   â””â”€â”€ api/                  # API client
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ saved_models/                 # Trained ML models
â”‚   â”œâ”€â”€ binary_svm_model.pkl
â”‚   â”œâ”€â”€ multiclass_rf_model.pkl
â”‚   â”œâ”€â”€ scaler.pkl
â”‚   â””â”€â”€ pca.pkl
â””â”€â”€ README.md
```

## Prerequisites

- Python 3.8+
- Node.js 18+ and npm
- macOS (for Multipass VMs) or Linux
- Root/Admin privileges for packet capture

## Installation

### Backend Setup

1. **Create virtual environment:**
```bash
cd backend
python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

2. **Install dependencies:**
```bash
pip install -r requirements.txt
```

3. **Configure environment:**
```bash
cd ..
cp .env.example .env
# Edit .env with your settings (especially INTERFACE_NAME)
```

4. **Verify models are in place:**
```bash
ls saved_models/
# Should show: binary_svm_model.pkl, multiclass_rf_model.pkl, scaler.pkl, pca.pkl
```

### Frontend Setup

1. **Install dependencies:**
```bash
cd frontend
npm install
```

2. **Configure API URL (optional):**
Create `frontend/.env`:
```
VITE_API_BASE_URL=http://localhost:8000
VITE_WS_BASE_URL=ws://localhost:8000
```

## Running the Application

### Start Backend

```bash
cd backend
source venv/bin/activate
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

The API will be available at:
- API: http://localhost:8000
- Docs: http://localhost:8000/docs
- Health: http://localhost:8000/api/health

### Start Frontend

```bash
cd frontend
npm run dev
```

The frontend will be available at http://localhost:5173

## Finding Your Network Interface

On macOS, find the interface used by Multipass VMs:

```bash
ifconfig | grep -A 5 bridge
```

Look for `bridge100` or similar. Common interfaces:
- `bridge100` - Multipass bridge (default)
- `en0` - Primary Ethernet/WiFi
- `lo0` - Loopback

Set the interface in `.env`:
```
INTERFACE_NAME=bridge100
```

**Note:** Packet capture requires root privileges. On macOS, you may need to run the backend with `sudo` or grant Terminal/your IDE network access in System Preferences.

## Attack Simulation with Multipass VMs

This guide shows how to set up attacker and victim VMs to generate real network attacks for testing the IDS.

### 1. Install Multipass

```bash
brew install multipass
```

### 2. Create VMs

```bash
# Create attacker VM
multipass launch --name attacker --cpus 2 --mem 2G --disk 10G

# Create victim VM
multipass launch --name victim --cpus 2 --mem 2G --disk 10G
```

### 3. Get VM IPs

```bash
multipass list
```

Note the IP addresses (e.g., `192.168.64.5` for attacker, `192.168.64.6` for victim).

### 4. Install Attack Tools on Attacker VM

```bash
multipass shell attacker

# Update system
sudo apt update && sudo apt upgrade -y

# Install attack tools
sudo apt install -y nmap hping3 hydra

# Install wordlist for brute force
sudo apt install -y wordlists
# Or download rockyou.txt
wget https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt
```

### 5. Set Up Victim VM

```bash
multipass shell victim

# Enable SSH (if not already enabled)
sudo systemctl enable ssh
sudo systemctl start ssh

# Create a test user for brute force (optional)
sudo useradd -m -s /bin/bash testuser
echo "testuser:password123" | sudo chpasswd
```

### 6. Find Host Interface

On your Mac (host machine):

```bash
ifconfig | grep -A 5 bridge
```

Look for the bridge interface (usually `bridge100`). This is what the IDS will monitor.

### 7. Configure IDS Interface

Edit `.env`:
```
INTERFACE_NAME=bridge100
```

### 8. Generate Attacks

#### Port Scan Attack

```bash
multipass shell attacker

# Replace VICTIM_IP with actual victim IP
VICTIM_IP=192.168.64.6

# Stealth SYN scan
nmap -sS -p- $VICTIM_IP

# Aggressive scan
nmap -A $VICTIM_IP
```

#### DoS/DDoS Attack

```bash
multipass shell attacker

VICTIM_IP=192.168.64.6

# SYN flood
sudo hping3 --flood --syn -p 80 $VICTIM_IP

# UDP flood
sudo hping3 --flood --udp -p 80 $VICTIM_IP

# Stop with Ctrl+C
```

#### Brute Force Attack (SSH)

```bash
multipass shell attacker

VICTIM_IP=192.168.64.6

# SSH brute force
hydra -l testuser -P rockyou.txt ssh://$VICTIM_IP

# Or with a smaller wordlist
echo -e "password123\nadmin\nroot\n123456" > wordlist.txt
hydra -l testuser -P wordlist.txt ssh://$VICTIM_IP
```

### 9. Monitor in IDS

1. Start the backend (with packet sniffer running)
2. Open the frontend dashboard
3. Navigate to "Live Monitoring"
4. Watch attacks appear in real-time

## API Endpoints

### Health Check
```
GET /api/health
```

### Predict Single Flow
```
POST /api/predictions/predict-flow
Body: FlowInput (JSON with flow features)
```

### Get Prediction History
```
GET /api/predictions/history?limit=100
```

### Get Model Information
```
GET /api/models/info
```

### Get Model Metrics
```
GET /api/models/metrics
```

### WebSocket Live Stream
```
WS /api/live
```

## Frontend Pages

- **Dashboard**: Overview with metrics, charts, and recent flows
- **Live Monitoring**: Real-time WebSocket stream of detected flows
- **Model Insights**: Model performance metrics and confusion matrices
- **Flow Analyzer**: Manual flow analysis form

## Model Information

### Binary Classifier
- **Algorithm**: SVM (Support Vector Machine) with RBF kernel
- **Accuracy**: 97%
- **Purpose**: Distinguish between benign traffic and attacks

### Multiclass Classifier
- **Algorithm**: Random Forest
- **Accuracy**: 99%
- **Classes**: BENIGN, Bot, Brute Force, DDoS, DoS, Port Scan, Web Attack

### Preprocessing
- StandardScaler for feature normalization
- IncrementalPCA for dimensionality reduction (70 â†’ 35 features)
- 99.3% variance retained

## Troubleshooting

### Packet Sniffer Not Working

1. **Check interface name:**
```bash
ifconfig
```

2. **Verify permissions:**
   - On macOS: Grant Terminal network access in System Preferences
   - On Linux: Run with `sudo` or add user to appropriate groups

3. **Test interface:**
```bash
sudo tcpdump -i bridge100 -c 10
```

### Models Not Loading

1. Verify models exist:
```bash
ls -la saved_models/
```

2. Check file paths in `backend/app/config.py`

3. Ensure models are in the correct location (root of project or `saved_models/`)

### Frontend Can't Connect to Backend

1. Check CORS settings in `backend/app/config.py`
2. Verify backend is running on port 8000
3. Check browser console for errors
4. Verify API URL in `frontend/src/config.js`

## Development

### Running Tests

```bash
cd backend
pytest tests/
```

### Code Structure

- **Backend**: FastAPI with async support, SQLAlchemy ORM, Scapy for packet capture
- **Frontend**: React 18+ with Vite, TailwindCSS, Recharts for visualization
- **ML**: scikit-learn models loaded via joblib

## License

This project is for educational and research purposes.

## Acknowledgments

- Models trained on the CICIDS2017 dataset
- Preprocessing pipeline based on standard network flow analysis techniques
</file>

<file path=".gitignore">
Network Intrusion Dataset/
intermediate_data/
</file>

<file path="Data_Preprocessing.ipynb">
{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "e72e03b2",
   "metadata": {},
   "source": [
    "## Data Preprocessing\n",
    "#### - Preprocessing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "0ca27539",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import seaborn as sns\n",
    "sns.set(style='darkgrid')\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "603774f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "data = pd.read_csv('intermediate_data/Data_after_EDA.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "f7b5a3f2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Initial memory usage: 1520.28 MB\n",
      "Final memory usage: 789.01 MB\n"
     ]
    }
   ],
   "source": [
    "# For improving performance and reduce memory-related errors\n",
    "old_memory_usage = data.memory_usage().sum() / 1024 ** 2\n",
    "print(f'Initial memory usage: {old_memory_usage:.2f} MB')\n",
    "for col in data.columns:\n",
    "    col_type = data[col].dtype\n",
    "    if col_type != object:\n",
    "        c_min = data[col].min()\n",
    "        c_max = data[col].max()\n",
    "        # Downcasting float64 to float32\n",
    "        if str(col_type).find('float') >= 0 and c_min > np.finfo(np.float32).min and c_max < np.finfo(np.float32).max:\n",
    "            data[col] = data[col].astype(np.float32)\n",
    "\n",
    "        # Downcasting int64 to int32\n",
    "        elif str(col_type).find('int') >= 0 and c_min > np.iinfo(np.int32).min and c_max < np.iinfo(np.int32).max:\n",
    "            data[col] = data[col].astype(np.int32)\n",
    "\n",
    "new_memory_usage = data.memory_usage().sum() / 1024 ** 2\n",
    "print(f\"Final memory usage: {new_memory_usage:.2f} MB\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "0a8a0840",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Reduced memory usage: 48.10%\n"
     ]
    }
   ],
   "source": [
    "# Calculating percentage reduction in memory usage\n",
    "print(f'Reduced memory usage: {1 - (new_memory_usage / old_memory_usage):.2%}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "a2d9ac6f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 2522362 entries, 0 to 2522361\n",
      "Data columns (total 79 columns):\n",
      " #   Column                       Dtype  \n",
      "---  ------                       -----  \n",
      " 0   Destination Port             int32  \n",
      " 1   Flow Duration                int32  \n",
      " 2   Total Fwd Packets            int32  \n",
      " 3   Total Backward Packets       int32  \n",
      " 4   Total Length of Fwd Packets  int32  \n",
      " 5   Total Length of Bwd Packets  int32  \n",
      " 6   Fwd Packet Length Max        int32  \n",
      " 7   Fwd Packet Length Min        int32  \n",
      " 8   Fwd Packet Length Mean       float32\n",
      " 9   Fwd Packet Length Std        float32\n",
      " 10  Bwd Packet Length Max        int32  \n",
      " 11  Bwd Packet Length Min        int32  \n",
      " 12  Bwd Packet Length Mean       float32\n",
      " 13  Bwd Packet Length Std        float32\n",
      " 14  Flow Bytes/s                 float32\n",
      " 15  Flow Packets/s               float32\n",
      " 16  Flow IAT Mean                float32\n",
      " 17  Flow IAT Std                 float32\n",
      " 18  Flow IAT Max                 int32  \n",
      " 19  Flow IAT Min                 int32  \n",
      " 20  Fwd IAT Total                int32  \n",
      " 21  Fwd IAT Mean                 float32\n",
      " 22  Fwd IAT Std                  float32\n",
      " 23  Fwd IAT Max                  int32  \n",
      " 24  Fwd IAT Min                  int32  \n",
      " 25  Bwd IAT Total                int32  \n",
      " 26  Bwd IAT Mean                 float32\n",
      " 27  Bwd IAT Std                  float32\n",
      " 28  Bwd IAT Max                  int32  \n",
      " 29  Bwd IAT Min                  int32  \n",
      " 30  Fwd PSH Flags                int32  \n",
      " 31  Bwd PSH Flags                int32  \n",
      " 32  Fwd URG Flags                int32  \n",
      " 33  Bwd URG Flags                int32  \n",
      " 34  Fwd Header Length            int64  \n",
      " 35  Bwd Header Length            int32  \n",
      " 36  Fwd Packets/s                float32\n",
      " 37  Bwd Packets/s                float32\n",
      " 38  Min Packet Length            int32  \n",
      " 39  Max Packet Length            int32  \n",
      " 40  Packet Length Mean           float32\n",
      " 41  Packet Length Std            float32\n",
      " 42  Packet Length Variance       float32\n",
      " 43  FIN Flag Count               int32  \n",
      " 44  SYN Flag Count               int32  \n",
      " 45  RST Flag Count               int32  \n",
      " 46  PSH Flag Count               int32  \n",
      " 47  ACK Flag Count               int32  \n",
      " 48  URG Flag Count               int32  \n",
      " 49  CWE Flag Count               int32  \n",
      " 50  ECE Flag Count               int32  \n",
      " 51  Down/Up Ratio                int32  \n",
      " 52  Average Packet Size          float32\n",
      " 53  Avg Fwd Segment Size         float32\n",
      " 54  Avg Bwd Segment Size         float32\n",
      " 55  Fwd Header Length.1          int64  \n",
      " 56  Fwd Avg Bytes/Bulk           int32  \n",
      " 57  Fwd Avg Packets/Bulk         int32  \n",
      " 58  Fwd Avg Bulk Rate            int32  \n",
      " 59  Bwd Avg Bytes/Bulk           int32  \n",
      " 60  Bwd Avg Packets/Bulk         int32  \n",
      " 61  Bwd Avg Bulk Rate            int32  \n",
      " 62  Subflow Fwd Packets          int32  \n",
      " 63  Subflow Fwd Bytes            int32  \n",
      " 64  Subflow Bwd Packets          int32  \n",
      " 65  Subflow Bwd Bytes            int32  \n",
      " 66  Init_Win_bytes_forward       int32  \n",
      " 67  Init_Win_bytes_backward      int32  \n",
      " 68  act_data_pkt_fwd             int32  \n",
      " 69  min_seg_size_forward         int32  \n",
      " 70  Active Mean                  float32\n",
      " 71  Active Std                   float32\n",
      " 72  Active Max                   int32  \n",
      " 73  Active Min                   int32  \n",
      " 74  Idle Mean                    float32\n",
      " 75  Idle Std                     float32\n",
      " 76  Idle Max                     int32  \n",
      " 77  Idle Min                     int32  \n",
      " 78  Attack Type                  object \n",
      "dtypes: float32(24), int32(52), int64(2), object(1)\n",
      "memory usage: 789.0+ MB\n"
     ]
    }
   ],
   "source": [
    "data.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d0ba2fbf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Destination Port</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>8.704762e+03</td>\n",
       "      <td>1.902507e+04</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>53.000000</td>\n",
       "      <td>80.000000</td>\n",
       "      <td>4.430000e+02</td>\n",
       "      <td>6.553500e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow Duration</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.658132e+07</td>\n",
       "      <td>3.522426e+07</td>\n",
       "      <td>-1.300000e+01</td>\n",
       "      <td>208.000000</td>\n",
       "      <td>50577.000000</td>\n",
       "      <td>5.329717e+06</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Total Fwd Packets</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.027627e+01</td>\n",
       "      <td>7.941738e+02</td>\n",
       "      <td>1.000000e+00</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>6.000000e+00</td>\n",
       "      <td>2.197590e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Total Backward Packets</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.156596e+01</td>\n",
       "      <td>1.056594e+03</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>5.000000e+00</td>\n",
       "      <td>2.919220e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Total Length of Fwd Packets</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>6.115751e+02</td>\n",
       "      <td>1.058499e+04</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>66.000000</td>\n",
       "      <td>3.320000e+02</td>\n",
       "      <td>1.290000e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Total Length of Bwd Packets</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.813315e+04</td>\n",
       "      <td>2.397434e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>155.000000</td>\n",
       "      <td>9.880000e+02</td>\n",
       "      <td>6.554530e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Packet Length Max</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.310918e+02</td>\n",
       "      <td>7.561625e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>40.000000</td>\n",
       "      <td>2.020000e+02</td>\n",
       "      <td>2.482000e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Packet Length Min</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.919464e+01</td>\n",
       "      <td>6.079447e+01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>3.700000e+01</td>\n",
       "      <td>2.325000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Packet Length Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>6.347011e+01</td>\n",
       "      <td>1.955015e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>36.111111</td>\n",
       "      <td>5.200000e+01</td>\n",
       "      <td>5.940857e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Packet Length Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>7.727759e+01</td>\n",
       "      <td>2.967953e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>7.413914e+01</td>\n",
       "      <td>7.125597e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Packet Length Max</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>9.743700e+02</td>\n",
       "      <td>2.037859e+03</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>97.000000</td>\n",
       "      <td>7.460000e+02</td>\n",
       "      <td>1.953000e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Packet Length Min</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>4.313467e+01</td>\n",
       "      <td>7.087022e+01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>8.200000e+01</td>\n",
       "      <td>2.896000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Packet Length Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.404132e+02</td>\n",
       "      <td>6.324238e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>88.000000</td>\n",
       "      <td>2.180000e+02</td>\n",
       "      <td>5.800500e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Packet Length Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.763118e+02</td>\n",
       "      <td>8.808314e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.624919e+02</td>\n",
       "      <td>8.194660e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow Bytes/s</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.409834e+06</td>\n",
       "      <td>2.656263e+07</td>\n",
       "      <td>-2.610000e+08</td>\n",
       "      <td>119.456785</td>\n",
       "      <td>3715.037842</td>\n",
       "      <td>1.068966e+05</td>\n",
       "      <td>2.071000e+09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow Packets/s</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>4.726260e+04</td>\n",
       "      <td>2.025771e+05</td>\n",
       "      <td>-2.000000e+06</td>\n",
       "      <td>2.030488</td>\n",
       "      <td>69.742241</td>\n",
       "      <td>1.785714e+04</td>\n",
       "      <td>4.000000e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow IAT Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.445246e+06</td>\n",
       "      <td>4.681883e+06</td>\n",
       "      <td>-1.300000e+01</td>\n",
       "      <td>83.000000</td>\n",
       "      <td>20425.333984</td>\n",
       "      <td>5.561159e+05</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow IAT Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.276120e+06</td>\n",
       "      <td>8.454525e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>12313.310547</td>\n",
       "      <td>1.489260e+06</td>\n",
       "      <td>8.480026e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow IAT Max</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.029310e+07</td>\n",
       "      <td>2.567868e+07</td>\n",
       "      <td>-1.300000e+01</td>\n",
       "      <td>176.000000</td>\n",
       "      <td>46474.000000</td>\n",
       "      <td>4.999418e+06</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flow IAT Min</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.703157e+05</td>\n",
       "      <td>3.013372e+06</td>\n",
       "      <td>-1.400000e+01</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>6.900000e+01</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd IAT Total</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.624176e+07</td>\n",
       "      <td>3.515781e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>49.000000</td>\n",
       "      <td>5.034750e+06</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd IAT Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.917447e+06</td>\n",
       "      <td>1.001355e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>49.000000</td>\n",
       "      <td>7.369323e+05</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd IAT Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.666366e+06</td>\n",
       "      <td>1.013934e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>5.663284e+05</td>\n",
       "      <td>8.460293e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd IAT Max</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.013665e+07</td>\n",
       "      <td>2.575975e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>49.000000</td>\n",
       "      <td>4.196692e+06</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd IAT Min</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.134967e+06</td>\n",
       "      <td>9.056733e+06</td>\n",
       "      <td>-1.200000e+01</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.900000e+01</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd IAT Total</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.110336e+07</td>\n",
       "      <td>3.022113e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.504400e+05</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd IAT Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.026477e+06</td>\n",
       "      <td>9.390609e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.969000e+04</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd IAT Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.667647e+06</td>\n",
       "      <td>6.628390e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.909109e+04</td>\n",
       "      <td>8.441802e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd IAT Max</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>5.257358e+06</td>\n",
       "      <td>1.809655e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.211090e+05</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd IAT Min</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.085438e+06</td>\n",
       "      <td>8.794528e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.700000e+01</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd PSH Flags</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>4.873805e-02</td>\n",
       "      <td>2.153199e-01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd PSH Flags</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd URG Flags</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.171630e-05</td>\n",
       "      <td>5.631635e-03</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd URG Flags</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Header Length</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>-2.918210e+04</td>\n",
       "      <td>2.230271e+07</td>\n",
       "      <td>-3.221223e+10</td>\n",
       "      <td>40.000000</td>\n",
       "      <td>64.000000</td>\n",
       "      <td>1.440000e+02</td>\n",
       "      <td>4.644908e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Header Length</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>-2.553644e+03</td>\n",
       "      <td>1.538422e+06</td>\n",
       "      <td>-1.073741e+09</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>40.000000</td>\n",
       "      <td>1.320000e+02</td>\n",
       "      <td>5.838440e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Packets/s</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>4.083436e+04</td>\n",
       "      <td>1.932083e+05</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.210475</td>\n",
       "      <td>37.900322</td>\n",
       "      <td>9.433962e+03</td>\n",
       "      <td>3.000000e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Packets/s</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>6.509475e+03</td>\n",
       "      <td>3.813312e+04</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.167651</td>\n",
       "      <td>19.129236</td>\n",
       "      <td>2.083333e+03</td>\n",
       "      <td>2.000000e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Min Packet Length</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.682349e+01</td>\n",
       "      <td>2.557873e+01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>3.700000e+01</td>\n",
       "      <td>1.448000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Max Packet Length</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.063098e+03</td>\n",
       "      <td>2.121197e+03</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>102.000000</td>\n",
       "      <td>1.106000e+03</td>\n",
       "      <td>2.482000e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Packet Length Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.905415e+02</td>\n",
       "      <td>3.182915e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>63.599998</td>\n",
       "      <td>1.553333e+02</td>\n",
       "      <td>3.337143e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Packet Length Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.299988e+02</td>\n",
       "      <td>6.607344e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>2.309401</td>\n",
       "      <td>32.331615</td>\n",
       "      <td>3.220810e+02</td>\n",
       "      <td>4.731522e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Packet Length Variance</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>5.454386e+05</td>\n",
       "      <td>1.735993e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>5.333333</td>\n",
       "      <td>1045.333374</td>\n",
       "      <td>1.037362e+05</td>\n",
       "      <td>2.240000e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>FIN Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.214685e-02</td>\n",
       "      <td>1.763900e-01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SYN Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>4.873805e-02</td>\n",
       "      <td>2.153199e-01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>RST Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.719673e-04</td>\n",
       "      <td>1.648919e-02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PSH Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.975192e-01</td>\n",
       "      <td>4.571669e-01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ACK Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.121875e-01</td>\n",
       "      <td>4.633860e-01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>URG Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.014276e-01</td>\n",
       "      <td>3.018941e-01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CWE Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.171630e-05</td>\n",
       "      <td>5.631635e-03</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>ECE Flag Count</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.731567e-04</td>\n",
       "      <td>1.652520e-02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Down/Up Ratio</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>7.003495e-01</td>\n",
       "      <td>6.955667e-01</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000e+00</td>\n",
       "      <td>1.560000e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Average Packet Size</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.123115e+02</td>\n",
       "      <td>3.454353e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>80.750000</td>\n",
       "      <td>1.796154e+02</td>\n",
       "      <td>3.893333e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Avg Fwd Segment Size</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>6.347011e+01</td>\n",
       "      <td>1.955015e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>36.111111</td>\n",
       "      <td>5.200000e+01</td>\n",
       "      <td>5.940857e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Avg Bwd Segment Size</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>3.404132e+02</td>\n",
       "      <td>6.324238e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>88.000000</td>\n",
       "      <td>2.180000e+02</td>\n",
       "      <td>5.800500e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Header Length.1</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>-2.918210e+04</td>\n",
       "      <td>2.230271e+07</td>\n",
       "      <td>-3.221223e+10</td>\n",
       "      <td>40.000000</td>\n",
       "      <td>64.000000</td>\n",
       "      <td>1.440000e+02</td>\n",
       "      <td>4.644908e+06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Avg Bytes/Bulk</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Avg Packets/Bulk</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fwd Avg Bulk Rate</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Avg Bytes/Bulk</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Avg Packets/Bulk</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bwd Avg Bulk Rate</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000e+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Subflow Fwd Packets</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.027627e+01</td>\n",
       "      <td>7.941738e+02</td>\n",
       "      <td>1.000000e+00</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>6.000000e+00</td>\n",
       "      <td>2.197590e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Subflow Fwd Bytes</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>6.115633e+02</td>\n",
       "      <td>1.057067e+04</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>12.000000</td>\n",
       "      <td>66.000000</td>\n",
       "      <td>3.320000e+02</td>\n",
       "      <td>1.287034e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Subflow Bwd Packets</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.156596e+01</td>\n",
       "      <td>1.056594e+03</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>5.000000e+00</td>\n",
       "      <td>2.919220e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Subflow Bwd Bytes</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.813277e+04</td>\n",
       "      <td>2.397401e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>155.000000</td>\n",
       "      <td>9.880000e+02</td>\n",
       "      <td>6.554530e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Init_Win_bytes_forward</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>7.265655e+03</td>\n",
       "      <td>1.459869e+04</td>\n",
       "      <td>-1.000000e+00</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>251.000000</td>\n",
       "      <td>8.192000e+03</td>\n",
       "      <td>6.553500e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Init_Win_bytes_backward</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>2.230826e+03</td>\n",
       "      <td>8.928420e+03</td>\n",
       "      <td>-1.000000e+00</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.350000e+02</td>\n",
       "      <td>6.553500e+04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>act_data_pkt_fwd</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>6.005904e+00</td>\n",
       "      <td>6.742059e+02</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>3.000000e+00</td>\n",
       "      <td>2.135570e+05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min_seg_size_forward</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>-3.080307e+03</td>\n",
       "      <td>1.149402e+06</td>\n",
       "      <td>-5.368707e+08</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>3.200000e+01</td>\n",
       "      <td>1.380000e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Active Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>9.152170e+04</td>\n",
       "      <td>6.864411e+05</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.100000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Active Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>4.616313e+04</td>\n",
       "      <td>4.164568e+05</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>7.420000e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Active Max</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>1.719104e+05</td>\n",
       "      <td>1.085243e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.100000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Active Min</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>6.542300e+04</td>\n",
       "      <td>6.109712e+05</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.100000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Idle Mean</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>9.331577e+06</td>\n",
       "      <td>2.484157e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Idle Std</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>5.654432e+05</td>\n",
       "      <td>4.872678e+06</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>7.690000e+07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Idle Max</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>9.757716e+06</td>\n",
       "      <td>2.561067e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Idle Min</th>\n",
       "      <td>2522362.0</td>\n",
       "      <td>8.887157e+06</td>\n",
       "      <td>2.457481e+07</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1.200000e+08</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 count          mean           std  \\\n",
       "Destination Port             2522362.0  8.704762e+03  1.902507e+04   \n",
       "Flow Duration                2522362.0  1.658132e+07  3.522426e+07   \n",
       "Total Fwd Packets            2522362.0  1.027627e+01  7.941738e+02   \n",
       "Total Backward Packets       2522362.0  1.156596e+01  1.056594e+03   \n",
       "Total Length of Fwd Packets  2522362.0  6.115751e+02  1.058499e+04   \n",
       "Total Length of Bwd Packets  2522362.0  1.813315e+04  2.397434e+06   \n",
       "Fwd Packet Length Max        2522362.0  2.310918e+02  7.561625e+02   \n",
       "Fwd Packet Length Min        2522362.0  1.919464e+01  6.079447e+01   \n",
       "Fwd Packet Length Mean       2522362.0  6.347011e+01  1.955015e+02   \n",
       "Fwd Packet Length Std        2522362.0  7.727759e+01  2.967953e+02   \n",
       "Bwd Packet Length Max        2522362.0  9.743700e+02  2.037859e+03   \n",
       "Bwd Packet Length Min        2522362.0  4.313467e+01  7.087022e+01   \n",
       "Bwd Packet Length Mean       2522362.0  3.404132e+02  6.324238e+02   \n",
       "Bwd Packet Length Std        2522362.0  3.763118e+02  8.808314e+02   \n",
       "Flow Bytes/s                 2522362.0  1.409834e+06  2.656263e+07   \n",
       "Flow Packets/s               2522362.0  4.726260e+04  2.025771e+05   \n",
       "Flow IAT Mean                2522362.0  1.445246e+06  4.681883e+06   \n",
       "Flow IAT Std                 2522362.0  3.276120e+06  8.454525e+06   \n",
       "Flow IAT Max                 2522362.0  1.029310e+07  2.567868e+07   \n",
       "Flow IAT Min                 2522362.0  1.703157e+05  3.013372e+06   \n",
       "Fwd IAT Total                2522362.0  1.624176e+07  3.515781e+07   \n",
       "Fwd IAT Mean                 2522362.0  2.917447e+06  1.001355e+07   \n",
       "Fwd IAT Std                  2522362.0  3.666366e+06  1.013934e+07   \n",
       "Fwd IAT Max                  2522362.0  1.013665e+07  2.575975e+07   \n",
       "Fwd IAT Min                  2522362.0  1.134967e+06  9.056733e+06   \n",
       "Bwd IAT Total                2522362.0  1.110336e+07  3.022113e+07   \n",
       "Bwd IAT Mean                 2522362.0  2.026477e+06  9.390609e+06   \n",
       "Bwd IAT Std                  2522362.0  1.667647e+06  6.628390e+06   \n",
       "Bwd IAT Max                  2522362.0  5.257358e+06  1.809655e+07   \n",
       "Bwd IAT Min                  2522362.0  1.085438e+06  8.794528e+06   \n",
       "Fwd PSH Flags                2522362.0  4.873805e-02  2.153199e-01   \n",
       "Bwd PSH Flags                2522362.0  0.000000e+00  0.000000e+00   \n",
       "Fwd URG Flags                2522362.0  3.171630e-05  5.631635e-03   \n",
       "Bwd URG Flags                2522362.0  0.000000e+00  0.000000e+00   \n",
       "Fwd Header Length            2522362.0 -2.918210e+04  2.230271e+07   \n",
       "Bwd Header Length            2522362.0 -2.553644e+03  1.538422e+06   \n",
       "Fwd Packets/s                2522362.0  4.083436e+04  1.932083e+05   \n",
       "Bwd Packets/s                2522362.0  6.509475e+03  3.813312e+04   \n",
       "Min Packet Length            2522362.0  1.682349e+01  2.557873e+01   \n",
       "Max Packet Length            2522362.0  1.063098e+03  2.121197e+03   \n",
       "Packet Length Mean           2522362.0  1.905415e+02  3.182915e+02   \n",
       "Packet Length Std            2522362.0  3.299988e+02  6.607344e+02   \n",
       "Packet Length Variance       2522362.0  5.454386e+05  1.735993e+06   \n",
       "FIN Flag Count               2522362.0  3.214685e-02  1.763900e-01   \n",
       "SYN Flag Count               2522362.0  4.873805e-02  2.153199e-01   \n",
       "RST Flag Count               2522362.0  2.719673e-04  1.648919e-02   \n",
       "PSH Flag Count               2522362.0  2.975192e-01  4.571669e-01   \n",
       "ACK Flag Count               2522362.0  3.121875e-01  4.633860e-01   \n",
       "URG Flag Count               2522362.0  1.014276e-01  3.018941e-01   \n",
       "CWE Flag Count               2522362.0  3.171630e-05  5.631635e-03   \n",
       "ECE Flag Count               2522362.0  2.731567e-04  1.652520e-02   \n",
       "Down/Up Ratio                2522362.0  7.003495e-01  6.955667e-01   \n",
       "Average Packet Size          2522362.0  2.123115e+02  3.454353e+02   \n",
       "Avg Fwd Segment Size         2522362.0  6.347011e+01  1.955015e+02   \n",
       "Avg Bwd Segment Size         2522362.0  3.404132e+02  6.324238e+02   \n",
       "Fwd Header Length.1          2522362.0 -2.918210e+04  2.230271e+07   \n",
       "Fwd Avg Bytes/Bulk           2522362.0  0.000000e+00  0.000000e+00   \n",
       "Fwd Avg Packets/Bulk         2522362.0  0.000000e+00  0.000000e+00   \n",
       "Fwd Avg Bulk Rate            2522362.0  0.000000e+00  0.000000e+00   \n",
       "Bwd Avg Bytes/Bulk           2522362.0  0.000000e+00  0.000000e+00   \n",
       "Bwd Avg Packets/Bulk         2522362.0  0.000000e+00  0.000000e+00   \n",
       "Bwd Avg Bulk Rate            2522362.0  0.000000e+00  0.000000e+00   \n",
       "Subflow Fwd Packets          2522362.0  1.027627e+01  7.941738e+02   \n",
       "Subflow Fwd Bytes            2522362.0  6.115633e+02  1.057067e+04   \n",
       "Subflow Bwd Packets          2522362.0  1.156596e+01  1.056594e+03   \n",
       "Subflow Bwd Bytes            2522362.0  1.813277e+04  2.397401e+06   \n",
       "Init_Win_bytes_forward       2522362.0  7.265655e+03  1.459869e+04   \n",
       "Init_Win_bytes_backward      2522362.0  2.230826e+03  8.928420e+03   \n",
       "act_data_pkt_fwd             2522362.0  6.005904e+00  6.742059e+02   \n",
       "min_seg_size_forward         2522362.0 -3.080307e+03  1.149402e+06   \n",
       "Active Mean                  2522362.0  9.152170e+04  6.864411e+05   \n",
       "Active Std                   2522362.0  4.616313e+04  4.164568e+05   \n",
       "Active Max                   2522362.0  1.719104e+05  1.085243e+06   \n",
       "Active Min                   2522362.0  6.542300e+04  6.109712e+05   \n",
       "Idle Mean                    2522362.0  9.331577e+06  2.484157e+07   \n",
       "Idle Std                     2522362.0  5.654432e+05  4.872678e+06   \n",
       "Idle Max                     2522362.0  9.757716e+06  2.561067e+07   \n",
       "Idle Min                     2522362.0  8.887157e+06  2.457481e+07   \n",
       "\n",
       "                                      min         25%           50%  \\\n",
       "Destination Port             0.000000e+00   53.000000     80.000000   \n",
       "Flow Duration               -1.300000e+01  208.000000  50577.000000   \n",
       "Total Fwd Packets            1.000000e+00    2.000000      2.000000   \n",
       "Total Backward Packets       0.000000e+00    1.000000      2.000000   \n",
       "Total Length of Fwd Packets  0.000000e+00   12.000000     66.000000   \n",
       "Total Length of Bwd Packets  0.000000e+00    6.000000    155.000000   \n",
       "Fwd Packet Length Max        0.000000e+00    6.000000     40.000000   \n",
       "Fwd Packet Length Min        0.000000e+00    0.000000      2.000000   \n",
       "Fwd Packet Length Mean       0.000000e+00    6.000000     36.111111   \n",
       "Fwd Packet Length Std        0.000000e+00    0.000000      0.000000   \n",
       "Bwd Packet Length Max        0.000000e+00    6.000000     97.000000   \n",
       "Bwd Packet Length Min        0.000000e+00    0.000000      0.000000   \n",
       "Bwd Packet Length Mean       0.000000e+00    6.000000     88.000000   \n",
       "Bwd Packet Length Std        0.000000e+00    0.000000      0.000000   \n",
       "Flow Bytes/s                -2.610000e+08  119.456785   3715.037842   \n",
       "Flow Packets/s              -2.000000e+06    2.030488     69.742241   \n",
       "Flow IAT Mean               -1.300000e+01   83.000000  20425.333984   \n",
       "Flow IAT Std                 0.000000e+00    0.000000  12313.310547   \n",
       "Flow IAT Max                -1.300000e+01  176.000000  46474.000000   \n",
       "Flow IAT Min                -1.400000e+01    3.000000      4.000000   \n",
       "Fwd IAT Total                0.000000e+00    1.000000     49.000000   \n",
       "Fwd IAT Mean                 0.000000e+00    1.000000     49.000000   \n",
       "Fwd IAT Std                  0.000000e+00    0.000000      0.000000   \n",
       "Fwd IAT Max                  0.000000e+00    1.000000     49.000000   \n",
       "Fwd IAT Min                 -1.200000e+01    0.000000      3.000000   \n",
       "Bwd IAT Total                0.000000e+00    0.000000      3.000000   \n",
       "Bwd IAT Mean                 0.000000e+00    0.000000      3.000000   \n",
       "Bwd IAT Std                  0.000000e+00    0.000000      0.000000   \n",
       "Bwd IAT Max                  0.000000e+00    0.000000      3.000000   \n",
       "Bwd IAT Min                  0.000000e+00    0.000000      3.000000   \n",
       "Fwd PSH Flags                0.000000e+00    0.000000      0.000000   \n",
       "Bwd PSH Flags                0.000000e+00    0.000000      0.000000   \n",
       "Fwd URG Flags                0.000000e+00    0.000000      0.000000   \n",
       "Bwd URG Flags                0.000000e+00    0.000000      0.000000   \n",
       "Fwd Header Length           -3.221223e+10   40.000000     64.000000   \n",
       "Bwd Header Length           -1.073741e+09   20.000000     40.000000   \n",
       "Fwd Packets/s                0.000000e+00    1.210475     37.900322   \n",
       "Bwd Packets/s                0.000000e+00    0.167651     19.129236   \n",
       "Min Packet Length            0.000000e+00    0.000000      2.000000   \n",
       "Max Packet Length            0.000000e+00    6.000000    102.000000   \n",
       "Packet Length Mean           0.000000e+00    6.000000     63.599998   \n",
       "Packet Length Std            0.000000e+00    2.309401     32.331615   \n",
       "Packet Length Variance       0.000000e+00    5.333333   1045.333374   \n",
       "FIN Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "SYN Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "RST Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "PSH Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "ACK Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "URG Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "CWE Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "ECE Flag Count               0.000000e+00    0.000000      0.000000   \n",
       "Down/Up Ratio                0.000000e+00    0.000000      1.000000   \n",
       "Average Packet Size          0.000000e+00    9.000000     80.750000   \n",
       "Avg Fwd Segment Size         0.000000e+00    6.000000     36.111111   \n",
       "Avg Bwd Segment Size         0.000000e+00    6.000000     88.000000   \n",
       "Fwd Header Length.1         -3.221223e+10   40.000000     64.000000   \n",
       "Fwd Avg Bytes/Bulk           0.000000e+00    0.000000      0.000000   \n",
       "Fwd Avg Packets/Bulk         0.000000e+00    0.000000      0.000000   \n",
       "Fwd Avg Bulk Rate            0.000000e+00    0.000000      0.000000   \n",
       "Bwd Avg Bytes/Bulk           0.000000e+00    0.000000      0.000000   \n",
       "Bwd Avg Packets/Bulk         0.000000e+00    0.000000      0.000000   \n",
       "Bwd Avg Bulk Rate            0.000000e+00    0.000000      0.000000   \n",
       "Subflow Fwd Packets          1.000000e+00    2.000000      2.000000   \n",
       "Subflow Fwd Bytes            0.000000e+00   12.000000     66.000000   \n",
       "Subflow Bwd Packets          0.000000e+00    1.000000      2.000000   \n",
       "Subflow Bwd Bytes            0.000000e+00    6.000000    155.000000   \n",
       "Init_Win_bytes_forward      -1.000000e+00   -1.000000    251.000000   \n",
       "Init_Win_bytes_backward     -1.000000e+00   -1.000000      0.000000   \n",
       "act_data_pkt_fwd             0.000000e+00    0.000000      1.000000   \n",
       "min_seg_size_forward        -5.368707e+08   20.000000     20.000000   \n",
       "Active Mean                  0.000000e+00    0.000000      0.000000   \n",
       "Active Std                   0.000000e+00    0.000000      0.000000   \n",
       "Active Max                   0.000000e+00    0.000000      0.000000   \n",
       "Active Min                   0.000000e+00    0.000000      0.000000   \n",
       "Idle Mean                    0.000000e+00    0.000000      0.000000   \n",
       "Idle Std                     0.000000e+00    0.000000      0.000000   \n",
       "Idle Max                     0.000000e+00    0.000000      0.000000   \n",
       "Idle Min                     0.000000e+00    0.000000      0.000000   \n",
       "\n",
       "                                      75%           max  \n",
       "Destination Port             4.430000e+02  6.553500e+04  \n",
       "Flow Duration                5.329717e+06  1.200000e+08  \n",
       "Total Fwd Packets            6.000000e+00  2.197590e+05  \n",
       "Total Backward Packets       5.000000e+00  2.919220e+05  \n",
       "Total Length of Fwd Packets  3.320000e+02  1.290000e+07  \n",
       "Total Length of Bwd Packets  9.880000e+02  6.554530e+08  \n",
       "Fwd Packet Length Max        2.020000e+02  2.482000e+04  \n",
       "Fwd Packet Length Min        3.700000e+01  2.325000e+03  \n",
       "Fwd Packet Length Mean       5.200000e+01  5.940857e+03  \n",
       "Fwd Packet Length Std        7.413914e+01  7.125597e+03  \n",
       "Bwd Packet Length Max        7.460000e+02  1.953000e+04  \n",
       "Bwd Packet Length Min        8.200000e+01  2.896000e+03  \n",
       "Bwd Packet Length Mean       2.180000e+02  5.800500e+03  \n",
       "Bwd Packet Length Std        2.624919e+02  8.194660e+03  \n",
       "Flow Bytes/s                 1.068966e+05  2.071000e+09  \n",
       "Flow Packets/s               1.785714e+04  4.000000e+06  \n",
       "Flow IAT Mean                5.561159e+05  1.200000e+08  \n",
       "Flow IAT Std                 1.489260e+06  8.480026e+07  \n",
       "Flow IAT Max                 4.999418e+06  1.200000e+08  \n",
       "Flow IAT Min                 6.900000e+01  1.200000e+08  \n",
       "Fwd IAT Total                5.034750e+06  1.200000e+08  \n",
       "Fwd IAT Mean                 7.369323e+05  1.200000e+08  \n",
       "Fwd IAT Std                  5.663284e+05  8.460293e+07  \n",
       "Fwd IAT Max                  4.196692e+06  1.200000e+08  \n",
       "Fwd IAT Min                  4.900000e+01  1.200000e+08  \n",
       "Bwd IAT Total                1.504400e+05  1.200000e+08  \n",
       "Bwd IAT Mean                 2.969000e+04  1.200000e+08  \n",
       "Bwd IAT Std                  2.909109e+04  8.441802e+07  \n",
       "Bwd IAT Max                  1.211090e+05  1.200000e+08  \n",
       "Bwd IAT Min                  4.700000e+01  1.200000e+08  \n",
       "Fwd PSH Flags                0.000000e+00  1.000000e+00  \n",
       "Bwd PSH Flags                0.000000e+00  0.000000e+00  \n",
       "Fwd URG Flags                0.000000e+00  1.000000e+00  \n",
       "Bwd URG Flags                0.000000e+00  0.000000e+00  \n",
       "Fwd Header Length            1.440000e+02  4.644908e+06  \n",
       "Bwd Header Length            1.320000e+02  5.838440e+06  \n",
       "Fwd Packets/s                9.433962e+03  3.000000e+06  \n",
       "Bwd Packets/s                2.083333e+03  2.000000e+06  \n",
       "Min Packet Length            3.700000e+01  1.448000e+03  \n",
       "Max Packet Length            1.106000e+03  2.482000e+04  \n",
       "Packet Length Mean           1.553333e+02  3.337143e+03  \n",
       "Packet Length Std            3.220810e+02  4.731522e+03  \n",
       "Packet Length Variance       1.037362e+05  2.240000e+07  \n",
       "FIN Flag Count               0.000000e+00  1.000000e+00  \n",
       "SYN Flag Count               0.000000e+00  1.000000e+00  \n",
       "RST Flag Count               0.000000e+00  1.000000e+00  \n",
       "PSH Flag Count               1.000000e+00  1.000000e+00  \n",
       "ACK Flag Count               1.000000e+00  1.000000e+00  \n",
       "URG Flag Count               0.000000e+00  1.000000e+00  \n",
       "CWE Flag Count               0.000000e+00  1.000000e+00  \n",
       "ECE Flag Count               0.000000e+00  1.000000e+00  \n",
       "Down/Up Ratio                1.000000e+00  1.560000e+02  \n",
       "Average Packet Size          1.796154e+02  3.893333e+03  \n",
       "Avg Fwd Segment Size         5.200000e+01  5.940857e+03  \n",
       "Avg Bwd Segment Size         2.180000e+02  5.800500e+03  \n",
       "Fwd Header Length.1          1.440000e+02  4.644908e+06  \n",
       "Fwd Avg Bytes/Bulk           0.000000e+00  0.000000e+00  \n",
       "Fwd Avg Packets/Bulk         0.000000e+00  0.000000e+00  \n",
       "Fwd Avg Bulk Rate            0.000000e+00  0.000000e+00  \n",
       "Bwd Avg Bytes/Bulk           0.000000e+00  0.000000e+00  \n",
       "Bwd Avg Packets/Bulk         0.000000e+00  0.000000e+00  \n",
       "Bwd Avg Bulk Rate            0.000000e+00  0.000000e+00  \n",
       "Subflow Fwd Packets          6.000000e+00  2.197590e+05  \n",
       "Subflow Fwd Bytes            3.320000e+02  1.287034e+07  \n",
       "Subflow Bwd Packets          5.000000e+00  2.919220e+05  \n",
       "Subflow Bwd Bytes            9.880000e+02  6.554530e+08  \n",
       "Init_Win_bytes_forward       8.192000e+03  6.553500e+04  \n",
       "Init_Win_bytes_backward      2.350000e+02  6.553500e+04  \n",
       "act_data_pkt_fwd             3.000000e+00  2.135570e+05  \n",
       "min_seg_size_forward         3.200000e+01  1.380000e+02  \n",
       "Active Mean                  0.000000e+00  1.100000e+08  \n",
       "Active Std                   0.000000e+00  7.420000e+07  \n",
       "Active Max                   0.000000e+00  1.100000e+08  \n",
       "Active Min                   0.000000e+00  1.100000e+08  \n",
       "Idle Mean                    0.000000e+00  1.200000e+08  \n",
       "Idle Std                     0.000000e+00  7.690000e+07  \n",
       "Idle Max                     0.000000e+00  1.200000e+08  \n",
       "Idle Min                     0.000000e+00  1.200000e+08  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.options.display.max_rows = 80\n",
    "\n",
    "data.describe().transpose()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "541489fa",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Dropped columns:\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Index(['Bwd PSH Flags', 'Bwd URG Flags', 'Fwd Avg Bytes/Bulk',\n",
       "       'Fwd Avg Packets/Bulk', 'Fwd Avg Bulk Rate', 'Bwd Avg Bytes/Bulk',\n",
       "       'Bwd Avg Packets/Bulk', 'Bwd Avg Bulk Rate'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Dropping columns with only one unique value\n",
    "num_unique = data.nunique()\n",
    "one_variable = num_unique[num_unique == 1]\n",
    "not_one_variable = num_unique[num_unique > 1].index\n",
    "\n",
    "dropped_cols = one_variable.index\n",
    "data = data[not_one_variable]\n",
    "\n",
    "print('Dropped columns:')\n",
    "dropped_cols"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "a8613c43",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2522362, 71)"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "70fd0e97",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Destination Port', 'Flow Duration', 'Total Fwd Packets',\n",
       "       'Total Backward Packets', 'Total Length of Fwd Packets',\n",
       "       'Total Length of Bwd Packets', 'Fwd Packet Length Max',\n",
       "       'Fwd Packet Length Min', 'Fwd Packet Length Mean',\n",
       "       'Fwd Packet Length Std', 'Bwd Packet Length Max',\n",
       "       'Bwd Packet Length Min', 'Bwd Packet Length Mean',\n",
       "       'Bwd Packet Length Std', 'Flow Bytes/s', 'Flow Packets/s',\n",
       "       'Flow IAT Mean', 'Flow IAT Std', 'Flow IAT Max', 'Flow IAT Min',\n",
       "       'Fwd IAT Total', 'Fwd IAT Mean', 'Fwd IAT Std', 'Fwd IAT Max',\n",
       "       'Fwd IAT Min', 'Bwd IAT Total', 'Bwd IAT Mean', 'Bwd IAT Std',\n",
       "       'Bwd IAT Max', 'Bwd IAT Min', 'Fwd PSH Flags', 'Fwd URG Flags',\n",
       "       'Fwd Header Length', 'Bwd Header Length', 'Fwd Packets/s',\n",
       "       'Bwd Packets/s', 'Min Packet Length', 'Max Packet Length',\n",
       "       'Packet Length Mean', 'Packet Length Std', 'Packet Length Variance',\n",
       "       'FIN Flag Count', 'SYN Flag Count', 'RST Flag Count', 'PSH Flag Count',\n",
       "       'ACK Flag Count', 'URG Flag Count', 'CWE Flag Count', 'ECE Flag Count',\n",
       "       'Down/Up Ratio', 'Average Packet Size', 'Avg Fwd Segment Size',\n",
       "       'Avg Bwd Segment Size', 'Fwd Header Length.1', 'Subflow Fwd Packets',\n",
       "       'Subflow Fwd Bytes', 'Subflow Bwd Packets', 'Subflow Bwd Bytes',\n",
       "       'Init_Win_bytes_forward', 'Init_Win_bytes_backward', 'act_data_pkt_fwd',\n",
       "       'min_seg_size_forward', 'Active Mean', 'Active Std', 'Active Max',\n",
       "       'Active Min', 'Idle Mean', 'Idle Std', 'Idle Max', 'Idle Min',\n",
       "       'Attack Type'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Columns after removing non variant columns\n",
    "data.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d3eba49",
   "metadata": {},
   "source": [
    "- To improve performance and reduce the risk of memory-related errors (mostly session crashes), we downcasted the float and integer values based on the presence of the minimum and maximum values and reduced memory usage by 48.10%.\n",
    "\n",
    "- The columns with zero standard deviation have the same value in all rows. These columns don't have any variance. It simply means that there is no meaningful relationship with any other columns. These columns cannot help differentiate between the classes or groups of data. So, we dropped the columns that have no variation."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bf046c29",
   "metadata": {},
   "source": [
    "### - Applying PCA to reduce dimensions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "29c452a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Standardizing the dataset\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "features = data.drop('Attack Type', axis = 1)\n",
    "attacks = data['Attack Type']\n",
    "\n",
    "scaler = StandardScaler()\n",
    "scaled_features = scaler.fit_transform(features)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "31d17863",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "information retained: 99.30%\n"
     ]
    }
   ],
   "source": [
    "from sklearn.decomposition import IncrementalPCA\n",
    "\n",
    "size = len(features.columns) // 2\n",
    "ipca = IncrementalPCA(n_components = size, batch_size = 500)\n",
    "for batch in np.array_split(scaled_features, len(features) // 500):\n",
    "    ipca.partial_fit(batch)\n",
    "\n",
    "print(f'information retained: {sum(ipca.explained_variance_ratio_):.2%}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "9fb792b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "transformed_features = ipca.transform(scaled_features)\n",
    "new_data = pd.DataFrame(transformed_features, columns = [f'PC{i+1}' for i in range(size)])\n",
    "new_data['Attack Type'] = attacks.values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "ae968354",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PC1</th>\n",
       "      <th>PC2</th>\n",
       "      <th>PC3</th>\n",
       "      <th>PC4</th>\n",
       "      <th>PC5</th>\n",
       "      <th>PC6</th>\n",
       "      <th>PC7</th>\n",
       "      <th>PC8</th>\n",
       "      <th>PC9</th>\n",
       "      <th>PC10</th>\n",
       "      <th>...</th>\n",
       "      <th>PC27</th>\n",
       "      <th>PC28</th>\n",
       "      <th>PC29</th>\n",
       "      <th>PC30</th>\n",
       "      <th>PC31</th>\n",
       "      <th>PC32</th>\n",
       "      <th>PC33</th>\n",
       "      <th>PC34</th>\n",
       "      <th>PC35</th>\n",
       "      <th>Attack Type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-2.357605</td>\n",
       "      <td>-0.054980</td>\n",
       "      <td>0.577358</td>\n",
       "      <td>0.734455</td>\n",
       "      <td>3.730369</td>\n",
       "      <td>0.234640</td>\n",
       "      <td>-0.015693</td>\n",
       "      <td>-0.215545</td>\n",
       "      <td>-0.278475</td>\n",
       "      <td>1.087286</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.147894</td>\n",
       "      <td>-0.333394</td>\n",
       "      <td>1.488435</td>\n",
       "      <td>-0.161748</td>\n",
       "      <td>-0.219747</td>\n",
       "      <td>-0.004607</td>\n",
       "      <td>0.002601</td>\n",
       "      <td>0.033419</td>\n",
       "      <td>-0.014938</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-2.883854</td>\n",
       "      <td>-0.069937</td>\n",
       "      <td>0.911302</td>\n",
       "      <td>1.763146</td>\n",
       "      <td>8.846136</td>\n",
       "      <td>0.620416</td>\n",
       "      <td>-0.056856</td>\n",
       "      <td>1.106617</td>\n",
       "      <td>1.906468</td>\n",
       "      <td>-2.756465</td>\n",
       "      <td>...</td>\n",
       "      <td>0.281532</td>\n",
       "      <td>-2.345995</td>\n",
       "      <td>2.240347</td>\n",
       "      <td>-0.638463</td>\n",
       "      <td>-0.371135</td>\n",
       "      <td>0.010602</td>\n",
       "      <td>0.000644</td>\n",
       "      <td>0.126258</td>\n",
       "      <td>-0.189626</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>-2.416928</td>\n",
       "      <td>-0.056683</td>\n",
       "      <td>0.615325</td>\n",
       "      <td>0.850870</td>\n",
       "      <td>4.304212</td>\n",
       "      <td>0.275767</td>\n",
       "      <td>-0.020437</td>\n",
       "      <td>-0.070482</td>\n",
       "      <td>-0.035276</td>\n",
       "      <td>0.664176</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.101765</td>\n",
       "      <td>-0.544543</td>\n",
       "      <td>1.572782</td>\n",
       "      <td>-0.211976</td>\n",
       "      <td>-0.235381</td>\n",
       "      <td>-0.003066</td>\n",
       "      <td>0.002394</td>\n",
       "      <td>0.043401</td>\n",
       "      <td>-0.034325</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>-2.884704</td>\n",
       "      <td>-0.069978</td>\n",
       "      <td>0.912164</td>\n",
       "      <td>1.765263</td>\n",
       "      <td>8.851561</td>\n",
       "      <td>0.618679</td>\n",
       "      <td>-0.057025</td>\n",
       "      <td>1.104773</td>\n",
       "      <td>1.906895</td>\n",
       "      <td>-2.752492</td>\n",
       "      <td>...</td>\n",
       "      <td>0.279947</td>\n",
       "      <td>-2.333522</td>\n",
       "      <td>2.241149</td>\n",
       "      <td>-0.635723</td>\n",
       "      <td>-0.369948</td>\n",
       "      <td>0.010453</td>\n",
       "      <td>0.000654</td>\n",
       "      <td>0.125925</td>\n",
       "      <td>-0.189603</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>-1.505246</td>\n",
       "      <td>0.080886</td>\n",
       "      <td>-0.504397</td>\n",
       "      <td>0.290405</td>\n",
       "      <td>-0.539263</td>\n",
       "      <td>0.746109</td>\n",
       "      <td>0.100443</td>\n",
       "      <td>0.732424</td>\n",
       "      <td>-1.145808</td>\n",
       "      <td>-0.563201</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.598921</td>\n",
       "      <td>0.116433</td>\n",
       "      <td>0.794828</td>\n",
       "      <td>-0.208920</td>\n",
       "      <td>0.039939</td>\n",
       "      <td>-0.014041</td>\n",
       "      <td>0.000980</td>\n",
       "      <td>-0.049437</td>\n",
       "      <td>-0.001124</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522357</th>\n",
       "      <td>2.178257</td>\n",
       "      <td>0.488156</td>\n",
       "      <td>-4.526435</td>\n",
       "      <td>-0.924940</td>\n",
       "      <td>-0.730370</td>\n",
       "      <td>0.041666</td>\n",
       "      <td>0.126066</td>\n",
       "      <td>2.523847</td>\n",
       "      <td>-0.216704</td>\n",
       "      <td>-0.206062</td>\n",
       "      <td>...</td>\n",
       "      <td>0.321896</td>\n",
       "      <td>0.518604</td>\n",
       "      <td>-0.024131</td>\n",
       "      <td>-0.644609</td>\n",
       "      <td>-1.450193</td>\n",
       "      <td>0.084712</td>\n",
       "      <td>0.000039</td>\n",
       "      <td>-0.077264</td>\n",
       "      <td>0.303285</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522358</th>\n",
       "      <td>1.731368</td>\n",
       "      <td>0.460769</td>\n",
       "      <td>-4.054541</td>\n",
       "      <td>-0.770272</td>\n",
       "      <td>-0.777757</td>\n",
       "      <td>0.114564</td>\n",
       "      <td>0.125233</td>\n",
       "      <td>2.346295</td>\n",
       "      <td>-0.328230</td>\n",
       "      <td>-0.250994</td>\n",
       "      <td>...</td>\n",
       "      <td>0.335223</td>\n",
       "      <td>0.589274</td>\n",
       "      <td>-0.012050</td>\n",
       "      <td>-0.729908</td>\n",
       "      <td>-1.600768</td>\n",
       "      <td>0.107229</td>\n",
       "      <td>-0.000361</td>\n",
       "      <td>0.060156</td>\n",
       "      <td>0.186588</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522359</th>\n",
       "      <td>2.642674</td>\n",
       "      <td>0.619094</td>\n",
       "      <td>-5.035304</td>\n",
       "      <td>-1.098158</td>\n",
       "      <td>-0.725546</td>\n",
       "      <td>-0.086071</td>\n",
       "      <td>0.125362</td>\n",
       "      <td>2.752021</td>\n",
       "      <td>-0.022972</td>\n",
       "      <td>-0.202706</td>\n",
       "      <td>...</td>\n",
       "      <td>0.405668</td>\n",
       "      <td>0.714635</td>\n",
       "      <td>-0.058023</td>\n",
       "      <td>-0.932889</td>\n",
       "      <td>-2.075104</td>\n",
       "      <td>0.122933</td>\n",
       "      <td>-0.000099</td>\n",
       "      <td>0.085239</td>\n",
       "      <td>0.239972</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522360</th>\n",
       "      <td>1.725979</td>\n",
       "      <td>0.468282</td>\n",
       "      <td>-4.066628</td>\n",
       "      <td>-0.770341</td>\n",
       "      <td>-0.777157</td>\n",
       "      <td>0.107913</td>\n",
       "      <td>0.125125</td>\n",
       "      <td>2.356053</td>\n",
       "      <td>-0.317138</td>\n",
       "      <td>-0.254798</td>\n",
       "      <td>...</td>\n",
       "      <td>0.347547</td>\n",
       "      <td>0.611648</td>\n",
       "      <td>-0.012535</td>\n",
       "      <td>-0.758092</td>\n",
       "      <td>-1.661729</td>\n",
       "      <td>0.110680</td>\n",
       "      <td>-0.000353</td>\n",
       "      <td>0.072124</td>\n",
       "      <td>0.184674</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2522361</th>\n",
       "      <td>1.718994</td>\n",
       "      <td>0.455801</td>\n",
       "      <td>-4.056730</td>\n",
       "      <td>-0.752914</td>\n",
       "      <td>-0.778815</td>\n",
       "      <td>0.105424</td>\n",
       "      <td>0.125243</td>\n",
       "      <td>2.351116</td>\n",
       "      <td>-0.325989</td>\n",
       "      <td>-0.250643</td>\n",
       "      <td>...</td>\n",
       "      <td>0.336674</td>\n",
       "      <td>0.590637</td>\n",
       "      <td>-0.012795</td>\n",
       "      <td>-0.730906</td>\n",
       "      <td>-1.606039</td>\n",
       "      <td>0.108408</td>\n",
       "      <td>-0.000360</td>\n",
       "      <td>0.067885</td>\n",
       "      <td>0.181076</td>\n",
       "      <td>BENIGN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2522362 rows Ã— 36 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              PC1       PC2       PC3       PC4       PC5       PC6       PC7  \\\n",
       "0       -2.357605 -0.054980  0.577358  0.734455  3.730369  0.234640 -0.015693   \n",
       "1       -2.883854 -0.069937  0.911302  1.763146  8.846136  0.620416 -0.056856   \n",
       "2       -2.416928 -0.056683  0.615325  0.850870  4.304212  0.275767 -0.020437   \n",
       "3       -2.884704 -0.069978  0.912164  1.765263  8.851561  0.618679 -0.057025   \n",
       "4       -1.505246  0.080886 -0.504397  0.290405 -0.539263  0.746109  0.100443   \n",
       "...           ...       ...       ...       ...       ...       ...       ...   \n",
       "2522357  2.178257  0.488156 -4.526435 -0.924940 -0.730370  0.041666  0.126066   \n",
       "2522358  1.731368  0.460769 -4.054541 -0.770272 -0.777757  0.114564  0.125233   \n",
       "2522359  2.642674  0.619094 -5.035304 -1.098158 -0.725546 -0.086071  0.125362   \n",
       "2522360  1.725979  0.468282 -4.066628 -0.770341 -0.777157  0.107913  0.125125   \n",
       "2522361  1.718994  0.455801 -4.056730 -0.752914 -0.778815  0.105424  0.125243   \n",
       "\n",
       "              PC8       PC9      PC10  ...      PC27      PC28      PC29  \\\n",
       "0       -0.215545 -0.278475  1.087286  ... -0.147894 -0.333394  1.488435   \n",
       "1        1.106617  1.906468 -2.756465  ...  0.281532 -2.345995  2.240347   \n",
       "2       -0.070482 -0.035276  0.664176  ... -0.101765 -0.544543  1.572782   \n",
       "3        1.104773  1.906895 -2.752492  ...  0.279947 -2.333522  2.241149   \n",
       "4        0.732424 -1.145808 -0.563201  ... -0.598921  0.116433  0.794828   \n",
       "...           ...       ...       ...  ...       ...       ...       ...   \n",
       "2522357  2.523847 -0.216704 -0.206062  ...  0.321896  0.518604 -0.024131   \n",
       "2522358  2.346295 -0.328230 -0.250994  ...  0.335223  0.589274 -0.012050   \n",
       "2522359  2.752021 -0.022972 -0.202706  ...  0.405668  0.714635 -0.058023   \n",
       "2522360  2.356053 -0.317138 -0.254798  ...  0.347547  0.611648 -0.012535   \n",
       "2522361  2.351116 -0.325989 -0.250643  ...  0.336674  0.590637 -0.012795   \n",
       "\n",
       "             PC30      PC31      PC32      PC33      PC34      PC35  \\\n",
       "0       -0.161748 -0.219747 -0.004607  0.002601  0.033419 -0.014938   \n",
       "1       -0.638463 -0.371135  0.010602  0.000644  0.126258 -0.189626   \n",
       "2       -0.211976 -0.235381 -0.003066  0.002394  0.043401 -0.034325   \n",
       "3       -0.635723 -0.369948  0.010453  0.000654  0.125925 -0.189603   \n",
       "4       -0.208920  0.039939 -0.014041  0.000980 -0.049437 -0.001124   \n",
       "...           ...       ...       ...       ...       ...       ...   \n",
       "2522357 -0.644609 -1.450193  0.084712  0.000039 -0.077264  0.303285   \n",
       "2522358 -0.729908 -1.600768  0.107229 -0.000361  0.060156  0.186588   \n",
       "2522359 -0.932889 -2.075104  0.122933 -0.000099  0.085239  0.239972   \n",
       "2522360 -0.758092 -1.661729  0.110680 -0.000353  0.072124  0.184674   \n",
       "2522361 -0.730906 -1.606039  0.108408 -0.000360  0.067885  0.181076   \n",
       "\n",
       "         Attack Type  \n",
       "0             BENIGN  \n",
       "1             BENIGN  \n",
       "2             BENIGN  \n",
       "3             BENIGN  \n",
       "4             BENIGN  \n",
       "...              ...  \n",
       "2522357       BENIGN  \n",
       "2522358       BENIGN  \n",
       "2522359       BENIGN  \n",
       "2522360       BENIGN  \n",
       "2522361       BENIGN  \n",
       "\n",
       "[2522362 rows x 36 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "719762ed",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data saved successfully for model training.\n"
     ]
    }
   ],
   "source": [
    "new_data.to_csv('intermediate_data/Data_after_Preprocessing.csv', index=False)\n",
    "print(\"Data saved successfully for model training.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "8119b3f3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Scaler saved.\n",
      "PCA model saved.\n"
     ]
    }
   ],
   "source": [
    "import joblib\n",
    "import os\n",
    "\n",
    "model_dir = 'saved_models'\n",
    "if not os.path.exists(model_dir):\n",
    "    os.makedirs(model_dir)\n",
    "\n",
    "# 1. Save the Scaler\n",
    "joblib.dump(scaler, 'saved_models/scaler.pkl')\n",
    "print(\"Scaler saved.\")\n",
    "\n",
    "# 2. Save the PCA Model\n",
    "joblib.dump(ipca, 'saved_models/pca.pkl')\n",
    "print(\"PCA model saved.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9d23af7d",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
</file>

</files>
